\hypertarget{namespacevqmc}{}\doxysection{vqmc Module Reference}
\label{namespacevqmc}\index{vqmc@{vqmc}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335}{random\+\_\+normal}} (dim, x)
\item 
subroutine \mbox{\hyperlink{namespacevqmc_aa1f3818a0761a8d2907614fa15256a10}{vqmc\+\_\+qho}} (x\+\_\+start, sigma, N, burn, thin, alpha\+\_\+const, X, accept\+\_\+rate, total\+\_\+energy)
\item 
subroutine \mbox{\hyperlink{namespacevqmc_ab903fb33ac49e462c789d47067ba311d}{vqmc\+\_\+h\+\_\+2\+\_\+plus}} (x\+\_\+start, sigma, N, burn, thin, c\+\_\+const, R\+\_\+a, R\+\_\+b, X, accept\+\_\+rate, total\+\_\+energy)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335}\label{namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335}} 
\index{vqmc@{vqmc}!random\_normal@{random\_normal}}
\index{random\_normal@{random\_normal}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{random\_normal()}{random\_normal()}}
{\footnotesize\ttfamily subroutine vqmc\+::random\+\_\+normal (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{dim,  }\item[{real(real64), dimension(\+:), intent(out)}]{x }\end{DoxyParamCaption})}



Definition at line 12 of file VQMC.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{13         }
\DoxyCodeLine{14         \textcolor{keywordtype}{implicit none} }
\DoxyCodeLine{15 }
\DoxyCodeLine{16         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: dim}
\DoxyCodeLine{17 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{dimension(:)} :: x }
\DoxyCodeLine{18 \textcolor{keywordtype}{        real}(real64) :: u\_1, u\_2 }
\DoxyCodeLine{19         \textcolor{keywordtype}{integer} :: i}
\DoxyCodeLine{20         }
\DoxyCodeLine{21         \textcolor{keywordflow}{do} i = 1, dim}
\DoxyCodeLine{22             \textcolor{keyword}{call }random\_number(u\_1)}
\DoxyCodeLine{23             \textcolor{keyword}{call }random\_number(u\_2)}
\DoxyCodeLine{24 }
\DoxyCodeLine{25             x(i) = sqrt(-\/2*log(u\_1))*cos(2*pi*u\_2)}
\DoxyCodeLine{26 \textcolor{keywordflow}{        end do} }
\DoxyCodeLine{27 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=341pt]{namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevqmc_aa1f3818a0761a8d2907614fa15256a10}\label{namespacevqmc_aa1f3818a0761a8d2907614fa15256a10}} 
\index{vqmc@{vqmc}!vqmc\_qho@{vqmc\_qho}}
\index{vqmc\_qho@{vqmc\_qho}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{vqmc\_qho()}{vqmc\_qho()}}
{\footnotesize\ttfamily subroutine vqmc\+::vqmc\+\_\+qho (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{x\+\_\+start,  }\item[{real(real64), intent(in)}]{sigma,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{burn,  }\item[{integer, intent(in)}]{thin,  }\item[{real(real64), intent(in)}]{alpha\+\_\+const,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{X,  }\item[{real(real64), intent(out)}]{accept\+\_\+rate,  }\item[{real(real64), intent(out)}]{total\+\_\+energy }\end{DoxyParamCaption})}



Definition at line 33 of file VQMC.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{35 }
\DoxyCodeLine{36         \textcolor{keywordtype}{implicit none} }
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: x\_start, sigma, alpha\_const}
\DoxyCodeLine{39         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N, burn, thin }
\DoxyCodeLine{40          }
\DoxyCodeLine{41 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: accept\_rate, total\_energy}
\DoxyCodeLine{42 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: X }
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{keywordtype}{        real}(real64) :: log\_prob\_n, a\_prob\_trans, unif\_num}
\DoxyCodeLine{45 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(1)}:: X\_n, sample\_normal}
\DoxyCodeLine{46         \textcolor{keywordtype}{integer} :: i, accept  }
\DoxyCodeLine{47         }
\DoxyCodeLine{48         \textcolor{keyword}{allocate}(x(1:n+1)) }
\DoxyCodeLine{49 }
\DoxyCodeLine{50         x(1) = x\_start }
\DoxyCodeLine{51         accept = 0 }
\DoxyCodeLine{52         total\_energy = 0 }
\DoxyCodeLine{53         }
\DoxyCodeLine{54         \textcolor{keywordflow}{do} i = 2, n+1 }
\DoxyCodeLine{55             \textcolor{comment}{! Propose the next step}}
\DoxyCodeLine{56             \textcolor{keyword}{call }random\_normal(1, sample\_normal)}
\DoxyCodeLine{57             x\_n = x(i-\/1) + sigma * sample\_normal}
\DoxyCodeLine{58 }
\DoxyCodeLine{59             log\_prob\_n = log(qho\_prob(alpha\_const, x(i-\/1), x\_n))}
\DoxyCodeLine{60             a\_prob\_trans = min(1.0\_real64, log\_prob\_n)}
\DoxyCodeLine{61             }
\DoxyCodeLine{62             \textcolor{keyword}{call }random\_number(unif\_num)}
\DoxyCodeLine{63 }
\DoxyCodeLine{64             \textcolor{keywordflow}{if} (alpha <= unif\_num) \textcolor{keywordflow}{then} }
\DoxyCodeLine{65                 x(i) = x\_n(i) }
\DoxyCodeLine{66                 accept =  1 + accept}
\DoxyCodeLine{67                 total\_energy = total\_energy + qho\_energy(alpha\_const, x\_n\textcolor{comment}{)}}
\DoxyCodeLine{68 \textcolor{comment}{}            \textcolor{keywordflow}{else} }
\DoxyCodeLine{69                 x(i) = x(i-\/1)}
\DoxyCodeLine{70 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \textcolor{keywordflow}{        end do} }
\DoxyCodeLine{73 }
\DoxyCodeLine{74         accept\_rate = accept / n }
\DoxyCodeLine{75 }
\DoxyCodeLine{76         total\_energy = total\_energy / accept}
\DoxyCodeLine{77 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{namespacevqmc_aa1f3818a0761a8d2907614fa15256a10_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevqmc_ab903fb33ac49e462c789d47067ba311d}\label{namespacevqmc_ab903fb33ac49e462c789d47067ba311d}} 
\index{vqmc@{vqmc}!vqmc\_h\_2\_plus@{vqmc\_h\_2\_plus}}
\index{vqmc\_h\_2\_plus@{vqmc\_h\_2\_plus}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{vqmc\_h\_2\_plus()}{vqmc\_h\_2\_plus()}}
{\footnotesize\ttfamily subroutine vqmc\+::vqmc\+\_\+h\+\_\+2\+\_\+plus (\begin{DoxyParamCaption}\item[{real(real64), dimension(3), intent(in)}]{x\+\_\+start,  }\item[{real(real64), intent(in)}]{sigma,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{burn,  }\item[{integer, intent(in)}]{thin,  }\item[{real(real64), intent(in)}]{c\+\_\+const,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b,  }\item[{real(real64), dimension(\+:, \+:), intent(out), allocatable}]{X,  }\item[{real(real64), intent(out)}]{accept\+\_\+rate,  }\item[{real(real64), intent(out)}]{total\+\_\+energy }\end{DoxyParamCaption})}



Definition at line 81 of file VQMC.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{83         \textcolor{keywordtype}{implicit none} }
\DoxyCodeLine{84 }
\DoxyCodeLine{85 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(3)} :: x\_start, R\_a, R\_b}
\DoxyCodeLine{86 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: sigma, c\_const }
\DoxyCodeLine{87         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N, burn, thin }
\DoxyCodeLine{88          }
\DoxyCodeLine{89 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: accept\_rate, total\_energy}
\DoxyCodeLine{90 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{dimension(:, :)}, \textcolor{keywordtype}{allocatable} :: X}
\DoxyCodeLine{91 }
\DoxyCodeLine{92 \textcolor{keywordtype}{        real}(real64) :: log\_prob\_n, a\_prob\_trans, unif\_num}
\DoxyCodeLine{93 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)} :: X\_n, sample\_normal}
\DoxyCodeLine{94         \textcolor{keywordtype}{integer} :: i, accept  }
\DoxyCodeLine{95         }
\DoxyCodeLine{96         \textcolor{keyword}{allocate}(x(3, 1:n+1)) }
\DoxyCodeLine{97 }
\DoxyCodeLine{98         x(:,1) = x\_start }
\DoxyCodeLine{99         accept = 0 }
\DoxyCodeLine{100         total\_energy = 0}
\DoxyCodeLine{101         }
\DoxyCodeLine{102         \textcolor{keywordflow}{do} i = 2, n+1 }
\DoxyCodeLine{103             \textcolor{comment}{! Propose the next step}}
\DoxyCodeLine{104             \textcolor{keyword}{call }random\_normal(3, sample\_normal)}
\DoxyCodeLine{105             x\_n = x(:, i-\/1) + sigma * sample\_normal}
\DoxyCodeLine{106 }
\DoxyCodeLine{107             log\_prob\_n = log(h\_2\_plus\_prob(c\_const, x(:,i-\/1), x\_n, r\_a, r\_b\textcolor{comment}{)}}
\DoxyCodeLine{108 \textcolor{comment}{}            a\_prob\_trans = min(1.0\_real64, log\_prob\_n)}
\DoxyCodeLine{109             }
\DoxyCodeLine{110             \textcolor{keyword}{call }random\_number(unif\_num)}
\DoxyCodeLine{111 }
\DoxyCodeLine{112             \textcolor{keywordflow}{if} (alpha <= unif\_num) \textcolor{keywordflow}{then} }
\DoxyCodeLine{113                 x(:, i) = x\_n }
\DoxyCodeLine{114                 accept =  1 + accept}
\DoxyCodeLine{115                 total\_energy = total\_energy + h\_2\_plus\_energy(c\_const, x\_n\textcolor{comment}{, r\_a, r\_b)}}
\DoxyCodeLine{116 \textcolor{comment}{}            \textcolor{keywordflow}{else} }
\DoxyCodeLine{117                 x(:, i) = x(:, i-\/1)}
\DoxyCodeLine{118 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \textcolor{keywordflow}{        end do} }
\DoxyCodeLine{121 }
\DoxyCodeLine{122         accept\_rate = accept / n }
\DoxyCodeLine{123 }
\DoxyCodeLine{124         total\_energy = total\_energy / accept}
\DoxyCodeLine{125         }
\DoxyCodeLine{126 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevqmc_ab903fb33ac49e462c789d47067ba311d_cgraph}
\end{center}
\end{figure}
