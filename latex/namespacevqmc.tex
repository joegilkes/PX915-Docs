\hypertarget{namespacevqmc}{}\doxysection{vqmc Module Reference}
\label{namespacevqmc}\index{vqmc@{vqmc}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
real(real64) function, dimension(\+:), allocatable \mbox{\hyperlink{namespacevqmc_a6b89c5b7a64a3e438695787b90a62359}{linspace}} (start, end, num)
\item 
subroutine \mbox{\hyperlink{namespacevqmc_aed182179994b5465f5466b4d909a764e}{init\+\_\+ran1}} ()
\item 
subroutine \mbox{\hyperlink{namespacevqmc_a01b80444204a0cd0b5cddde82cbc7651}{ran1}} (sample, dseed)
\item 
subroutine \mbox{\hyperlink{namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335}{random\+\_\+normal}} (dim, x)
\item 
subroutine \mbox{\hyperlink{namespacevqmc_af750525012cfc872fca742b9ef803120}{vqmc\+\_\+qho}} (sigma, N, burn, thin, alpha\+\_\+const, X, accept\+\_\+rate, energy\+\_\+chain)
\item 
subroutine \mbox{\hyperlink{namespacevqmc_a156887f8e878c4d01de5d2d4fa606a18}{vqmc\+\_\+h\+\_\+2\+\_\+plus}} (sigma, N, burn, thin, c\+\_\+const, R\+\_\+a, R\+\_\+b, X, accept\+\_\+rate, energy\+\_\+chain)
\item 
subroutine \mbox{\hyperlink{namespacevqmc_afdead1c964c264b80a7698da1bc3e792}{vqmc\+\_\+h\+\_\+2}} (sigma, N, burn, thin, c\+\_\+const, R\+\_\+a, R\+\_\+b, X\+\_\+1, X\+\_\+2, accept\+\_\+rate, energy\+\_\+chain)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer, parameter \mbox{\hyperlink{namespacevqmc_a4acb6b64bbac5c4684654d00393f7f24}{ntab}} = 32
\item 
integer(int64), dimension(\mbox{\hyperlink{namespacevqmc_a4acb6b64bbac5c4684654d00393f7f24}{ntab}}), save \mbox{\hyperlink{namespacevqmc_a86db46440794b9ef7cfd9fbf1fd69930}{iv}} = 0
\item 
integer(int64), save \mbox{\hyperlink{namespacevqmc_a1608372d703310a49afc4243ccf27368}{iy}} = 0
\item 
integer(int64), public \mbox{\hyperlink{namespacevqmc_a986f071589794992c4bc31de25c63976}{seed}}
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacevqmc_a6b89c5b7a64a3e438695787b90a62359}\label{namespacevqmc_a6b89c5b7a64a3e438695787b90a62359}} 
\index{vqmc@{vqmc}!linspace@{linspace}}
\index{linspace@{linspace}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{linspace()}{linspace()}}
{\footnotesize\ttfamily real(real64) function, dimension(\+:), allocatable vqmc\+::linspace (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{start,  }\item[{real(real64), intent(in)}]{end,  }\item[{integer, intent(in)}]{num }\end{DoxyParamCaption})}



Definition at line 21 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 }
\DoxyCodeLine{23         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: start, end}
\DoxyCodeLine{26         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: num}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: ls\_array}
\DoxyCodeLine{29 }
\DoxyCodeLine{30         \textcolor{keywordtype}{integer} :: i}
\DoxyCodeLine{31 \textcolor{keywordtype}{        real}(real64) :: step}
\DoxyCodeLine{32 }
\DoxyCodeLine{33         \textcolor{comment}{! Generate array}}
\DoxyCodeLine{34         \textcolor{keyword}{allocate}(ls\_array(num))}
\DoxyCodeLine{35         \textcolor{comment}{! Find step size}}
\DoxyCodeLine{36         step = (\textcolor{keyword}{end }-\/ start) / real(num-\/1, kind=real64)}
\DoxyCodeLine{37         \textcolor{comment}{! Fill array}}
\DoxyCodeLine{38         \textcolor{keywordflow}{do} i = 1, num}
\DoxyCodeLine{39             ls\_array(i) = start + (i-\/1)*step}
\DoxyCodeLine{40 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{41 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacevqmc_aed182179994b5465f5466b4d909a764e}\label{namespacevqmc_aed182179994b5465f5466b4d909a764e}} 
\index{vqmc@{vqmc}!init\_ran1@{init\_ran1}}
\index{init\_ran1@{init\_ran1}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{init\_ran1()}{init\_ran1()}}
{\footnotesize\ttfamily subroutine vqmc\+::init\+\_\+ran1}



Definition at line 47 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{48 }
\DoxyCodeLine{49         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51         \textcolor{keywordtype}{integer} :: fu, rc}
\DoxyCodeLine{52 }
\DoxyCodeLine{53         \textcolor{keyword}{open} (access=\textcolor{stringliteral}{'stream'}, action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'/dev/urandom'}, \&}
\DoxyCodeLine{54           form=\textcolor{stringliteral}{'unformatted'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{55 }
\DoxyCodeLine{56         \textcolor{keywordflow}{if} (rc == 0) \textcolor{keyword}{read} (fu) seed}
\DoxyCodeLine{57 }
\DoxyCodeLine{58         \textcolor{keyword}{close} (fu)}
\DoxyCodeLine{59 }
\DoxyCodeLine{60         \textcolor{keywordflow}{if} (seed .gt. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{61             seed = -\/seed}
\DoxyCodeLine{62 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{63 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacevqmc_a01b80444204a0cd0b5cddde82cbc7651}\label{namespacevqmc_a01b80444204a0cd0b5cddde82cbc7651}} 
\index{vqmc@{vqmc}!ran1@{ran1}}
\index{ran1@{ran1}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{ran1()}{ran1()}}
{\footnotesize\ttfamily subroutine vqmc\+::ran1 (\begin{DoxyParamCaption}\item[{real(real64), intent(out)}]{sample,  }\item[{integer(int64), intent(inout)}]{dseed }\end{DoxyParamCaption})}



Definition at line 69 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{70 }
\DoxyCodeLine{71         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73         \textcolor{keywordtype}{integer(int64)}, \textcolor{keywordtype}{intent(inout)} :: dseed}
\DoxyCodeLine{74 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: sample}
\DoxyCodeLine{75 }
\DoxyCodeLine{76         \textcolor{comment}{! Constants defined in Press et al}}
\DoxyCodeLine{77         \textcolor{keywordtype}{integer(int64)}, \textcolor{keywordtype}{parameter} :: ia = 16807, im = 2147483647, iq = 1\textcolor{comment}{27773}}
\DoxyCodeLine{78 \textcolor{comment}{}        \textcolor{keywordtype}{integer(int64)}, \textcolor{keywordtype}{parameter} :: ir = 2836, \&}
\DoxyCodeLine{79                                      ndiv = 1 + floor((real(im, kind=real64\textcolor{comment}{)-\/1.0)/ntab)}}
\DoxyCodeLine{80 \textcolor{comment}{}\textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{parameter} :: am = 1.0/real(im, kind=real64), eps =\textcolor{comment}{ 1.2e-\/7, \&}}
\DoxyCodeLine{81 \textcolor{comment}{}                                   rnmx = 1.0-\/eps}
\DoxyCodeLine{82 }
\DoxyCodeLine{83         \textcolor{comment}{! Loop counters}}
\DoxyCodeLine{84         \textcolor{keywordtype}{integer(int64)} :: j, k}
\DoxyCodeLine{85 }
\DoxyCodeLine{86         \textcolor{comment}{! The following is transcribed directly from Press et al}}
\DoxyCodeLine{87         \textcolor{keywordflow}{if} (dseed<=0 .or. iy==0) \textcolor{keywordflow}{then} \textcolor{comment}{! initialization}}
\DoxyCodeLine{88             dseed = max(-\/dseed,1)}
\DoxyCodeLine{89 }
\DoxyCodeLine{90             \textcolor{keywordflow}{do} j = ntab+8, 1, -\/1}
\DoxyCodeLine{91                 k = floor(real(dseed, kind=real64)/real(iq, kind=real64)\textcolor{comment}{)}}
\DoxyCodeLine{92 \textcolor{comment}{}                dseed = ia * (dseed-\/k*iq) -\/ ir * k}
\DoxyCodeLine{93                 \textcolor{keywordflow}{if} (dseed < 0) dseed = dseed + im}
\DoxyCodeLine{94                 \textcolor{keywordflow}{if} (j <= ntab) iv(j) = dseed}
\DoxyCodeLine{95 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{96 }
\DoxyCodeLine{97             iy = iv(1)}
\DoxyCodeLine{98 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100         k = floor(real(dseed, kind=real64)/real(iq, kind=real64))}
\DoxyCodeLine{101         dseed = ia * (dseed-\/k*iq) -\/ ir * k}
\DoxyCodeLine{102         \textcolor{keywordflow}{if} (dseed < 0) dseed = dseed + im}
\DoxyCodeLine{103         j = 1\_int64 + iy / ndiv}
\DoxyCodeLine{104         iy = iv(j)}
\DoxyCodeLine{105         iv(j) = dseed}
\DoxyCodeLine{106         sample = min(am*iy, rnmx)}
\DoxyCodeLine{107 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevqmc_a01b80444204a0cd0b5cddde82cbc7651_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335}\label{namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335}} 
\index{vqmc@{vqmc}!random\_normal@{random\_normal}}
\index{random\_normal@{random\_normal}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{random\_normal()}{random\_normal()}}
{\footnotesize\ttfamily subroutine vqmc\+::random\+\_\+normal (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{dim,  }\item[{real(real64), dimension(\+:), intent(out)}]{x }\end{DoxyParamCaption})}



Definition at line 112 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{113         }
\DoxyCodeLine{114         \textcolor{keywordtype}{implicit none} }
\DoxyCodeLine{115 }
\DoxyCodeLine{116         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: dim}
\DoxyCodeLine{117 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{dimension(:)} :: x }
\DoxyCodeLine{118 \textcolor{keywordtype}{        real}(real64) :: u\_1, u\_2 }
\DoxyCodeLine{119         \textcolor{keywordtype}{integer} :: i}
\DoxyCodeLine{120         }
\DoxyCodeLine{121         \textcolor{keywordflow}{do} i = 1, dim}
\DoxyCodeLine{122             \textcolor{comment}{!call random\_number(u\_1)}}
\DoxyCodeLine{123             \textcolor{comment}{!call random\_number(u\_2)}}
\DoxyCodeLine{124             \textcolor{keyword}{call }ran1(u\_1, seed)}
\DoxyCodeLine{125             \textcolor{keyword}{call }ran1(u\_2, seed)}
\DoxyCodeLine{126 }
\DoxyCodeLine{127             x(i) = sqrt(-\/2*log(u\_1))*cos(2*pi*u\_2)}
\DoxyCodeLine{128 \textcolor{keywordflow}{        end do} }
\DoxyCodeLine{129 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=292pt]{namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevqmc_af750525012cfc872fca742b9ef803120}\label{namespacevqmc_af750525012cfc872fca742b9ef803120}} 
\index{vqmc@{vqmc}!vqmc\_qho@{vqmc\_qho}}
\index{vqmc\_qho@{vqmc\_qho}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{vqmc\_qho()}{vqmc\_qho()}}
{\footnotesize\ttfamily subroutine vqmc\+::vqmc\+\_\+qho (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{sigma,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{burn,  }\item[{integer, intent(in)}]{thin,  }\item[{real(real64), intent(in)}]{alpha\+\_\+const,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{X,  }\item[{real(real64), intent(out)}]{accept\+\_\+rate,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{energy\+\_\+chain }\end{DoxyParamCaption})}



Definition at line 135 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{137 }
\DoxyCodeLine{138         \textcolor{keywordtype}{implicit none} }
\DoxyCodeLine{139 }
\DoxyCodeLine{140 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: sigma, alpha\_const}
\DoxyCodeLine{141         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N, burn, thin }
\DoxyCodeLine{142          }
\DoxyCodeLine{143 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: accept\_rate}
\DoxyCodeLine{144 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: X, energy\_chain\textcolor{comment}{ }}
\DoxyCodeLine{145 \textcolor{comment}{}}
\DoxyCodeLine{146 \textcolor{comment}{}\textcolor{keywordtype}{        real}(real64) :: log\_prob\_n, a\_prob\_trans, unif\_num}
\DoxyCodeLine{147 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(1)}:: x\_start, X\_n, sample\_normal}
\DoxyCodeLine{148         \textcolor{keywordtype}{integer} :: i, accept }
\DoxyCodeLine{149         }
\DoxyCodeLine{150         \textcolor{keyword}{allocate}(x(1:n+1)) }
\DoxyCodeLine{151         \textcolor{keyword}{allocate}(energy\_chain(1:n+1))}
\DoxyCodeLine{152 }
\DoxyCodeLine{153         \textcolor{keyword}{call }random\_normal(1, sample\_normal)}
\DoxyCodeLine{154 }
\DoxyCodeLine{155         x\_start = sample\_normal}
\DoxyCodeLine{156         x(1) = x\_start(1)}
\DoxyCodeLine{157         accept = 0 }
\DoxyCodeLine{158         energy\_chain(1) = qho\_energy(alpha\_const, x(1))}
\DoxyCodeLine{159         }
\DoxyCodeLine{160         \textcolor{keywordflow}{do} i = 2, n+1 }
\DoxyCodeLine{161             \textcolor{comment}{! Propose the next step}}
\DoxyCodeLine{162             \textcolor{keyword}{call }random\_normal(1, sample\_normal)}
\DoxyCodeLine{163             x\_n = x(i-\/1) + sigma * sample\_normal}
\DoxyCodeLine{164 }
\DoxyCodeLine{165             log\_prob\_n = log(qho\_prob(alpha\_const, x(i-\/1), x\_n(1)))}
\DoxyCodeLine{166             a\_prob\_trans = min(1.0\_real64, exp(log\_prob\_n))}
\DoxyCodeLine{167             }
\DoxyCodeLine{168             \textcolor{keyword}{call }ran1(unif\_num, seed)}
\DoxyCodeLine{169 }
\DoxyCodeLine{170             \textcolor{keywordflow}{if} (a\_prob\_trans >= unif\_num) \textcolor{keywordflow}{then} }
\DoxyCodeLine{171                 x(i) = x\_n(1) }
\DoxyCodeLine{172                 accept =  1 + accept}
\DoxyCodeLine{173                 energy\_chain(i) = qho\_energy(alpha\_const, x\_n(1))}
\DoxyCodeLine{174             \textcolor{keywordflow}{else} }
\DoxyCodeLine{175                 x(i) = x(i-\/1)}
\DoxyCodeLine{176                 energy\_chain(i) = energy\_chain(i-\/1)}
\DoxyCodeLine{177 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{178 }
\DoxyCodeLine{179 \textcolor{keywordflow}{        end do} }
\DoxyCodeLine{180 }
\DoxyCodeLine{181         accept\_rate = accept / n }
\DoxyCodeLine{182 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevqmc_af750525012cfc872fca742b9ef803120_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevqmc_a156887f8e878c4d01de5d2d4fa606a18}\label{namespacevqmc_a156887f8e878c4d01de5d2d4fa606a18}} 
\index{vqmc@{vqmc}!vqmc\_h\_2\_plus@{vqmc\_h\_2\_plus}}
\index{vqmc\_h\_2\_plus@{vqmc\_h\_2\_plus}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{vqmc\_h\_2\_plus()}{vqmc\_h\_2\_plus()}}
{\footnotesize\ttfamily subroutine vqmc\+::vqmc\+\_\+h\+\_\+2\+\_\+plus (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{sigma,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{burn,  }\item[{integer, intent(in)}]{thin,  }\item[{real(real64), dimension(\+:), intent(in)}]{c\+\_\+const,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b,  }\item[{real(real64), dimension(\+:, \+:), intent(out), allocatable}]{X,  }\item[{real(real64), intent(out)}]{accept\+\_\+rate,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{energy\+\_\+chain }\end{DoxyParamCaption})}



Definition at line 186 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{188         \textcolor{keywordtype}{implicit none} }
\DoxyCodeLine{189 }
\DoxyCodeLine{190 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(3)} :: R\_a, R\_b}
\DoxyCodeLine{191 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: sigma}
\DoxyCodeLine{192 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: c\_const}
\DoxyCodeLine{193         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N, burn, thin }
\DoxyCodeLine{194          }
\DoxyCodeLine{195 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: accept\_rate}
\DoxyCodeLine{196 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{dimension(:, :)}, \textcolor{keywordtype}{allocatable} :: X}
\DoxyCodeLine{197 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: energy\_chain}
\DoxyCodeLine{198 }
\DoxyCodeLine{199 \textcolor{keywordtype}{        real}(real64) :: log\_prob\_n, a\_prob\_trans, unif\_num}
\DoxyCodeLine{200 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)} :: x\_start, X\_n, sample\_normal}
\DoxyCodeLine{201         \textcolor{keywordtype}{integer} :: i, accept  }
\DoxyCodeLine{202         }
\DoxyCodeLine{203         \textcolor{keyword}{allocate}(x(3, 1:n+1)) }
\DoxyCodeLine{204         \textcolor{keyword}{allocate}(energy\_chain(1:n+1))}
\DoxyCodeLine{205 }
\DoxyCodeLine{206         \textcolor{keyword}{call }random\_normal(3, sample\_normal)}
\DoxyCodeLine{207         x\_start = sample\_normal}
\DoxyCodeLine{208 }
\DoxyCodeLine{209         x(:,1) = x\_start }
\DoxyCodeLine{210         accept = 0 }
\DoxyCodeLine{211         energy\_chain(1) = h\_2\_plus\_energy(c\_const, x(:, 1), r\_a, r\_b)}
\DoxyCodeLine{212         }
\DoxyCodeLine{213         \textcolor{keywordflow}{do} i = 2, n+1 }
\DoxyCodeLine{214             \textcolor{comment}{! Propose the next step}}
\DoxyCodeLine{215             \textcolor{keyword}{call }random\_normal(3, sample\_normal)}
\DoxyCodeLine{216             x\_n = x(:, i-\/1) + sigma * sample\_normal}
\DoxyCodeLine{217 }
\DoxyCodeLine{218             log\_prob\_n = log(h\_2\_plus\_prob(c\_const, x(:, i-\/1), x\_n, r\_a,\textcolor{comment}{ r\_b))}}
\DoxyCodeLine{219 \textcolor{comment}{}            a\_prob\_trans = min(1.0\_real64, exp(log\_prob\_n))}
\DoxyCodeLine{220             }
\DoxyCodeLine{221             \textcolor{keyword}{call }ran1(unif\_num, seed)}
\DoxyCodeLine{222 }
\DoxyCodeLine{223             \textcolor{keywordflow}{if} (a\_prob\_trans >= unif\_num) \textcolor{keywordflow}{then} }
\DoxyCodeLine{224                 x(:, i) = x\_n }
\DoxyCodeLine{225                 accept =  1 + accept}
\DoxyCodeLine{226                 energy\_chain(i) = h\_2\_plus\_energy(c\_const, x\_n, r\_a, r\_b\textcolor{comment}{)}}
\DoxyCodeLine{227 \textcolor{comment}{}            \textcolor{keywordflow}{else} }
\DoxyCodeLine{228                 x(:, i) = x(:, i-\/1)}
\DoxyCodeLine{229                 energy\_chain(i) = energy\_chain(i-\/1)}
\DoxyCodeLine{230 }
\DoxyCodeLine{231 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{232 }
\DoxyCodeLine{233 \textcolor{keywordflow}{        end do} }
\DoxyCodeLine{234 }
\DoxyCodeLine{235         accept\_rate = accept / n }
\DoxyCodeLine{236 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevqmc_a156887f8e878c4d01de5d2d4fa606a18_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevqmc_afdead1c964c264b80a7698da1bc3e792}\label{namespacevqmc_afdead1c964c264b80a7698da1bc3e792}} 
\index{vqmc@{vqmc}!vqmc\_h\_2@{vqmc\_h\_2}}
\index{vqmc\_h\_2@{vqmc\_h\_2}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{vqmc\_h\_2()}{vqmc\_h\_2()}}
{\footnotesize\ttfamily subroutine vqmc\+::vqmc\+\_\+h\+\_\+2 (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{sigma,  }\item[{integer, intent(in)}]{N,  }\item[{integer, intent(in)}]{burn,  }\item[{integer, intent(in)}]{thin,  }\item[{real(real64), dimension(\+:), intent(in)}]{c\+\_\+const,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b,  }\item[{real(real64), dimension(\+:, \+:), intent(out), allocatable}]{X\+\_\+1,  }\item[{real(real64), dimension(\+:, \+:), intent(out), allocatable}]{X\+\_\+2,  }\item[{real(real64), intent(out)}]{accept\+\_\+rate,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{energy\+\_\+chain }\end{DoxyParamCaption})}



Definition at line 240 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{242         \textcolor{keywordtype}{implicit none} }
\DoxyCodeLine{243 }
\DoxyCodeLine{244 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(3)} :: R\_a, R\_b}
\DoxyCodeLine{245 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: sigma}
\DoxyCodeLine{246 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: c\_const }
\DoxyCodeLine{247         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: N, burn, thin }
\DoxyCodeLine{248          }
\DoxyCodeLine{249 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: accept\_rate}
\DoxyCodeLine{250 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{dimension(:, :)}, \textcolor{keywordtype}{allocatable} :: X\_1, X\_2}
\DoxyCodeLine{251 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: energy\_chain}
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \textcolor{keywordtype}{        real}(real64) :: log\_prob\_n, a\_prob\_trans, unif\_num}
\DoxyCodeLine{254 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)} :: x\_start\_1, x\_start\_2, X\_n\_1, X\_n\_2\textcolor{comment}{, sample\_normal}}
\DoxyCodeLine{255 \textcolor{comment}{        }\textcolor{keywordtype}{integer} :: i, accept  }
\DoxyCodeLine{256         }
\DoxyCodeLine{257         \textcolor{keyword}{allocate}(x\_1(3, 1:n+1)) }
\DoxyCodeLine{258         \textcolor{keyword}{allocate}(x\_2(3, 1:n+1))}
\DoxyCodeLine{259         \textcolor{keyword}{allocate}(energy\_chain(1:n+1))}
\DoxyCodeLine{260 }
\DoxyCodeLine{261         \textcolor{keyword}{call }random\_normal(3, sample\_normal)}
\DoxyCodeLine{262         x\_start\_1 = sample\_normal}
\DoxyCodeLine{263 }
\DoxyCodeLine{264         \textcolor{keyword}{call }random\_normal(3, sample\_normal)}
\DoxyCodeLine{265         x\_start\_2 = sample\_normal }
\DoxyCodeLine{266 }
\DoxyCodeLine{267         x\_1(:,1) = x\_start\_1}
\DoxyCodeLine{268         x\_2(:,1) = x\_start\_2}
\DoxyCodeLine{269         accept = 0 }
\DoxyCodeLine{270         energy\_chain(1) = h\_2\_energy(c\_const, x\_1(:,1), x\_2(:,1), r\_a, r\_b\textcolor{comment}{) }}
\DoxyCodeLine{271 \textcolor{comment}{}        }
\DoxyCodeLine{272         \textcolor{keywordflow}{do} i = 2, n+1 }
\DoxyCodeLine{273             \textcolor{comment}{! Propose the next step}}
\DoxyCodeLine{274             \textcolor{keyword}{call }random\_normal(3, sample\_normal)}
\DoxyCodeLine{275             x\_n\_1 = x\_1(:, i-\/1) + sigma * sample\_normal}
\DoxyCodeLine{276 }
\DoxyCodeLine{277             \textcolor{keyword}{call }random\_normal(3, sample\_normal)}
\DoxyCodeLine{278             x\_n\_2 = x\_2(:, i-\/1) + sigma * sample\_normal}
\DoxyCodeLine{279 }
\DoxyCodeLine{280             log\_prob\_n = log(h\_2\_prob(c\_const, x\_1(:, i-\/1), x\_2(:, i-\/1),\textcolor{comment}{ x\_n\_1, x\_n\_2, r\_a, r\_b))}}
\DoxyCodeLine{281 \textcolor{comment}{}            a\_prob\_trans = min(1.0\_real64, exp(log\_prob\_n))}
\DoxyCodeLine{282             }
\DoxyCodeLine{283             \textcolor{keyword}{call }ran1(unif\_num, seed)}
\DoxyCodeLine{284 }
\DoxyCodeLine{285             \textcolor{keywordflow}{if} (a\_prob\_trans >= unif\_num) \textcolor{keywordflow}{then} }
\DoxyCodeLine{286                 x\_1(:, i) = x\_n\_1}
\DoxyCodeLine{287                 x\_2(:, i) = x\_n\_2 }
\DoxyCodeLine{288                 accept =  1 + accept}
\DoxyCodeLine{289                 energy\_chain(i) = h\_2\_energy(c\_const, x\_n\_1, x\_n\_2, r\_a,\textcolor{comment}{ r\_b)}}
\DoxyCodeLine{290 \textcolor{comment}{}            \textcolor{keywordflow}{else} }
\DoxyCodeLine{291                 x\_1(:, i) = x\_1(:, i-\/1)}
\DoxyCodeLine{292                 x\_2(:, i) = x\_2(:, i-\/1) }
\DoxyCodeLine{293                 }
\DoxyCodeLine{294                 energy\_chain(i) = energy\_chain(i-\/1)}
\DoxyCodeLine{295 \textcolor{keywordflow}{            end if} }
\DoxyCodeLine{296 }
\DoxyCodeLine{297 \textcolor{keywordflow}{        end do} }
\DoxyCodeLine{298 }
\DoxyCodeLine{299         accept\_rate = accept / n }
\DoxyCodeLine{300 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevqmc_afdead1c964c264b80a7698da1bc3e792_cgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacevqmc_a4acb6b64bbac5c4684654d00393f7f24}\label{namespacevqmc_a4acb6b64bbac5c4684654d00393f7f24}} 
\index{vqmc@{vqmc}!ntab@{ntab}}
\index{ntab@{ntab}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{ntab}{ntab}}
{\footnotesize\ttfamily integer, parameter vqmc\+::ntab = 32}



Definition at line 13 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{13     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ntab = 32}

\end{DoxyCode}
\mbox{\Hypertarget{namespacevqmc_a86db46440794b9ef7cfd9fbf1fd69930}\label{namespacevqmc_a86db46440794b9ef7cfd9fbf1fd69930}} 
\index{vqmc@{vqmc}!iv@{iv}}
\index{iv@{iv}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{iv}{iv}}
{\footnotesize\ttfamily integer(int64), dimension(\mbox{\hyperlink{namespacevqmc_a4acb6b64bbac5c4684654d00393f7f24}{ntab}}), save vqmc\+::iv = 0}



Definition at line 14 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{14     \textcolor{keywordtype}{integer(int64)}, \textcolor{keywordtype}{dimension(ntab)}, \textcolor{keywordtype}{save} :: iv = 0 \textcolor{comment}{! 'threadprivate' by default since using MPI}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacevqmc_a1608372d703310a49afc4243ccf27368}\label{namespacevqmc_a1608372d703310a49afc4243ccf27368}} 
\index{vqmc@{vqmc}!iy@{iy}}
\index{iy@{iy}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{iy}{iy}}
{\footnotesize\ttfamily integer(int64), save vqmc\+::iy = 0}



Definition at line 15 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{15     \textcolor{keywordtype}{integer(int64)}, \textcolor{keywordtype}{save} :: iy = 0}

\end{DoxyCode}
\mbox{\Hypertarget{namespacevqmc_a986f071589794992c4bc31de25c63976}\label{namespacevqmc_a986f071589794992c4bc31de25c63976}} 
\index{vqmc@{vqmc}!seed@{seed}}
\index{seed@{seed}!vqmc@{vqmc}}
\doxysubsubsection{\texorpdfstring{seed}{seed}}
{\footnotesize\ttfamily integer(int64), public vqmc\+::seed}



Definition at line 16 of file vqmc.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{16     \textcolor{keywordtype}{integer(int64)} :: seed}

\end{DoxyCode}
