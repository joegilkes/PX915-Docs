\hypertarget{namespace_dice_py_1_1dice__visualise}{}\doxysection{Dice\+Py.\+dice\+\_\+visualise Namespace Reference}
\label{namespace_dice_py_1_1dice__visualise}\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}}


Contains functions for burning/thinning and visualization for Dice.  


\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_aa8bff4555b1d8df8986a287e47b44fe3}{QHOProb\+Plot}} (chain\+\_\+file)
\begin{DoxyCompactList}\small\item\em Wrapper function for \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a1e0fa890b9d36a8dc0d2cf886bdb47d0}{QHO\+\_\+prob\+\_\+plot()}} \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a1e0fa890b9d36a8dc0d2cf886bdb47d0}{QHO\+\_\+prob\+\_\+plot}} (positions, energies)
\begin{DoxyCompactList}\small\item\em Fancy Plotly plotter for QHO Markov chains. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a05c1a1feaeeaae37d1692368f422ecf1}{Hyd\+Prob\+Plot}} (chain\+\_\+file, opacity=0.\+2)
\begin{DoxyCompactList}\small\item\em Wrapper function for \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ae92b300a144ac37a74e18b6dc16d89a7}{H2\+\_\+prob\+\_\+plot()}} \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ae92b300a144ac37a74e18b6dc16d89a7}{H2\+\_\+prob\+\_\+plot}} (positions, energies, R1, R2, opacity)
\begin{DoxyCompactList}\small\item\em Plots the sampled wavefunction for H2plus/\+H2. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a592dd6c19dea285182a2d766eba39393}{QHOEnergy\+Plot}} (results\+\_\+file, sliceby=(None, None))
\begin{DoxyCompactList}\small\item\em Energy against $ \alpha $ plotter for the QHO problem. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a9b1db186f691296871f6344f4bff4e67}{QHOWfn\+Plot}} (chain\+\_\+file, show\+\_\+analytic=False)
\begin{DoxyCompactList}\small\item\em Scatter plotter of the sampled QHO wavefunction. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_abe1e1fab789ff04e6f5ac5f6887695ec}{H2plus\+Energy\+Plot}} (results\+\_\+file, sliceby=(None, None))
\begin{DoxyCompactList}\small\item\em $ H_{2}^{+} $ H-\/H bond energy and parameter plotter. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a68554c3801b44e369f77719d5147e591}{H2\+Energy\+Plot}} (results\+\_\+file, sliceby=(None, None))
\begin{DoxyCompactList}\small\item\em $ H_{2} $ H-\/H bond energy and parameter plotter. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a74e67f9c7fa59205001d85b39eed2aa6}{view\+\_\+original\+\_\+trace}} (equil\+\_\+file)
\begin{DoxyCompactList}\small\item\em Plots the original trace(s) of an MCMC run. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a7ba47841ec6e00b67df7de0c1aab7d6a}{Burn\+Thin\+UI}} (equil\+\_\+file)
\begin{DoxyCompactList}\small\item\em Wrapper function for interacting with \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a50ae4ae68f1121153c0026e9586143c5}{get\+\_\+autocorrelation\+\_\+time()}} \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a50ae4ae68f1121153c0026e9586143c5}{get\+\_\+autocorrelation\+\_\+time}} (filename, burn, tuning, plotting=True)
\begin{DoxyCompactList}\small\item\em Function which suggests a thinning parameter for a MCMC chain. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ade39cf6264b70d0cd62d9ff89742c62e}{load\+\_\+results}} (filename=\textquotesingle{}results.\+nc\textquotesingle{})
\begin{DoxyCompactList}\small\item\em Loads the results as a dataset Net\+CDF object to be passed to other functions. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a86a6e09c72837b5f17066a3eee79087e}{load\+\_\+global\+\_\+attr}} (rootgrp, verbose=True)
\begin{DoxyCompactList}\small\item\em Loads the global metadata in the results file into a dictionary. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_abbdc54b3066752afd14b554b0791e96d}{load\+\_\+variables}} (rootgrp, verbose=True)
\begin{DoxyCompactList}\small\item\em Loads the variables in the results file into a dictionary. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a12b764183adcced19e3e7bf8a10f4e92}{H2\+\_\+eng\+\_\+plot}} (variables)
\begin{DoxyCompactList}\small\item\em Plots the energies against the parameters checked during the grid search Parameters\+: variables\+: Dictionary which contains data about the variables in the netcdf4 object. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a4ed52b8cb18152fddc5e933a9ec10fe5}{QHO\+\_\+eng\+\_\+plot}} (rootgrp, equil=False)
\begin{DoxyCompactList}\small\item\em energy\+\_\+plot() Plots the energy at each step as the MC converges \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_af6619867dfdc02c14995d64df42314f3}{plot\+\_\+3D}} (X, Y, Z, wfn)
\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a5a0c22f15d7ec362e1e8063e090cff12}{process\+\_\+main\+\_\+results}} (filename=\textquotesingle{}results.\+nc\textquotesingle{}, verbose=True)
\begin{DoxyCompactList}\small\item\em Processes the results output as a result of the parameter search from the Net\+CDF4 file. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a71f87402b5309230c1d68d46263bf848}{plot\+\_\+markov\+\_\+chain}} (filename)
\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a94102fa6eb01dcccc8b10c387f4bd9eb}{orb\+\_\+1s}} (X, Y, Z, R\+\_\+a)
\begin{DoxyCompactList}\small\item\em functions plotting the wavefunction ab initio \#\#\#\#\#\#\# \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a47f4a634a4bd3ca1498a2d262feb88c9}{orb\+\_\+2s}} (r, R\+\_\+a)
\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a163ee968729a70b3b9f653ebed51045d}{polar\+\_\+to\+\_\+cart}} (r, theta, phi)
\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_aa7a7248206840811fa4e6ac835142af5}{lcao\+\_\+wfn}} (X, Y, Z, R1, R2, pqn=1)
\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_aaecb354ce844d441ff41cd60c875e36f}{plot\+\_\+3D}} (X, Y, Z, wfn, R1, R2)
\begin{DoxyCompactList}\small\item\em Function for plotting the wavefunction analytically. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ac82e6fdf20ce6eca6265e10dc59acc08}{example\+\_\+\+H1s\+\_\+wfn}} (bond\+\_\+length=2.\+0)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains functions for burning/thinning and visualization for Dice. 

Module containing the energy plotters for the QHO, H2plus and H2 systems, wavefunction plotters for QHO and the hydrogenic systems, and the burning/thinning interactive widget. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_aa8bff4555b1d8df8986a287e47b44fe3}\label{namespace_dice_py_1_1dice__visualise_aa8bff4555b1d8df8986a287e47b44fe3}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!QHOProbPlot@{QHOProbPlot}}
\index{QHOProbPlot@{QHOProbPlot}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{QHOProbPlot()}{QHOProbPlot()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+QHOProb\+Plot (\begin{DoxyParamCaption}\item[{}]{chain\+\_\+file }\end{DoxyParamCaption})}



Wrapper function for \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a1e0fa890b9d36a8dc0d2cf886bdb47d0}{QHO\+\_\+prob\+\_\+plot()}} 

Loads in the net\+CDF dataset and extracts position and energy arrays, passes them off to \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a1e0fa890b9d36a8dc0d2cf886bdb47d0}{QHO\+\_\+prob\+\_\+plot()}}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em chain\+\_\+file} & The main net\+CDF output file from a Full VQMC run with write\+\_\+chains=.TRUE. \\
\hline
\end{DoxyParams}


Definition at line 27 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{27 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_aa8bff4555b1d8df8986a287e47b44fe3}{QHOProbPlot}}(chain\_file):}
\DoxyCodeLine{28     \textcolor{stringliteral}{'''}}
\DoxyCodeLine{29 \textcolor{stringliteral}{    @brief}}
\DoxyCodeLine{30 \textcolor{stringliteral}{    Wrapper function for QHO\_prob\_plot()}}
\DoxyCodeLine{31 \textcolor{stringliteral}{}}
\DoxyCodeLine{32 \textcolor{stringliteral}{    @details}}
\DoxyCodeLine{33 \textcolor{stringliteral}{    Loads in the netCDF dataset and extracts position and energy}}
\DoxyCodeLine{34 \textcolor{stringliteral}{    arrays, passes them off to QHO\_prob\_plot().}}
\DoxyCodeLine{35 \textcolor{stringliteral}{}}
\DoxyCodeLine{36 \textcolor{stringliteral}{    @param[in]  chain\_file   The main netCDF output file from a Full VQMC run with write\_chains=.TRUE.}}
\DoxyCodeLine{37 \textcolor{stringliteral}{    '''}}
\DoxyCodeLine{38     dat = Dataset(chain\_file, \textcolor{stringliteral}{'r'}, format=\textcolor{stringliteral}{'NETCDF4'})}
\DoxyCodeLine{39 }
\DoxyCodeLine{40     positions = dat.variables[\textcolor{stringliteral}{'positions'}][::5]}
\DoxyCodeLine{41     energies = dat.variables[\textcolor{stringliteral}{'energies'}][::5]}
\DoxyCodeLine{42 }
\DoxyCodeLine{43     fig = \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a1e0fa890b9d36a8dc0d2cf886bdb47d0}{QHO\_prob\_plot}}(positions, energies)}
\DoxyCodeLine{44 }
\DoxyCodeLine{45     fig.show()}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_aa8bff4555b1d8df8986a287e47b44fe3_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a1e0fa890b9d36a8dc0d2cf886bdb47d0}\label{namespace_dice_py_1_1dice__visualise_a1e0fa890b9d36a8dc0d2cf886bdb47d0}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!QHO\_prob\_plot@{QHO\_prob\_plot}}
\index{QHO\_prob\_plot@{QHO\_prob\_plot}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{QHO\_prob\_plot()}{QHO\_prob\_plot()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+QHO\+\_\+prob\+\_\+plot (\begin{DoxyParamCaption}\item[{}]{positions,  }\item[{}]{energies }\end{DoxyParamCaption})}



Fancy Plotly plotter for QHO Markov chains. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em positions} & Position array from Markov chain \\
\hline
\mbox{\texttt{ in}}  & {\em energies} & Energy array from Markov chain \\
\hline
\end{DoxyParams}


Definition at line 48 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{48 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a1e0fa890b9d36a8dc0d2cf886bdb47d0}{QHO\_prob\_plot}}(positions,energies):}
\DoxyCodeLine{49     \textcolor{stringliteral}{'''}}
\DoxyCodeLine{50 \textcolor{stringliteral}{    @brief}}
\DoxyCodeLine{51 \textcolor{stringliteral}{    Fancy Plotly plotter for QHO Markov chains}}
\DoxyCodeLine{52 \textcolor{stringliteral}{}}
\DoxyCodeLine{53 \textcolor{stringliteral}{    @param[in]  positions  Position array from Markov chain}}
\DoxyCodeLine{54 \textcolor{stringliteral}{    @param[in]  energies   Energy array from Markov chain}}
\DoxyCodeLine{55 \textcolor{stringliteral}{    '''}}
\DoxyCodeLine{56     hist = ff.create\_distplot([positions], [\textcolor{stringliteral}{'Position Distribution'}],}
\DoxyCodeLine{57                          bin\_size=.2, show\_rug=\textcolor{keyword}{False})}
\DoxyCodeLine{58 }
\DoxyCodeLine{59     fig = make\_subplots(specs=[[\{\textcolor{stringliteral}{"{}secondary\_y"{}}: \textcolor{keyword}{True}\}]])}
\DoxyCodeLine{60     fig.add\_trace(go.Scatter(x=positions, y=energies, mode =\textcolor{stringliteral}{'markers'}, name=\textcolor{stringliteral}{"{}Energy"{}},}
\DoxyCodeLine{61                 marker=dict(}
\DoxyCodeLine{62                 color=energies,}
\DoxyCodeLine{63                 colorscale =\textcolor{stringliteral}{'Viridis'},}
\DoxyCodeLine{64                 line=dict(}
\DoxyCodeLine{65                     width=0}
\DoxyCodeLine{66                     ))))}
\DoxyCodeLine{67     fig.add\_trace(go.Histogram(hist[\textcolor{stringliteral}{'data'}][0]),secondary\_y=\textcolor{keyword}{True},)}
\DoxyCodeLine{68     fig.add\_trace(go.Scatter(hist[\textcolor{stringliteral}{'data'}][1]),secondary\_y=\textcolor{keyword}{True},)}
\DoxyCodeLine{69     fig[\textcolor{stringliteral}{'layout'}][\textcolor{stringliteral}{'yaxis'}][\textcolor{stringliteral}{'autorange'}] = \textcolor{stringliteral}{"{}reversed"{}}}
\DoxyCodeLine{70     fig[\textcolor{stringliteral}{'layout'}][\textcolor{stringliteral}{'yaxis2'}][\textcolor{stringliteral}{'showgrid'}] = \textcolor{keyword}{False}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{73 }
\DoxyCodeLine{74     }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_a1e0fa890b9d36a8dc0d2cf886bdb47d0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a05c1a1feaeeaae37d1692368f422ecf1}\label{namespace_dice_py_1_1dice__visualise_a05c1a1feaeeaae37d1692368f422ecf1}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!HydProbPlot@{HydProbPlot}}
\index{HydProbPlot@{HydProbPlot}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{HydProbPlot()}{HydProbPlot()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+Hyd\+Prob\+Plot (\begin{DoxyParamCaption}\item[{}]{chain\+\_\+file,  }\item[{}]{opacity = {\ttfamily 0.2} }\end{DoxyParamCaption})}



Wrapper function for \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ae92b300a144ac37a74e18b6dc16d89a7}{H2\+\_\+prob\+\_\+plot()}} 

Loads in the net\+CDF dataset and extracts position and energy arrays, passes them off to \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ae92b300a144ac37a74e18b6dc16d89a7}{H2\+\_\+prob\+\_\+plot()}}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em chain\+\_\+file} & The main net\+CDF output file from a Full VQMC run with write\+\_\+chains=.TRUE. \\
\hline
\mbox{\texttt{ in}}  & {\em opacity} & (Optional, default=0.\+2) Opacity of the electron position scatter plot \\
\hline
\end{DoxyParams}


Definition at line 75 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{75 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a05c1a1feaeeaae37d1692368f422ecf1}{HydProbPlot}}(chain\_file, opacity=0.2):}
\DoxyCodeLine{76     \textcolor{stringliteral}{'''}}
\DoxyCodeLine{77 \textcolor{stringliteral}{    @brief}}
\DoxyCodeLine{78 \textcolor{stringliteral}{    Wrapper function for H2\_prob\_plot()}}
\DoxyCodeLine{79 \textcolor{stringliteral}{}}
\DoxyCodeLine{80 \textcolor{stringliteral}{    @details}}
\DoxyCodeLine{81 \textcolor{stringliteral}{    Loads in the netCDF dataset and extracts position and energy}}
\DoxyCodeLine{82 \textcolor{stringliteral}{    arrays, passes them off to H2\_prob\_plot().}}
\DoxyCodeLine{83 \textcolor{stringliteral}{}}
\DoxyCodeLine{84 \textcolor{stringliteral}{    @param[in]  chain\_file   The main netCDF output file from a Full VQMC run with write\_chains=.TRUE.}}
\DoxyCodeLine{85 \textcolor{stringliteral}{    @param[in]  opacity      (Optional, default=0.2) Opacity of the electron position scatter plot}}
\DoxyCodeLine{86 \textcolor{stringliteral}{    '''}}
\DoxyCodeLine{87     dat = Dataset(chain\_file, \textcolor{stringliteral}{'r'}, format=\textcolor{stringliteral}{'NETCDF4'})}
\DoxyCodeLine{88 }
\DoxyCodeLine{89     positions = dat.variables[\textcolor{stringliteral}{'positions'}][:, :]}
\DoxyCodeLine{90     energies = dat.variables[\textcolor{stringliteral}{'energies'}][:]}
\DoxyCodeLine{91     bond\_length = dat.bond\_length}
\DoxyCodeLine{92 }
\DoxyCodeLine{93     R1 = [-\/bond\_length/2, 0.0, 0.0]}
\DoxyCodeLine{94     R2 = [bond\_length/2, 0.0, 0.0]}
\DoxyCodeLine{95 }
\DoxyCodeLine{96     print(len(positions))}
\DoxyCodeLine{97 }
\DoxyCodeLine{98     fig = \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ae92b300a144ac37a74e18b6dc16d89a7}{H2\_prob\_plot}}(positions, energies, R1, R2, opacity)}
\DoxyCodeLine{99 }
\DoxyCodeLine{100     fig.show()}
\DoxyCodeLine{101 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_a05c1a1feaeeaae37d1692368f422ecf1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_ae92b300a144ac37a74e18b6dc16d89a7}\label{namespace_dice_py_1_1dice__visualise_ae92b300a144ac37a74e18b6dc16d89a7}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!H2\_prob\_plot@{H2\_prob\_plot}}
\index{H2\_prob\_plot@{H2\_prob\_plot}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{H2\_prob\_plot()}{H2\_prob\_plot()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+H2\+\_\+prob\+\_\+plot (\begin{DoxyParamCaption}\item[{}]{positions,  }\item[{}]{energies,  }\item[{}]{R1,  }\item[{}]{R2,  }\item[{}]{opacity }\end{DoxyParamCaption})}



Plots the sampled wavefunction for H2plus/\+H2. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em positions} & XYZ coordinates of Markov chain \\
\hline
\mbox{\texttt{ in}}  & {\em energies} & Energies of the Markov chains \\
\hline
\mbox{\texttt{ in}}  & {\em R1} & The XYZ coordinates of the first atom \\
\hline
\mbox{\texttt{ in}}  & {\em R2} & The XYZ coordinates of the second atom \\
\hline
\mbox{\texttt{ in}}  & {\em opacity} & Opacity of the electron position scatter plot \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em fig} & Plotly figure object \\
\hline
\end{DoxyRetVals}


Definition at line 102 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{102 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ae92b300a144ac37a74e18b6dc16d89a7}{H2\_prob\_plot}}(positions,energies,R1, R2, opacity):}
\DoxyCodeLine{103     \textcolor{stringliteral}{"{}"{}"{} }}
\DoxyCodeLine{104 \textcolor{stringliteral}{    @brief}}
\DoxyCodeLine{105 \textcolor{stringliteral}{    Plots the sampled wavefunction for H2plus/H2}}
\DoxyCodeLine{106 \textcolor{stringliteral}{    }}
\DoxyCodeLine{107 \textcolor{stringliteral}{    @param[in]  positions  XYZ coordinates of Markov chain}}
\DoxyCodeLine{108 \textcolor{stringliteral}{    @param[in]  energies   Energies of the Markov chains}}
\DoxyCodeLine{109 \textcolor{stringliteral}{    @param[in]  R1         The XYZ coordinates of the first atom}}
\DoxyCodeLine{110 \textcolor{stringliteral}{    @param[in]  R2         The XYZ coordinates of the second atom}}
\DoxyCodeLine{111 \textcolor{stringliteral}{    @param[in]  opacity    Opacity of the electron position scatter plot}}
\DoxyCodeLine{112 \textcolor{stringliteral}{    @retval     fig        Plotly figure object}}
\DoxyCodeLine{113 \textcolor{stringliteral}{    "{}"{}"{}}   }
\DoxyCodeLine{114     }
\DoxyCodeLine{115     X = positions[:,0]}
\DoxyCodeLine{116     Y = positions[:,1]}
\DoxyCodeLine{117     Z = positions[:,2]}
\DoxyCodeLine{118 }
\DoxyCodeLine{119     fig = go.Figure()}
\DoxyCodeLine{120     }
\DoxyCodeLine{121     \textcolor{comment}{\#Plots the positions of the Markov chain, with energies corresponding to a certain color}}
\DoxyCodeLine{122     fig.add\_trace(}
\DoxyCodeLine{123     go.Scatter3d(}
\DoxyCodeLine{124         mode=\textcolor{stringliteral}{'markers'},}
\DoxyCodeLine{125         x=X,}
\DoxyCodeLine{126         y=Y,}
\DoxyCodeLine{127         z=Z,}
\DoxyCodeLine{128         opacity=opacity,}
\DoxyCodeLine{129         marker=dict(}
\DoxyCodeLine{130             color=energies,}
\DoxyCodeLine{131             size=3,}
\DoxyCodeLine{132             colorscale =\textcolor{stringliteral}{'Viridis'},}
\DoxyCodeLine{133             line=dict(}
\DoxyCodeLine{134                 width=0}
\DoxyCodeLine{135                 )}
\DoxyCodeLine{136             ),}
\DoxyCodeLine{137             name=\textcolor{stringliteral}{'Markov Chain positions'}}
\DoxyCodeLine{138         )}
\DoxyCodeLine{139     )}
\DoxyCodeLine{140     }
\DoxyCodeLine{141     \textcolor{comment}{\#Adds points to show the location of the atoms within the object}}
\DoxyCodeLine{142     fig.add\_trace(}
\DoxyCodeLine{143         go.Scatter3d(}
\DoxyCodeLine{144         mode=\textcolor{stringliteral}{'markers'},}
\DoxyCodeLine{145         x=[R1[0],R2[0]],}
\DoxyCodeLine{146         y=[R1[1],R2[1]],}
\DoxyCodeLine{147         z=[R1[2],R2[2]],}
\DoxyCodeLine{148         opacity=1.0,}
\DoxyCodeLine{149         marker=dict(}
\DoxyCodeLine{150             color=\textcolor{stringliteral}{'\#AAAAAA'},}
\DoxyCodeLine{151             size=20,}
\DoxyCodeLine{152             line=dict(}
\DoxyCodeLine{153                 color=\textcolor{stringliteral}{'Black'},}
\DoxyCodeLine{154                 width=2}
\DoxyCodeLine{155                 )}
\DoxyCodeLine{156             ),}
\DoxyCodeLine{157             name=\textcolor{stringliteral}{'Atoms'}}
\DoxyCodeLine{158         )}
\DoxyCodeLine{159     )}
\DoxyCodeLine{160     }
\DoxyCodeLine{161     \textcolor{comment}{\#Resizes the layout}}
\DoxyCodeLine{162     fig.update\_layout(}
\DoxyCodeLine{163     autosize=\textcolor{keyword}{False},}
\DoxyCodeLine{164     width=800,}
\DoxyCodeLine{165     height=800,}
\DoxyCodeLine{166         margin=dict(}
\DoxyCodeLine{167         l=5,}
\DoxyCodeLine{168         r=5,}
\DoxyCodeLine{169         b=5,}
\DoxyCodeLine{170         t=100,}
\DoxyCodeLine{171         pad=1}
\DoxyCodeLine{172     )}
\DoxyCodeLine{173     )}
\DoxyCodeLine{174     }
\DoxyCodeLine{175     \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{176     }
\DoxyCodeLine{177 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_ae92b300a144ac37a74e18b6dc16d89a7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a592dd6c19dea285182a2d766eba39393}\label{namespace_dice_py_1_1dice__visualise_a592dd6c19dea285182a2d766eba39393}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!QHOEnergyPlot@{QHOEnergyPlot}}
\index{QHOEnergyPlot@{QHOEnergyPlot}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{QHOEnergyPlot()}{QHOEnergyPlot()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+QHOEnergy\+Plot (\begin{DoxyParamCaption}\item[{}]{results\+\_\+file,  }\item[{}]{sliceby = {\ttfamily (None,~None)} }\end{DoxyParamCaption})}



Energy against $ \alpha $ plotter for the QHO problem. 

Plots the VQMC wavefunction energy at each of an array of values for the variational parameter $ \alpha $, alongside error bars of the standard deviation in each energy.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em results\+\_\+file} & The main net\+CDF output file from a QHO run \\
\hline
\mbox{\texttt{ in}}  & {\em sliceby} & (Optional) Tuple containing slice intervals for arrays \\
\hline
\end{DoxyParams}


Definition at line 178 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{178 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a592dd6c19dea285182a2d766eba39393}{QHOEnergyPlot}}(results\_file, sliceby=(\textcolor{keywordtype}{None}, \textcolor{keywordtype}{None})):}
\DoxyCodeLine{179     \textcolor{stringliteral}{'''}}
\DoxyCodeLine{180 \textcolor{stringliteral}{    @brief}}
\DoxyCodeLine{181 \textcolor{stringliteral}{    Energy against @f\$ \(\backslash\)alpha @f\$ plotter for the QHO problem.}}
\DoxyCodeLine{182 \textcolor{stringliteral}{}}
\DoxyCodeLine{183 \textcolor{stringliteral}{    @details}}
\DoxyCodeLine{184 \textcolor{stringliteral}{    Plots the VQMC wavefunction energy at each of an array of values for the}}
\DoxyCodeLine{185 \textcolor{stringliteral}{    variational parameter @f\$ \(\backslash\)alpha @f\$, alongside error bars of the standard}}
\DoxyCodeLine{186 \textcolor{stringliteral}{    deviation in each energy.}}
\DoxyCodeLine{187 \textcolor{stringliteral}{}}
\DoxyCodeLine{188 \textcolor{stringliteral}{    @param[in]  results\_file    The main netCDF output file from a QHO run}}
\DoxyCodeLine{189 \textcolor{stringliteral}{    @param[in]  sliceby         (Optional) Tuple containing slice intervals for arrays}}
\DoxyCodeLine{190 \textcolor{stringliteral}{    '''}}
\DoxyCodeLine{191     dat = nd.Dataset(results\_file, \textcolor{stringliteral}{'r'}, format=\textcolor{stringliteral}{'NETCDF4'})}
\DoxyCodeLine{192 }
\DoxyCodeLine{193     alpha\_array = dat.variables[\textcolor{stringliteral}{'Alpha\_array'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{194     energies = dat.variables[\textcolor{stringliteral}{'total\_energies'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{195     variances = dat.variables[\textcolor{stringliteral}{'Uncertainties'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{196 }
\DoxyCodeLine{197     stdevs = np.sqrt(variances)}
\DoxyCodeLine{198     min\_energy = min(energies)}
\DoxyCodeLine{199     min\_energy\_stdev = stdevs[np.argmin(energies)]}
\DoxyCodeLine{200     opt\_alpha = alpha\_array[np.argmin(energies)]}
\DoxyCodeLine{201 }
\DoxyCodeLine{202     fig, ax1 = plt.subplots(1, 1, figsize=(8, 8))}
\DoxyCodeLine{203 }
\DoxyCodeLine{204     ax1.set\_title(\textcolor{stringliteral}{r'Quantum Harmonic Oscillator Energy with Varying \$\(\backslash\)alpha\$'})}
\DoxyCodeLine{205     ax1.plot(alpha\_array, energies, marker=\textcolor{stringliteral}{'o'}, ls=\textcolor{stringliteral}{'-\/-\/'}, color=\textcolor{stringliteral}{'blue'})}
\DoxyCodeLine{206     ax1.fill\_between(alpha\_array, energies+stdevs, energies-\/stdevs, alpha=0.3, color=\textcolor{stringliteral}{'purple'})}
\DoxyCodeLine{207     ax1.axvline(0.5, ls=\textcolor{stringliteral}{'-\/'}, color=\textcolor{stringliteral}{'black'}, alpha=0.3)}
\DoxyCodeLine{208     ax1.set\_xlabel(\textcolor{stringliteral}{r'\$\(\backslash\)alpha\$'})}
\DoxyCodeLine{209     ax1.set\_ylabel(\textcolor{stringliteral}{'Energy'})}
\DoxyCodeLine{210 }
\DoxyCodeLine{211     fig.show()}
\DoxyCodeLine{212 }
\DoxyCodeLine{213     print(f\textcolor{stringliteral}{'Optimum alpha: \{opt\_alpha\}'})}
\DoxyCodeLine{214     print(f\textcolor{stringliteral}{'Energy: \{min\_energy\} ± \{min\_energy\_stdev\}'})}
\DoxyCodeLine{215 }
\DoxyCodeLine{216 }

\end{DoxyCode}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a9b1db186f691296871f6344f4bff4e67}\label{namespace_dice_py_1_1dice__visualise_a9b1db186f691296871f6344f4bff4e67}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!QHOWfnPlot@{QHOWfnPlot}}
\index{QHOWfnPlot@{QHOWfnPlot}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{QHOWfnPlot()}{QHOWfnPlot()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+QHOWfn\+Plot (\begin{DoxyParamCaption}\item[{}]{chain\+\_\+file,  }\item[{}]{show\+\_\+analytic = {\ttfamily False} }\end{DoxyParamCaption})}



Scatter plotter of the sampled QHO wavefunction. 

Plots the sampled posisions of a trial QHO wavefunction against the energies at those positions, to illustrate the shape of that wavefunction. Chain output requires the {\itshape write\+\_\+chains} parameter to be {\itshape TRUE}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em chain\+\_\+file} & A net\+CDF dataset of Markov chain and corresponding energies of a VQMC run \\
\hline
\mbox{\texttt{ in}}  & {\em show\+\_\+analytic} & Also display the analytical wavefunction \\
\hline
\end{DoxyParams}


Definition at line 217 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{217 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a9b1db186f691296871f6344f4bff4e67}{QHOWfnPlot}}(chain\_file, show\_analytic=False):}
\DoxyCodeLine{218     \textcolor{stringliteral}{'''}}
\DoxyCodeLine{219 \textcolor{stringliteral}{    @brief}}
\DoxyCodeLine{220 \textcolor{stringliteral}{    Scatter plotter of the sampled QHO wavefunction.}}
\DoxyCodeLine{221 \textcolor{stringliteral}{}}
\DoxyCodeLine{222 \textcolor{stringliteral}{    @details}}
\DoxyCodeLine{223 \textcolor{stringliteral}{    Plots the sampled posisions of a trial QHO wavefunction against the}}
\DoxyCodeLine{224 \textcolor{stringliteral}{    energies at those positions, to illustrate the shape of that wavefunction.}}
\DoxyCodeLine{225 \textcolor{stringliteral}{    Chain output requires the @em write\_chains parameter to be @em TRUE.}}
\DoxyCodeLine{226 \textcolor{stringliteral}{}}
\DoxyCodeLine{227 \textcolor{stringliteral}{    @param[in]  chain\_file     A netCDF dataset of Markov chain and corresponding energies of a VQMC run}}
\DoxyCodeLine{228 \textcolor{stringliteral}{    @param[in]  show\_analytic  Also display the analytical wavefunction}}
\DoxyCodeLine{229 \textcolor{stringliteral}{    '''}}
\DoxyCodeLine{230     dat = nd.Dataset(chain\_file, \textcolor{stringliteral}{'r'}, format=\textcolor{stringliteral}{'NETCDF4'})}
\DoxyCodeLine{231 }
\DoxyCodeLine{232     positions = dat.variables[\textcolor{stringliteral}{'positions'}][:]}
\DoxyCodeLine{233     energies = dat.variables[\textcolor{stringliteral}{'energies'}][:]}
\DoxyCodeLine{234     alpha = dat.alpha}
\DoxyCodeLine{235 }
\DoxyCodeLine{236     plt.figure(figsize=(8, 8))}
\DoxyCodeLine{237     plt.title(rf\textcolor{stringliteral}{'Sampled QHO Wavefunction at \$\(\backslash\)alpha\$ = \{alpha\}'})}
\DoxyCodeLine{238     plt.plot(positions, energies, \textcolor{stringliteral}{'o'}, color=\textcolor{stringliteral}{'purple'}, markersize=4.0, alpha=0.5)}
\DoxyCodeLine{239     plt.xlabel(\textcolor{stringliteral}{'Sampled Position'})}
\DoxyCodeLine{240     plt.ylabel(\textcolor{stringliteral}{'Energy'})}
\DoxyCodeLine{241 }
\DoxyCodeLine{242     \textcolor{keywordflow}{if} show\_analytic:}
\DoxyCodeLine{243         pos\_array = np.linspace(min(positions), max(positions), 100)}
\DoxyCodeLine{244         analytic = np.exp(-\/alpha * pos\_array**2)}
\DoxyCodeLine{245         plt.plot(pos\_array, analytic, color=\textcolor{stringliteral}{'red'}, alpha=0.8)}
\DoxyCodeLine{246 }
\DoxyCodeLine{247     plt.show()}
\DoxyCodeLine{248 }
\DoxyCodeLine{249 }

\end{DoxyCode}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_abe1e1fab789ff04e6f5ac5f6887695ec}\label{namespace_dice_py_1_1dice__visualise_abe1e1fab789ff04e6f5ac5f6887695ec}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!H2plusEnergyPlot@{H2plusEnergyPlot}}
\index{H2plusEnergyPlot@{H2plusEnergyPlot}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{H2plusEnergyPlot()}{H2plusEnergyPlot()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+H2plus\+Energy\+Plot (\begin{DoxyParamCaption}\item[{}]{results\+\_\+file,  }\item[{}]{sliceby = {\ttfamily (None,~None)} }\end{DoxyParamCaption})}



$ H_{2}^{+} $ H-\/H bond energy and parameter plotter. 

Plots the H-\/H bond potential energy curve generated by VQMC at the optimum parameters for each bond length. Plots standard deviation of each energy as a measure of uncertainty. Also plots variational parameter $ c $ against bond length. Reports equilibrium bond length for the molecule and optimum energy.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em results\+\_\+file} & The main net\+CDF output file from a $ H_{2}^{+} $ run \\
\hline
\mbox{\texttt{ in}}  & {\em sliceby} & (Optional) Tuple containing slice intervals for arrays \\
\hline
\end{DoxyParams}


Definition at line 250 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{250 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_abe1e1fab789ff04e6f5ac5f6887695ec}{H2plusEnergyPlot}}(results\_file, sliceby=(\textcolor{keywordtype}{None}, \textcolor{keywordtype}{None})):}
\DoxyCodeLine{251     \textcolor{stringliteral}{'''}}
\DoxyCodeLine{252 \textcolor{stringliteral}{    @brief}}
\DoxyCodeLine{253 \textcolor{stringliteral}{    @f\$ H\_\{2\}\string^\{+\} @f\$ H-\/H bond energy and parameter plotter.}}
\DoxyCodeLine{254 \textcolor{stringliteral}{}}
\DoxyCodeLine{255 \textcolor{stringliteral}{    @details}}
\DoxyCodeLine{256 \textcolor{stringliteral}{    Plots the H-\/H bond potential energy curve generated by VQMC at the optimum}}
\DoxyCodeLine{257 \textcolor{stringliteral}{    parameters for each bond length. Plots standard deviation of each energy as}}
\DoxyCodeLine{258 \textcolor{stringliteral}{    a measure of uncertainty. Also plots variational parameter @f\$ c @f\$ against}}
\DoxyCodeLine{259 \textcolor{stringliteral}{    bond length. Reports equilibrium bond length for the molecule and optimum}}
\DoxyCodeLine{260 \textcolor{stringliteral}{    energy.}}
\DoxyCodeLine{261 \textcolor{stringliteral}{}}
\DoxyCodeLine{262 \textcolor{stringliteral}{    @param[in]  results\_file    The main netCDF output file from a @f\$ H\_\{2\}\string^\{+\} @f\$ run}}
\DoxyCodeLine{263 \textcolor{stringliteral}{    @param[in]  sliceby         (Optional) Tuple containing slice intervals for arrays}}
\DoxyCodeLine{264 \textcolor{stringliteral}{    '''}}
\DoxyCodeLine{265     dat = nd.Dataset(results\_file, \textcolor{stringliteral}{'r'}, format=\textcolor{stringliteral}{'NETCDF4'})}
\DoxyCodeLine{266 }
\DoxyCodeLine{267     bond\_lengths = dat.variables[\textcolor{stringliteral}{'Bondlength\_array'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{268     c\_opt = dat.variables[\textcolor{stringliteral}{'Parameter\_array'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{269     energies = dat.variables[\textcolor{stringliteral}{'total\_energies'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{270     variances = dat.variables[\textcolor{stringliteral}{'Uncertainties'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{271 }
\DoxyCodeLine{272     stdevs = np.sqrt(variances)}
\DoxyCodeLine{273     min\_energy = min(energies)}
\DoxyCodeLine{274     min\_energy\_stdev = stdevs[np.argmin(energies)]}
\DoxyCodeLine{275     min\_bond\_length = bond\_lengths[np.argmin(energies)]}
\DoxyCodeLine{276 }
\DoxyCodeLine{277     fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(18, 8))}
\DoxyCodeLine{278 }
\DoxyCodeLine{279     ax1.set\_title(\textcolor{stringliteral}{r'\$H\_\{2\}\string^\{+\}\$ bond energy curve'})}
\DoxyCodeLine{280     \textcolor{comment}{\# ax1.plot(bond\_lengths, energies, marker='o')}}
\DoxyCodeLine{281     ax1.plot(bond\_lengths, energies, marker=\textcolor{stringliteral}{'o'}, ls=\textcolor{stringliteral}{'-\/-\/'}, color=\textcolor{stringliteral}{'blue'})}
\DoxyCodeLine{282     ax1.fill\_between(bond\_lengths, energies+stdevs, energies-\/stdevs, alpha=0.3, color=\textcolor{stringliteral}{'purple'})}
\DoxyCodeLine{283     ax1.axhline(-\/0.5, ls=\textcolor{stringliteral}{'-\/'}, color=\textcolor{stringliteral}{'black'}, alpha=0.3)}
\DoxyCodeLine{284     ax1.set\_xlabel(\textcolor{stringliteral}{r'Bond Length / \$a\_\{0\}\$'})}
\DoxyCodeLine{285     ax1.set\_ylabel(\textcolor{stringliteral}{'Energy / Ha'})}
\DoxyCodeLine{286 }
\DoxyCodeLine{287     ax2.set\_title(\textcolor{stringliteral}{r'Optimised parameter \$c\$'})}
\DoxyCodeLine{288     ax2.plot(bond\_lengths, c\_opt)}
\DoxyCodeLine{289     ax2.axhline(1/np.sqrt(2), ls=\textcolor{stringliteral}{'-\/'}, color=\textcolor{stringliteral}{'black'}, alpha=0.3)}
\DoxyCodeLine{290     ax2.set\_xlabel(\textcolor{stringliteral}{r'Bond Length / \$a\_\{0\}\$'})}
\DoxyCodeLine{291     ax2.set\_ylabel(\textcolor{stringliteral}{r'\$c\$'})}
\DoxyCodeLine{292 }
\DoxyCodeLine{293     fig.tight\_layout()}
\DoxyCodeLine{294     fig.show()}
\DoxyCodeLine{295 }
\DoxyCodeLine{296     print(f\textcolor{stringliteral}{'Equilibrium bond length: \{min\_bond\_length\} Bohr'})}
\DoxyCodeLine{297     print(f\textcolor{stringliteral}{'                         = \{min\_bond\_length*0.529177\} Angstroms'})}
\DoxyCodeLine{298     print(f\textcolor{stringliteral}{'   at energy: \{min\_energy\} ± \{min\_energy\_stdev\} Ha'})}
\DoxyCodeLine{299 }
\DoxyCodeLine{300 }
\DoxyCodeLine{301 }

\end{DoxyCode}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a68554c3801b44e369f77719d5147e591}\label{namespace_dice_py_1_1dice__visualise_a68554c3801b44e369f77719d5147e591}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!H2EnergyPlot@{H2EnergyPlot}}
\index{H2EnergyPlot@{H2EnergyPlot}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{H2EnergyPlot()}{H2EnergyPlot()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+H2\+Energy\+Plot (\begin{DoxyParamCaption}\item[{}]{results\+\_\+file,  }\item[{}]{sliceby = {\ttfamily (None,~None)} }\end{DoxyParamCaption})}



$ H_{2} $ H-\/H bond energy and parameter plotter. 

Plots the H-\/H bond potential energy curve generated by VQMC at the optimum parameters for each bond length. Plots standard deviation of each energy as a measure of uncertainty. Also plots variational parameters $ a $ and $ \beta $ against bond length. Reports equilibrium bond length for the molecule and optimum energy.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em results\+\_\+file} & The main net\+CDF output file from a $ H_{2} $ run \\
\hline
\mbox{\texttt{ in}}  & {\em sliceby} & (Optional) Tuple containing slice intervals for arrays \\
\hline
\end{DoxyParams}


Definition at line 302 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{302 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a68554c3801b44e369f77719d5147e591}{H2EnergyPlot}}(results\_file, sliceby=(\textcolor{keywordtype}{None}, \textcolor{keywordtype}{None})):}
\DoxyCodeLine{303     \textcolor{stringliteral}{'''}}
\DoxyCodeLine{304 \textcolor{stringliteral}{    @brief}}
\DoxyCodeLine{305 \textcolor{stringliteral}{    @f\$ H\_\{2\} @f\$ H-\/H bond energy and parameter plotter.}}
\DoxyCodeLine{306 \textcolor{stringliteral}{}}
\DoxyCodeLine{307 \textcolor{stringliteral}{    @details}}
\DoxyCodeLine{308 \textcolor{stringliteral}{    Plots the H-\/H bond potential energy curve generated by VQMC at the optimum}}
\DoxyCodeLine{309 \textcolor{stringliteral}{    parameters for each bond length. Plots standard deviation of each energy as}}
\DoxyCodeLine{310 \textcolor{stringliteral}{    a measure of uncertainty. Also plots variational parameters @f\$ a @f\$ and}}
\DoxyCodeLine{311 \textcolor{stringliteral}{    @f\$ \(\backslash\)beta @f\$ against bond length. Reports equilibrium bond length for the}}
\DoxyCodeLine{312 \textcolor{stringliteral}{    molecule and optimum energy.}}
\DoxyCodeLine{313 \textcolor{stringliteral}{}}
\DoxyCodeLine{314 \textcolor{stringliteral}{    @param[in]  results\_file    The main netCDF output file from a @f\$ H\_\{2\} @f\$ run}}
\DoxyCodeLine{315 \textcolor{stringliteral}{    @param[in]  sliceby         (Optional) Tuple containing slice intervals for arrays}}
\DoxyCodeLine{316 \textcolor{stringliteral}{    '''}}
\DoxyCodeLine{317     dat = nd.Dataset(results\_file, \textcolor{stringliteral}{'r'}, format=\textcolor{stringliteral}{'NETCDF4'})}
\DoxyCodeLine{318 }
\DoxyCodeLine{319     bond\_lengths = dat.variables[\textcolor{stringliteral}{'Bondlength\_array'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{320     a\_opt = dat.variables[\textcolor{stringliteral}{'Parameter\_a\_array'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{321     beta\_opt = dat.variables[\textcolor{stringliteral}{'Parameter\_beta\_array'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{322     energies = dat.variables[\textcolor{stringliteral}{'total\_energies'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{323     variances = dat.variables[\textcolor{stringliteral}{'Uncertainties'}][sliceby[0]:sliceby[1]]}
\DoxyCodeLine{324 }
\DoxyCodeLine{325     stdevs = np.sqrt(variances)}
\DoxyCodeLine{326     min\_energy = min(energies)}
\DoxyCodeLine{327     min\_energy\_stdev = stdevs[np.argmin(energies)]}
\DoxyCodeLine{328     min\_bond\_length = bond\_lengths[np.argmin(energies)]}
\DoxyCodeLine{329 }
\DoxyCodeLine{330     fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(18, 8))}
\DoxyCodeLine{331 }
\DoxyCodeLine{332     ax1.set\_title(\textcolor{stringliteral}{r'\$H\_\{2\}\$ bond energy curve'})}
\DoxyCodeLine{333     ax1.errorbar(bond\_lengths, energies, yerr=stdevs, marker=\textcolor{stringliteral}{'o'}, ls=\textcolor{stringliteral}{'-\/-\/'}, color=\textcolor{stringliteral}{'blue'})}
\DoxyCodeLine{334     ax1.fill\_between(bond\_lengths, energies+stdevs, energies-\/stdevs, alpha=0.3, color=\textcolor{stringliteral}{'purple'})}
\DoxyCodeLine{335     ax1.set\_xlabel(\textcolor{stringliteral}{r'Bond Length / \$a\_\{0\}\$'})}
\DoxyCodeLine{336     ax1.set\_ylabel(\textcolor{stringliteral}{'Energy / Ha'})}
\DoxyCodeLine{337 }
\DoxyCodeLine{338     ax2.set\_title(\textcolor{stringliteral}{r'Optimised parameters'})}
\DoxyCodeLine{339     ax2.plot(bond\_lengths, a\_opt, color=\textcolor{stringliteral}{'red'})}
\DoxyCodeLine{340     ax2.set\_xlabel(\textcolor{stringliteral}{r'Bond Length / \$a\_\{0\}\$'})}
\DoxyCodeLine{341     ax2.set\_ylabel(\textcolor{stringliteral}{r'\$a\$'}, color=\textcolor{stringliteral}{'red'})}
\DoxyCodeLine{342     ax2.tick\_params(axis=\textcolor{stringliteral}{'y'}, labelcolor=\textcolor{stringliteral}{'red'})}
\DoxyCodeLine{343 }
\DoxyCodeLine{344     ax2a = ax2.twinx()}
\DoxyCodeLine{345     ax2a.plot(bond\_lengths, beta\_opt, color=\textcolor{stringliteral}{'blue'})}
\DoxyCodeLine{346     ax2a.set\_ylabel(\textcolor{stringliteral}{r'\$\(\backslash\)beta\$'}, color=\textcolor{stringliteral}{'blue'})}
\DoxyCodeLine{347     ax2a.tick\_params(axis=\textcolor{stringliteral}{'y'}, labelcolor=\textcolor{stringliteral}{'blue'})}
\DoxyCodeLine{348 }
\DoxyCodeLine{349     fig.tight\_layout()}
\DoxyCodeLine{350     fig.show()}
\DoxyCodeLine{351 }
\DoxyCodeLine{352     print(f\textcolor{stringliteral}{'Equilibrium bond length: \{min\_bond\_length\} Bohr'})}
\DoxyCodeLine{353     print(f\textcolor{stringliteral}{'                         = \{min\_bond\_length*0.529177\} Angstroms'})}
\DoxyCodeLine{354     print(f\textcolor{stringliteral}{'   at energy: \{min\_energy\} ± \{min\_energy\_stdev\} Ha'})}
\DoxyCodeLine{355 }
\DoxyCodeLine{356 }
\DoxyCodeLine{357 \textcolor{comment}{\#-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{358 \textcolor{comment}{\# Burn / Thin FUNCTION DEFINITIONS -\/}}
\DoxyCodeLine{359 \textcolor{comment}{\#-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{360 }

\end{DoxyCode}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a74e67f9c7fa59205001d85b39eed2aa6}\label{namespace_dice_py_1_1dice__visualise_a74e67f9c7fa59205001d85b39eed2aa6}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!view\_original\_trace@{view\_original\_trace}}
\index{view\_original\_trace@{view\_original\_trace}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{view\_original\_trace()}{view\_original\_trace()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+view\+\_\+original\+\_\+trace (\begin{DoxyParamCaption}\item[{}]{equil\+\_\+file }\end{DoxyParamCaption})}



Plots the original trace(s) of an MCMC run. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em equil\+\_\+file} & Filename of MCMC equilibration run \\
\hline
\end{DoxyParams}


Definition at line 365 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{365 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a74e67f9c7fa59205001d85b39eed2aa6}{view\_original\_trace}}(equil\_file):}
\DoxyCodeLine{366     rootgrp = Dataset(equil\_file, \textcolor{stringliteral}{"{}r"{}}, format = \textcolor{stringliteral}{"{}NETCDF4"{}})}
\DoxyCodeLine{367     chain = np.array(rootgrp[\textcolor{stringliteral}{'positions'}][:])}
\DoxyCodeLine{368     \textcolor{keywordflow}{if} len(chain.shape) == 1:}
\DoxyCodeLine{369         plt.plot(range(len(chain)), chain, linewidth=1.0)}
\DoxyCodeLine{370         plt.xlabel(\textcolor{stringliteral}{"{}Position in chain"{}})}
\DoxyCodeLine{371         plt.ylabel(\textcolor{stringliteral}{"{}Chain value"{}})}
\DoxyCodeLine{372         plt.title(\textcolor{stringliteral}{"{}Original Chain"{}})}
\DoxyCodeLine{373         plt.show()}
\DoxyCodeLine{374         }
\DoxyCodeLine{375     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{376         chainx = chain[:,0]}
\DoxyCodeLine{377         chainy = chain[:,1]}
\DoxyCodeLine{378         chainz = chain[:,2]}
\DoxyCodeLine{379         }
\DoxyCodeLine{380         fig, (ax1,ax2,ax3) = plt.subplots(3,1)}
\DoxyCodeLine{381         ax1.plot(range(len(chainx)), chainx, linewidth=1.0)}
\DoxyCodeLine{382         ax2.plot(range(len(chainy)), chainy, linewidth=1.0)}
\DoxyCodeLine{383         ax3.plot(range(len(chainz)), chainz, linewidth=1.0)}
\DoxyCodeLine{384     }
\DoxyCodeLine{385     \textcolor{keywordflow}{return}}
\DoxyCodeLine{386 }

\end{DoxyCode}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a7ba47841ec6e00b67df7de0c1aab7d6a}\label{namespace_dice_py_1_1dice__visualise_a7ba47841ec6e00b67df7de0c1aab7d6a}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!BurnThinUI@{BurnThinUI}}
\index{BurnThinUI@{BurnThinUI}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{BurnThinUI()}{BurnThinUI()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+Burn\+Thin\+UI (\begin{DoxyParamCaption}\item[{}]{equil\+\_\+file }\end{DoxyParamCaption})}



Wrapper function for interacting with \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a50ae4ae68f1121153c0026e9586143c5}{get\+\_\+autocorrelation\+\_\+time()}} 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em equil\+\_\+file} & Filename of MCMC equilibration run \\
\hline
\end{DoxyParams}


Definition at line 387 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{387 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a7ba47841ec6e00b67df7de0c1aab7d6a}{BurnThinUI}}(equil\_file):}
\DoxyCodeLine{388     \textcolor{stringliteral}{'''}}
\DoxyCodeLine{389 \textcolor{stringliteral}{    @brief}}
\DoxyCodeLine{390 \textcolor{stringliteral}{    Wrapper function for interacting with get\_autocorrelation\_time()}}
\DoxyCodeLine{391 \textcolor{stringliteral}{}}
\DoxyCodeLine{392 \textcolor{stringliteral}{    @param[in]  equil\_file   Filename of MCMC equilibration run}}
\DoxyCodeLine{393 \textcolor{stringliteral}{    '''}}
\DoxyCodeLine{394     widgets.interact\_manual(get\_autocorrelation\_time, filename=fixed(equil\_file), }
\DoxyCodeLine{395         burn=(0, int(0.1*len(np.array(Dataset(equil\_file, \textcolor{stringliteral}{"{}r"{}}, format = \textcolor{stringliteral}{"{}NETCDF4"{}})[\textcolor{stringliteral}{'positions'}][:]))), 10),}
\DoxyCodeLine{396         tuning=[(1.0),(1e-\/1),(1e-\/2),(1e-\/3),(1e-\/4)])}
\DoxyCodeLine{397 }

\end{DoxyCode}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a50ae4ae68f1121153c0026e9586143c5}\label{namespace_dice_py_1_1dice__visualise_a50ae4ae68f1121153c0026e9586143c5}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!get\_autocorrelation\_time@{get\_autocorrelation\_time}}
\index{get\_autocorrelation\_time@{get\_autocorrelation\_time}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{get\_autocorrelation\_time()}{get\_autocorrelation\_time()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+get\+\_\+autocorrelation\+\_\+time (\begin{DoxyParamCaption}\item[{}]{filename,  }\item[{}]{burn,  }\item[{}]{tuning,  }\item[{}]{plotting = {\ttfamily True} }\end{DoxyParamCaption})}



Function which suggests a thinning parameter for a MCMC chain. 

Takes as input a burning parameter and a tuning parameter which controls how aggressively you tune out autocorrelation in the trace, and prints a suggested thinning parameter (if one was found). Intention is to use interactively, to illustrate procedure for burning and thinning, as default values are provided. Plots generated are the autocorrelation as a function of lag time, and the burnt and thinned trace / chain.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em filename} & Filename of MCMC equilibration run \\
\hline
\mbox{\texttt{ in}}  & {\em burn} & Number of samples from chain to burn / discard \\
\hline
\mbox{\texttt{ in}}  & {\em tuning} & Parameter which controls aggression of thinning \\
\hline
\mbox{\texttt{ in}}  & {\em plotting} & Controls whether to display plots \\
\hline
\end{DoxyParams}


Definition at line 414 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{414 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a50ae4ae68f1121153c0026e9586143c5}{get\_autocorrelation\_time}}(filename, burn, tuning, plotting=True):}
\DoxyCodeLine{415     rootgrp = Dataset(filename, \textcolor{stringliteral}{"{}r"{}}, format = \textcolor{stringliteral}{"{}NETCDF4"{}})}
\DoxyCodeLine{416     chain = np.array(rootgrp[\textcolor{stringliteral}{'positions'}][:])}
\DoxyCodeLine{417     \textcolor{keywordflow}{if} len(chain.shape) == 1:}
\DoxyCodeLine{418         acp = sps.fftconvolve(chain,chain[::-\/1],mode=\textcolor{stringliteral}{'full'})}
\DoxyCodeLine{419         acp = acp[int(acp.size / 2):]}
\DoxyCodeLine{420         acp = acp / max(acp)}
\DoxyCodeLine{421         acp = acp[burn:]}
\DoxyCodeLine{422 }
\DoxyCodeLine{423         thin = np.argmax(abs(acp) < tuning)}
\DoxyCodeLine{424         \textcolor{keywordflow}{if} thin == 0:}
\DoxyCodeLine{425             \textcolor{keywordflow}{if} acp[thin] < tuning:}
\DoxyCodeLine{426                 thin = 1}
\DoxyCodeLine{427             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{428                 print(\textcolor{stringliteral}{"{}No thinning value found -\/ tuning may be too aggressive. Defaulting to no thinning, thin=1."{}})}
\DoxyCodeLine{429                 print()}
\DoxyCodeLine{430                 thin = 1}
\DoxyCodeLine{431 }
\DoxyCodeLine{432         print(\textcolor{stringliteral}{"{}burning parameter = "{}}, burn)}
\DoxyCodeLine{433         print(\textcolor{stringliteral}{"{}proposed thinning parameter = "{}}, thin)}
\DoxyCodeLine{434 }
\DoxyCodeLine{435         chain\_new = chain[burn::thin]}
\DoxyCodeLine{436         print(\textcolor{stringliteral}{"{}length of new chain = "{}}, len(chain\_new))}
\DoxyCodeLine{437 }
\DoxyCodeLine{438         \textcolor{keywordflow}{if} plotting==\textcolor{keyword}{True}:}
\DoxyCodeLine{439             plt.plot(range(len(acp)), acp, linewidth=1.0)}
\DoxyCodeLine{440             plt.xlabel(\textcolor{stringliteral}{"{}Position in chain / Lag time"{}})}
\DoxyCodeLine{441             plt.ylabel(\textcolor{stringliteral}{"{}ACF"{}})}
\DoxyCodeLine{442             plt.title(\textcolor{stringliteral}{"{}Autocorrelation function vs lag time"{}})}
\DoxyCodeLine{443             plt.show()}
\DoxyCodeLine{444 }
\DoxyCodeLine{445             plt.plot(range(len(chain\_new)), chain\_new, linewidth=1.0)}
\DoxyCodeLine{446             plt.xlabel(\textcolor{stringliteral}{"{}Position in chain"{}})}
\DoxyCodeLine{447             plt.ylabel(\textcolor{stringliteral}{"{}Chain value"{}})}
\DoxyCodeLine{448             plt.title(\textcolor{stringliteral}{"{}New Chain"{}})}
\DoxyCodeLine{449             plt.show()}
\DoxyCodeLine{450             }
\DoxyCodeLine{451         \textcolor{keywordflow}{return} burn, thin}
\DoxyCodeLine{452             }
\DoxyCodeLine{453     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{454         chainx = chain[:,0]}
\DoxyCodeLine{455         chainy = chain[:,1]}
\DoxyCodeLine{456         chainz = chain[:,2]}
\DoxyCodeLine{457         }
\DoxyCodeLine{458         threed\_thin = []}
\DoxyCodeLine{459         chain\_lengths = []}
\DoxyCodeLine{460         }
\DoxyCodeLine{461         \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} [chainx,chainy,chainz]:}
\DoxyCodeLine{462             acp = sps.fftconvolve(c,c[::-\/1],mode=\textcolor{stringliteral}{'full'})}
\DoxyCodeLine{463             acp = acp[int(acp.size / 2):]}
\DoxyCodeLine{464             acp = acp / max(acp)}
\DoxyCodeLine{465             acp = acp[burn:]}
\DoxyCodeLine{466 }
\DoxyCodeLine{467             thin = np.argmax(abs(acp) < tuning)}
\DoxyCodeLine{468             \textcolor{keywordflow}{if} thin == 0:}
\DoxyCodeLine{469                 \textcolor{keywordflow}{if} acp[thin] < tuning:}
\DoxyCodeLine{470                     thin = 1}
\DoxyCodeLine{471                 \textcolor{keywordflow}{else}:}
\DoxyCodeLine{472                     print(\textcolor{stringliteral}{"{}No thinning value found -\/ tuning may be too aggressive. Defaulting to no thinning, thin=1."{}})}
\DoxyCodeLine{473                     print()}
\DoxyCodeLine{474                     thin = 1}
\DoxyCodeLine{475                     }
\DoxyCodeLine{476             threed\_thin.append(thin)}
\DoxyCodeLine{477 }
\DoxyCodeLine{478             chain\_new = c[burn::thin]}
\DoxyCodeLine{479             chain\_lengths.append(len(chain\_new))}
\DoxyCodeLine{480 }
\DoxyCodeLine{481             \textcolor{keywordflow}{if} plotting==\textcolor{keyword}{True}:}
\DoxyCodeLine{482                 plt.plot(range(len(acp)), acp, linewidth=1.0)}
\DoxyCodeLine{483                 plt.xlabel(\textcolor{stringliteral}{"{}Position in chain / Lag time"{}})}
\DoxyCodeLine{484                 plt.ylabel(\textcolor{stringliteral}{"{}ACF"{}})}
\DoxyCodeLine{485                 plt.title(\textcolor{stringliteral}{"{}Autocorrelation function vs lag time"{}})}
\DoxyCodeLine{486                 plt.show()}
\DoxyCodeLine{487 }
\DoxyCodeLine{488 \textcolor{comment}{\#                 plt.plot(range(len(chain\_new)), chain\_new, linewidth=1.0)}}
\DoxyCodeLine{489 \textcolor{comment}{\#                 plt.xlabel("{}Position in chain"{})}}
\DoxyCodeLine{490 \textcolor{comment}{\#                 plt.ylabel("{}Chain value"{})}}
\DoxyCodeLine{491 \textcolor{comment}{\#                 plt.title("{}New Chain"{})}}
\DoxyCodeLine{492 \textcolor{comment}{\#                 plt.show()}}
\DoxyCodeLine{493         print(\textcolor{stringliteral}{"{}burning parameter = "{}}, burn)}
\DoxyCodeLine{494         print(\textcolor{stringliteral}{"{}proposed thinning parameters from the 3 chains: "{}}, threed\_thin)}
\DoxyCodeLine{495         print(\textcolor{stringliteral}{"{}chain lengths from proposed thins"{}}, chain\_lengths)}
\DoxyCodeLine{496 }
\DoxyCodeLine{497         \textcolor{keywordflow}{return} burn, threed\_thin}
\DoxyCodeLine{498 }
\DoxyCodeLine{499 }
\DoxyCodeLine{500 }
\DoxyCodeLine{501 \textcolor{comment}{\#-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{502 \textcolor{comment}{\# Deprecated Functions}}
\DoxyCodeLine{503 \textcolor{comment}{\#-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{504 }

\end{DoxyCode}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_ade39cf6264b70d0cd62d9ff89742c62e}\label{namespace_dice_py_1_1dice__visualise_ade39cf6264b70d0cd62d9ff89742c62e}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!load\_results@{load\_results}}
\index{load\_results@{load\_results}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{load\_results()}{load\_results()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+load\+\_\+results (\begin{DoxyParamCaption}\item[{}]{filename = {\ttfamily \textquotesingle{}results.nc\textquotesingle{}} }\end{DoxyParamCaption})}



Loads the results as a dataset Net\+CDF object to be passed to other functions. 

\begin{DoxyVerb}Parameters:
    filename: The name of the file containing the results, defaults to 'results.nc'. 
\end{DoxyVerb}
 

Definition at line 505 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{505 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ade39cf6264b70d0cd62d9ff89742c62e}{load\_results}}(filename = 'results.nc'):}
\DoxyCodeLine{506 }
\DoxyCodeLine{507     \textcolor{stringliteral}{"{}"{}"{}Loads the results as a dataset NetCDF object to be passed to other functions}}
\DoxyCodeLine{508 \textcolor{stringliteral}{    }}
\DoxyCodeLine{509 \textcolor{stringliteral}{    Parameters:}}
\DoxyCodeLine{510 \textcolor{stringliteral}{        filename: The name of the file containing the results, defaults to 'results.nc'. "{}"{}"{}}}
\DoxyCodeLine{511     }
\DoxyCodeLine{512     \textcolor{keywordflow}{try}:}
\DoxyCodeLine{513         rootgrp = Dataset(filename)}
\DoxyCodeLine{514     \textcolor{keywordflow}{except} OSError \textcolor{keyword}{as} err:}
\DoxyCodeLine{515         print(f\textcolor{stringliteral}{"{}OS error: \{err\}"{}})}
\DoxyCodeLine{516     \textcolor{keywordflow}{return} rootgrp}
\DoxyCodeLine{517 }
\DoxyCodeLine{518 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_ade39cf6264b70d0cd62d9ff89742c62e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a86a6e09c72837b5f17066a3eee79087e}\label{namespace_dice_py_1_1dice__visualise_a86a6e09c72837b5f17066a3eee79087e}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!load\_global\_attr@{load\_global\_attr}}
\index{load\_global\_attr@{load\_global\_attr}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{load\_global\_attr()}{load\_global\_attr()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+load\+\_\+global\+\_\+attr (\begin{DoxyParamCaption}\item[{}]{rootgrp,  }\item[{}]{verbose = {\ttfamily True} }\end{DoxyParamCaption})}



Loads the global metadata in the results file into a dictionary. 

\begin{DoxyVerb}Parameters:
    rootgrp: NetCDF4 dataset object which loaded in using 'load_results()'.
    verbose: Defaults to true. Prints the value of global attributes which have been loaded
\end{DoxyVerb}
 

Definition at line 519 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{519 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a86a6e09c72837b5f17066a3eee79087e}{load\_global\_attr}}(rootgrp, verbose = True):}
\DoxyCodeLine{520     \textcolor{stringliteral}{"{}"{}"{}Loads the global metadata in the results file into a dictionary}}
\DoxyCodeLine{521 \textcolor{stringliteral}{    }}
\DoxyCodeLine{522 \textcolor{stringliteral}{    Parameters:}}
\DoxyCodeLine{523 \textcolor{stringliteral}{        rootgrp: NetCDF4 dataset object which loaded in using 'load\_results()'.}}
\DoxyCodeLine{524 \textcolor{stringliteral}{        verbose: Defaults to true. Prints the value of global attributes which have been loaded}}
\DoxyCodeLine{525 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{526     global\_dict =\{\}}
\DoxyCodeLine{527 }
\DoxyCodeLine{528     \textcolor{keywordflow}{for} name \textcolor{keywordflow}{in} rootgrp.ncattrs():}
\DoxyCodeLine{529         \textcolor{keywordflow}{if} verbose:}
\DoxyCodeLine{530             print(\textcolor{stringliteral}{"{}\{\} = \{\}"{}}.format(name, getattr(rootgrp, name)))}
\DoxyCodeLine{531 }
\DoxyCodeLine{532     global\_dict[name] = getattr(rootgrp, name)}
\DoxyCodeLine{533 }
\DoxyCodeLine{534 }
\DoxyCodeLine{535     \textcolor{keywordflow}{return} global\_dict}
\DoxyCodeLine{536 }
\DoxyCodeLine{537 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_a86a6e09c72837b5f17066a3eee79087e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_abbdc54b3066752afd14b554b0791e96d}\label{namespace_dice_py_1_1dice__visualise_abbdc54b3066752afd14b554b0791e96d}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!load\_variables@{load\_variables}}
\index{load\_variables@{load\_variables}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{load\_variables()}{load\_variables()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+load\+\_\+variables (\begin{DoxyParamCaption}\item[{}]{rootgrp,  }\item[{}]{verbose = {\ttfamily True} }\end{DoxyParamCaption})}



Loads the variables in the results file into a dictionary. 

\begin{DoxyVerb}Parameters:
    rootgrp: NetCDF4 dataset object which loaded in using 'load_results()'
    verbose: Defaults to true. Prints the value of variables which have been loaded
\end{DoxyVerb}
 

Definition at line 538 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{538 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_abbdc54b3066752afd14b554b0791e96d}{load\_variables}}(rootgrp, verbose = True):}
\DoxyCodeLine{539     \textcolor{stringliteral}{"{}"{}"{}Loads the variables in the results file into a dictionary}}
\DoxyCodeLine{540 \textcolor{stringliteral}{    }}
\DoxyCodeLine{541 \textcolor{stringliteral}{    Parameters:}}
\DoxyCodeLine{542 \textcolor{stringliteral}{        rootgrp: NetCDF4 dataset object which loaded in using 'load\_results()'}}
\DoxyCodeLine{543 \textcolor{stringliteral}{        verbose: Defaults to true. Prints the value of variables which have been loaded}}
\DoxyCodeLine{544 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{545     var\_dict = \{\}}
\DoxyCodeLine{546     \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} rootgrp.variables.keys():}
\DoxyCodeLine{547         \textcolor{keywordflow}{if} verbose:}
\DoxyCodeLine{548             print(\textcolor{stringliteral}{"{}\{\} = \{\}"{}}.format(k, rootgrp[k][:]))}
\DoxyCodeLine{549         var\_dict[k] = rootgrp[k][:]}
\DoxyCodeLine{550 }
\DoxyCodeLine{551     \textcolor{keywordflow}{return} var\_dict}
\DoxyCodeLine{552 }
\DoxyCodeLine{553 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_abbdc54b3066752afd14b554b0791e96d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a12b764183adcced19e3e7bf8a10f4e92}\label{namespace_dice_py_1_1dice__visualise_a12b764183adcced19e3e7bf8a10f4e92}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!H2\_eng\_plot@{H2\_eng\_plot}}
\index{H2\_eng\_plot@{H2\_eng\_plot}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{H2\_eng\_plot()}{H2\_eng\_plot()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+H2\+\_\+eng\+\_\+plot (\begin{DoxyParamCaption}\item[{}]{variables }\end{DoxyParamCaption})}



Plots the energies against the parameters checked during the grid search Parameters\+: variables\+: Dictionary which contains data about the variables in the netcdf4 object. 



Definition at line 554 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{554 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a12b764183adcced19e3e7bf8a10f4e92}{H2\_eng\_plot}}(variables):}
\DoxyCodeLine{555     \textcolor{stringliteral}{"{}"{}"{}Plots the energies against the parameters checked during the grid search}}
\DoxyCodeLine{556 \textcolor{stringliteral}{       Parameters:}}
\DoxyCodeLine{557 \textcolor{stringliteral}{         variables: Dictionary which contains data about the variables in the netcdf4 object"{}"{}"{}}}
\DoxyCodeLine{558 }
\DoxyCodeLine{559     fig = go.Figure()}
\DoxyCodeLine{560 }
\DoxyCodeLine{561     fig.add\_trace(}
\DoxyCodeLine{562         go.Scatter(}
\DoxyCodeLine{563             x=variables[\textcolor{stringliteral}{'Bondlength\_array'}],}
\DoxyCodeLine{564             y=variables[\textcolor{stringliteral}{'total\_energies'}],}
\DoxyCodeLine{565             error\_y=dict(}
\DoxyCodeLine{566             type=\textcolor{stringliteral}{'data'},}
\DoxyCodeLine{567             array=variables[\textcolor{stringliteral}{'Uncertainties'}],}
\DoxyCodeLine{568             visible=\textcolor{keyword}{True})}
\DoxyCodeLine{569             )}
\DoxyCodeLine{570         )}
\DoxyCodeLine{571     }
\DoxyCodeLine{572     fig.update\_layout(}
\DoxyCodeLine{573     title=f\textcolor{stringliteral}{"{}Energies vs Bond Lengths"{}},}
\DoxyCodeLine{574     xaxis\_title=\textcolor{stringliteral}{"{}Bond Length"{}},}
\DoxyCodeLine{575     yaxis\_title=\textcolor{stringliteral}{"{}Energy"{}}}
\DoxyCodeLine{576     )}
\DoxyCodeLine{577     }
\DoxyCodeLine{578     fig.show()}
\DoxyCodeLine{579     }
\DoxyCodeLine{580     \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{581 }
\DoxyCodeLine{582 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_a12b764183adcced19e3e7bf8a10f4e92_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a4ed52b8cb18152fddc5e933a9ec10fe5}\label{namespace_dice_py_1_1dice__visualise_a4ed52b8cb18152fddc5e933a9ec10fe5}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!QHO\_eng\_plot@{QHO\_eng\_plot}}
\index{QHO\_eng\_plot@{QHO\_eng\_plot}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{QHO\_eng\_plot()}{QHO\_eng\_plot()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+QHO\+\_\+eng\+\_\+plot (\begin{DoxyParamCaption}\item[{}]{rootgrp,  }\item[{}]{equil = {\ttfamily False} }\end{DoxyParamCaption})}



energy\+\_\+plot() Plots the energy at each step as the MC converges 



Definition at line 583 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{583 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a4ed52b8cb18152fddc5e933a9ec10fe5}{QHO\_eng\_plot}}(rootgrp,equil=False):}
\DoxyCodeLine{584     \textcolor{stringliteral}{"{}"{}"{}energy\_plot()}}
\DoxyCodeLine{585 \textcolor{stringliteral}{    Plots the energy at each step as the MC converges}}
\DoxyCodeLine{586 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{587 }
\DoxyCodeLine{588     energies = np.array(rootgrp.variables[\textcolor{stringliteral}{'energy\_at\_alphas\_array'}][:])}
\DoxyCodeLine{589 }
\DoxyCodeLine{590     alphas = np.array((rootgrp.variables[\textcolor{stringliteral}{'Alpha\_array'}][:]))}
\DoxyCodeLine{591 }
\DoxyCodeLine{592     \textcolor{keywordflow}{if} (equil):}
\DoxyCodeLine{593         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{594 }
\DoxyCodeLine{595     data = go.Scatter(x=alphas, y=energies, mode=\textcolor{stringliteral}{'markers'})}
\DoxyCodeLine{596     fig = go.Figure(data)}
\DoxyCodeLine{597     fig.show()}
\DoxyCodeLine{598     }
\DoxyCodeLine{599     \textcolor{keywordflow}{return} data}
\DoxyCodeLine{600 }
\DoxyCodeLine{601 }

\end{DoxyCode}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_af6619867dfdc02c14995d64df42314f3}\label{namespace_dice_py_1_1dice__visualise_af6619867dfdc02c14995d64df42314f3}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!plot\_3D@{plot\_3D}}
\index{plot\_3D@{plot\_3D}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{plot\_3D()}{plot\_3D()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+plot\+\_\+3D (\begin{DoxyParamCaption}\item[{}]{X,  }\item[{}]{Y,  }\item[{}]{Z,  }\item[{}]{wfn }\end{DoxyParamCaption})}



Definition at line 602 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{602 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_aaecb354ce844d441ff41cd60c875e36f}{plot\_3D}}(X,Y,Z,wfn):}
\DoxyCodeLine{603     \textcolor{comment}{\#for plotting wavefunctions, to be removed}}
\DoxyCodeLine{604     fig = go.Figure(data=go.Volume(}
\DoxyCodeLine{605         x=X.flatten(),}
\DoxyCodeLine{606         y=Y.flatten(),}
\DoxyCodeLine{607         z=Z.flatten(),}
\DoxyCodeLine{608         value=wfn.flatten(),}
\DoxyCodeLine{609         isomin=0.0,}
\DoxyCodeLine{610         isomax=1.2,}
\DoxyCodeLine{611         opacity=0.1, }
\DoxyCodeLine{612         surface\_count=21, }
\DoxyCodeLine{613     ))}
\DoxyCodeLine{614 }
\DoxyCodeLine{615     \textcolor{comment}{\#fig.save("{}wavefunction.png"{})}}
\DoxyCodeLine{616 }
\DoxyCodeLine{617     \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{618 }
\DoxyCodeLine{619 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_af6619867dfdc02c14995d64df42314f3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a5a0c22f15d7ec362e1e8063e090cff12}\label{namespace_dice_py_1_1dice__visualise_a5a0c22f15d7ec362e1e8063e090cff12}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!process\_main\_results@{process\_main\_results}}
\index{process\_main\_results@{process\_main\_results}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{process\_main\_results()}{process\_main\_results()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+process\+\_\+main\+\_\+results (\begin{DoxyParamCaption}\item[{}]{filename = {\ttfamily \textquotesingle{}results.nc\textquotesingle{}},  }\item[{}]{verbose = {\ttfamily True} }\end{DoxyParamCaption})}



Processes the results output as a result of the parameter search from the Net\+CDF4 file. 

\begin{DoxyVerb}Parameters:
    filename: Defaults to 'results.nc'. The file which contains the data output by the parameter search
\end{DoxyVerb}
 

Definition at line 620 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{620 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a5a0c22f15d7ec362e1e8063e090cff12}{process\_main\_results}}(filename='results.nc', verbose = True):}
\DoxyCodeLine{621     \textcolor{stringliteral}{"{}"{}"{}Processes the results output as a result of the parameter search from the NetCDF4 file}}
\DoxyCodeLine{622 \textcolor{stringliteral}{}}
\DoxyCodeLine{623 \textcolor{stringliteral}{    Parameters:}}
\DoxyCodeLine{624 \textcolor{stringliteral}{        filename: Defaults to 'results.nc'. The file which contains the data output by the parameter search}}
\DoxyCodeLine{625 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{626 }
\DoxyCodeLine{627 }
\DoxyCodeLine{628 }
\DoxyCodeLine{629     rootgrp = \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ade39cf6264b70d0cd62d9ff89742c62e}{load\_results}}(filename)}
\DoxyCodeLine{630 }
\DoxyCodeLine{631     global\_attr = \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a86a6e09c72837b5f17066a3eee79087e}{load\_global\_attr}}(rootgrp, verbose)}
\DoxyCodeLine{632 }
\DoxyCodeLine{633     variables = \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_abbdc54b3066752afd14b554b0791e96d}{load\_variables}}(rootgrp, verbose)}
\DoxyCodeLine{634 }
\DoxyCodeLine{635 }
\DoxyCodeLine{636     \textcolor{keywordflow}{if} (global\_attr[\textcolor{stringliteral}{'system'}] == \textcolor{stringliteral}{'QHO'}):}
\DoxyCodeLine{637         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{638         \textcolor{comment}{\#data1 = QHO\_eng\_plot(rootgrp)}}
\DoxyCodeLine{639         \textcolor{comment}{\#fig = QHO\_prob\_plot(rootgrp)}}
\DoxyCodeLine{640     elif(global\_attr[\textcolor{stringliteral}{'system'}] == \textcolor{stringliteral}{'H2plus'}):}
\DoxyCodeLine{641         main\_fig = \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a12b764183adcced19e3e7bf8a10f4e92}{H2\_eng\_plot}}(variables)}
\DoxyCodeLine{642         }
\DoxyCodeLine{643 }
\DoxyCodeLine{644     elif(global\_attr[\textcolor{stringliteral}{'system'}] == \textcolor{stringliteral}{'H2'}):}
\DoxyCodeLine{645         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{646 }
\DoxyCodeLine{647     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{648             \textcolor{keywordflow}{raise} Exception(\textcolor{stringliteral}{"{}Invalid system input into visualisation"{}})}
\DoxyCodeLine{649             }
\DoxyCodeLine{650     \textcolor{keywordflow}{return} global\_attr,variables,main\_fig}
\DoxyCodeLine{651 }
\DoxyCodeLine{652 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_a5a0c22f15d7ec362e1e8063e090cff12_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a71f87402b5309230c1d68d46263bf848}\label{namespace_dice_py_1_1dice__visualise_a71f87402b5309230c1d68d46263bf848}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!plot\_markov\_chain@{plot\_markov\_chain}}
\index{plot\_markov\_chain@{plot\_markov\_chain}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{plot\_markov\_chain()}{plot\_markov\_chain()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+plot\+\_\+markov\+\_\+chain (\begin{DoxyParamCaption}\item[{}]{filename }\end{DoxyParamCaption})}



Definition at line 653 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{653 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a71f87402b5309230c1d68d46263bf848}{plot\_markov\_chain}}(filename):}
\DoxyCodeLine{654 }
\DoxyCodeLine{655     dset = nc.Dataset(filename)}
\DoxyCodeLine{656     }
\DoxyCodeLine{657     energies = dset[\textcolor{stringliteral}{'energies'}][:]}
\DoxyCodeLine{658 }
\DoxyCodeLine{659     positions = dset[\textcolor{stringliteral}{'positions'}][:] }
\DoxyCodeLine{660     }
\DoxyCodeLine{661     \textcolor{keywordflow}{if} dset.system == \textcolor{stringliteral}{'QHO'}:}
\DoxyCodeLine{662         }
\DoxyCodeLine{663         fig = \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a1e0fa890b9d36a8dc0d2cf886bdb47d0}{QHO\_prob\_plot}}(positions)}
\DoxyCodeLine{664         }
\DoxyCodeLine{665         \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{666         }
\DoxyCodeLine{667     \textcolor{keywordflow}{elif} dset.system == \textcolor{stringliteral}{'H2'} \textcolor{keywordflow}{or} dset.system == \textcolor{stringliteral}{'H2plus'}:}
\DoxyCodeLine{668 }
\DoxyCodeLine{669         R1 = [-\/0.5*dset.bond\_length, 0, 0]}
\DoxyCodeLine{670         R2 = [0.5*dset.bond\_length, 0, 0]}
\DoxyCodeLine{671     }
\DoxyCodeLine{672         fig = vis.H2\_prob\_plot(positions, energies, R1, R2)}
\DoxyCodeLine{673         }
\DoxyCodeLine{674         \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{675 }
\DoxyCodeLine{676 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_a71f87402b5309230c1d68d46263bf848_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a94102fa6eb01dcccc8b10c387f4bd9eb}\label{namespace_dice_py_1_1dice__visualise_a94102fa6eb01dcccc8b10c387f4bd9eb}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!orb\_1s@{orb\_1s}}
\index{orb\_1s@{orb\_1s}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{orb\_1s()}{orb\_1s()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+orb\+\_\+1s (\begin{DoxyParamCaption}\item[{}]{X,  }\item[{}]{Y,  }\item[{}]{Z,  }\item[{}]{R\+\_\+a }\end{DoxyParamCaption})}



functions plotting the wavefunction ab initio \#\#\#\#\#\#\# 



Definition at line 679 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{679 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a94102fa6eb01dcccc8b10c387f4bd9eb}{orb\_1s}}(X,Y,Z, R\_a): \textcolor{comment}{\#R\_a is the location of the atoms}}
\DoxyCodeLine{680     x\_a,y\_a,z\_a = R\_a}
\DoxyCodeLine{681     a0 = 1}
\DoxyCodeLine{682     orbital = 1/(((a0**1.5)*(np.sqrt(np.pi)))*\(\backslash\)}
\DoxyCodeLine{683                  np.exp(np.sqrt((X-\/x\_a)**2+(Y-\/y\_a)**2+(Z-\/z\_a)**2)/a0))}
\DoxyCodeLine{684     \textcolor{keywordflow}{return} orbital}
\DoxyCodeLine{685 }
\DoxyCodeLine{686 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_a94102fa6eb01dcccc8b10c387f4bd9eb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a47f4a634a4bd3ca1498a2d262feb88c9}\label{namespace_dice_py_1_1dice__visualise_a47f4a634a4bd3ca1498a2d262feb88c9}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!orb\_2s@{orb\_2s}}
\index{orb\_2s@{orb\_2s}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{orb\_2s()}{orb\_2s()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+orb\+\_\+2s (\begin{DoxyParamCaption}\item[{}]{r,  }\item[{}]{R\+\_\+a }\end{DoxyParamCaption})}



Definition at line 687 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{687 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a47f4a634a4bd3ca1498a2d262feb88c9}{orb\_2s}}(r,R\_a):}
\DoxyCodeLine{688     a0 = 1}
\DoxyCodeLine{689     orbital = (2-\/np.linalg.norm(r-\/R\_a)()/a0)/((4*(a0**1.5)*(np.sqrt(2*np.pi)))*np.exp(np.linalg.norm(r-\/R\_a)/(2*a0)))}
\DoxyCodeLine{690     \textcolor{keywordflow}{return} orbital}
\DoxyCodeLine{691 }
\DoxyCodeLine{692 }

\end{DoxyCode}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_a163ee968729a70b3b9f653ebed51045d}\label{namespace_dice_py_1_1dice__visualise_a163ee968729a70b3b9f653ebed51045d}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!polar\_to\_cart@{polar\_to\_cart}}
\index{polar\_to\_cart@{polar\_to\_cart}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{polar\_to\_cart()}{polar\_to\_cart()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+polar\+\_\+to\+\_\+cart (\begin{DoxyParamCaption}\item[{}]{r,  }\item[{}]{theta,  }\item[{}]{phi }\end{DoxyParamCaption})}



Definition at line 693 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{693 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a163ee968729a70b3b9f653ebed51045d}{polar\_to\_cart}}(r,theta, phi):}
\DoxyCodeLine{694     X = r*np.sin(phi)*np.cos(theta)}
\DoxyCodeLine{695     Y = r*np.sin(phi)*np.sin(theta)}
\DoxyCodeLine{696     Z = r*np.cos(phi)}
\DoxyCodeLine{697 }
\DoxyCodeLine{698     \textcolor{keywordflow}{return} X,Y,Z}
\DoxyCodeLine{699     }
\DoxyCodeLine{700 }

\end{DoxyCode}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_aa7a7248206840811fa4e6ac835142af5}\label{namespace_dice_py_1_1dice__visualise_aa7a7248206840811fa4e6ac835142af5}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!lcao\_wfn@{lcao\_wfn}}
\index{lcao\_wfn@{lcao\_wfn}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{lcao\_wfn()}{lcao\_wfn()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+lcao\+\_\+wfn (\begin{DoxyParamCaption}\item[{}]{X,  }\item[{}]{Y,  }\item[{}]{Z,  }\item[{}]{R1,  }\item[{}]{R2,  }\item[{}]{pqn = {\ttfamily 1} }\end{DoxyParamCaption})}



Definition at line 701 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{701 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_aa7a7248206840811fa4e6ac835142af5}{lcao\_wfn}}(X,Y,Z, R1, R2, pqn = 1):}
\DoxyCodeLine{702     \textcolor{comment}{\#for the linear combination of wavefunctions, to be added to and to be remove}}
\DoxyCodeLine{703     \textcolor{keywordflow}{if} pqn == 1:}
\DoxyCodeLine{704          wfn = np.sqrt(2)*\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a94102fa6eb01dcccc8b10c387f4bd9eb}{orb\_1s}}(X,Y,Z,R1) + np.sqrt(2)*\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_a94102fa6eb01dcccc8b10c387f4bd9eb}{orb\_1s}}(X,Y,Z,R2)}
\DoxyCodeLine{705     \textcolor{keywordflow}{if} pqn == 2:}
\DoxyCodeLine{706         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{707 }
\DoxyCodeLine{708     \textcolor{keywordflow}{return} wfn}
\DoxyCodeLine{709 }
\DoxyCodeLine{710 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_aa7a7248206840811fa4e6ac835142af5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_aa7a7248206840811fa4e6ac835142af5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_aaecb354ce844d441ff41cd60c875e36f}\label{namespace_dice_py_1_1dice__visualise_aaecb354ce844d441ff41cd60c875e36f}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!plot\_3D@{plot\_3D}}
\index{plot\_3D@{plot\_3D}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{plot\_3D()}{plot\_3D()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+plot\+\_\+3D (\begin{DoxyParamCaption}\item[{}]{X,  }\item[{}]{Y,  }\item[{}]{Z,  }\item[{}]{wfn,  }\item[{}]{R1,  }\item[{}]{R2 }\end{DoxyParamCaption})}



Function for plotting the wavefunction analytically. 

Meshgrids can be generated using np.\+meshgrid(x,y,z)

Parameters\+: X\+: Meshgrid of X coordinates Y\+: Meshgrid of Y coordinates Z\+: Meshgrid of Z coordinates 

Definition at line 711 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{711 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_aaecb354ce844d441ff41cd60c875e36f}{plot\_3D}}(X,Y,Z,wfn,R1,R2):}
\DoxyCodeLine{712     \textcolor{stringliteral}{"{}"{}"{} Function for plotting the wavefunction analytically. Meshgrids can be generated using np.meshgrid(x,y,z)}}
\DoxyCodeLine{713 \textcolor{stringliteral}{}}
\DoxyCodeLine{714 \textcolor{stringliteral}{    Parameters:}}
\DoxyCodeLine{715 \textcolor{stringliteral}{        X: Meshgrid of X coordinates}}
\DoxyCodeLine{716 \textcolor{stringliteral}{        Y: Meshgrid of Y coordinates}}
\DoxyCodeLine{717 \textcolor{stringliteral}{        Z: Meshgrid of Z coordinates}}
\DoxyCodeLine{718 \textcolor{stringliteral}{    "{}"{}"{}} }
\DoxyCodeLine{719 }
\DoxyCodeLine{720     fig = go.Figure()}
\DoxyCodeLine{721     \textcolor{comment}{\#for plotting wavefunctions, to be removed}}
\DoxyCodeLine{722     fig.add\_trace(go.Volume(}
\DoxyCodeLine{723     x=X.flatten(),}
\DoxyCodeLine{724     y=Y.flatten(),}
\DoxyCodeLine{725     z=Z.flatten(),}
\DoxyCodeLine{726     value=wfn.flatten(),}
\DoxyCodeLine{727     opacity=0.1, }
\DoxyCodeLine{728     surface\_count=21, }
\DoxyCodeLine{729     ))}
\DoxyCodeLine{730     }
\DoxyCodeLine{731     fig.add\_trace(go.Scatter3d(}
\DoxyCodeLine{732         mode=\textcolor{stringliteral}{'markers'},}
\DoxyCodeLine{733         x=[R1[0],R2[0]],}
\DoxyCodeLine{734         y=[R1[1],R2[1]],}
\DoxyCodeLine{735         z=[R1[2],R2[2]],}
\DoxyCodeLine{736         opacity=1.0,}
\DoxyCodeLine{737         marker=dict(}
\DoxyCodeLine{738             color=\textcolor{stringliteral}{'\#AAAAAA'},}
\DoxyCodeLine{739             size=10,}
\DoxyCodeLine{740             line=dict(}
\DoxyCodeLine{741                 color=\textcolor{stringliteral}{'Black'},}
\DoxyCodeLine{742                 width=2}
\DoxyCodeLine{743                 )}
\DoxyCodeLine{744             ),}
\DoxyCodeLine{745             name=\textcolor{stringliteral}{'Atoms'}}
\DoxyCodeLine{746         )}
\DoxyCodeLine{747     )}
\DoxyCodeLine{748     \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{749 }
\DoxyCodeLine{750 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_aaecb354ce844d441ff41cd60c875e36f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespace_dice_py_1_1dice__visualise_ac82e6fdf20ce6eca6265e10dc59acc08}\label{namespace_dice_py_1_1dice__visualise_ac82e6fdf20ce6eca6265e10dc59acc08}} 
\index{DicePy.dice\_visualise@{DicePy.dice\_visualise}!example\_H1s\_wfn@{example\_H1s\_wfn}}
\index{example\_H1s\_wfn@{example\_H1s\_wfn}!DicePy.dice\_visualise@{DicePy.dice\_visualise}}
\doxysubsubsection{\texorpdfstring{example\_H1s\_wfn()}{example\_H1s\_wfn()}}
{\footnotesize\ttfamily def Dice\+Py.\+dice\+\_\+visualise.\+example\+\_\+\+H1s\+\_\+wfn (\begin{DoxyParamCaption}\item[{}]{bond\+\_\+length = {\ttfamily 2.0} }\end{DoxyParamCaption})}



Definition at line 751 of file dice\+\_\+visualise.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{751 \textcolor{keyword}{def }\mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_ac82e6fdf20ce6eca6265e10dc59acc08}{example\_H1s\_wfn}}(bond\_length=2.0):}
\DoxyCodeLine{752     }
\DoxyCodeLine{753     x, y, z = np.mgrid[-\/3:3:40j, -\/3:3:40j, -\/3:3:40j]}
\DoxyCodeLine{754 }
\DoxyCodeLine{755     R\_1 = (-\/0.5*bond\_length, 0,0)}
\DoxyCodeLine{756     R\_2 = (0.5*bond\_length, 0,0)}
\DoxyCodeLine{757     }
\DoxyCodeLine{758     wfn = \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_aa7a7248206840811fa4e6ac835142af5}{lcao\_wfn}}(x,y,z,R\_1,R\_2)}
\DoxyCodeLine{759     density = wfn**2}
\DoxyCodeLine{760     }
\DoxyCodeLine{761     density\_plot = \mbox{\hyperlink{namespace_dice_py_1_1dice__visualise_aaecb354ce844d441ff41cd60c875e36f}{plot\_3D}}(x,y,z,density,R\_1,R\_2)}
\DoxyCodeLine{762     \textcolor{keywordflow}{return} density\_plot}
\DoxyCodeLine{763 }
\DoxyCodeLine{764     \textcolor{keywordflow}{return} wfn}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespace_dice_py_1_1dice__visualise_ac82e6fdf20ce6eca6265e10dc59acc08_cgraph}
\end{center}
\end{figure}
