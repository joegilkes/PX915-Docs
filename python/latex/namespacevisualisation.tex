\hypertarget{namespacevisualisation}{}\doxysection{visualisation Namespace Reference}
\label{namespacevisualisation}\index{visualisation@{visualisation}}


Contains functions for burning/thinning and visualization for Dice.  


\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{namespacevisualisation_a5c80a150bab5e4176013e33b5fec9816}{load\+\_\+results}} (filename=\textquotesingle{}results.\+nc\textquotesingle{})
\begin{DoxyCompactList}\small\item\em Loads the results as a dataset Net\+CDF object to be passed to other functions. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacevisualisation_a6a2287f360d1e76cd639bd70f229fe6c}{load\+\_\+global\+\_\+attr}} (rootgrp, verbose=True)
\begin{DoxyCompactList}\small\item\em Loads the global metadata in the results file into a dictionary. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacevisualisation_a72a74f351b2aeb7073d75d659c0a37fe}{load\+\_\+variables}} (rootgrp, verbose=True)
\begin{DoxyCompactList}\small\item\em Loads the variables in the results file into a dictionary. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacevisualisation_a9e23aabdaf405841cfdfd7c6cc2800e0}{QHO\+\_\+eng\+\_\+plot}} (rootgrp, equil=False)
\begin{DoxyCompactList}\small\item\em energy\+\_\+plot() Plots the energy at each step as the MC converges \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacevisualisation_ad727a435fed6e71da862d749a6169558}{QHO\+\_\+prob\+\_\+plot}} (rootgrp)
\item 
def \mbox{\hyperlink{namespacevisualisation_a15512bdc0a35b851921f281f89e6460f}{H2\+\_\+eng\+\_\+plot}} (variables)
\begin{DoxyCompactList}\small\item\em Plots the energies against the parameters checked during the grid search Parameters\+: variables\+: Dictionary which contains data about the variables in the netcdf4 object. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacevisualisation_afd9acdd2f2d70052a6eac6d2bbf9820f}{H2\+Prob\+Plot}} (chainfile)
\item 
def \mbox{\hyperlink{namespacevisualisation_a665238431e964d48ad871c62f97c0eeb}{H2\+\_\+prob\+\_\+plot}} (X, Y, Z, R1, R2)
\begin{DoxyCompactList}\small\item\em H2plus\+\_\+main\+\_\+plot() Plots the wavefunction for the quantum harmonic oscillator case. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacevisualisation_ad3e838717595f5a5a4f080cfe6c73c05}{process\+\_\+main\+\_\+results}} (filename=\textquotesingle{}results.\+nc\textquotesingle{}, verbose=True)
\begin{DoxyCompactList}\small\item\em Processes the results output as a result of the parameter search from the Net\+CDF4 file. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacevisualisation_aee22ef0385ad565e03cc2c8aae5c10c2}{orb\+\_\+1s}} (X, Y, Z, R\+\_\+a)
\begin{DoxyCompactList}\small\item\em functions plotting the wavefunction ab initio \#\#\#\#\#\#\# \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacevisualisation_a622c163e8aa656ccc9b1745a3bfe545b}{orb\+\_\+2s}} (r, R\+\_\+a)
\item 
def \mbox{\hyperlink{namespacevisualisation_aa711c68ba9bc3ff10d2589890a785ed2}{polar\+\_\+to\+\_\+cart}} (r, theta, phi)
\item 
def \mbox{\hyperlink{namespacevisualisation_a8518056c83c83befbb585f14d97497d8}{lcao\+\_\+wfn}} (X, Y, Z, R1, R2, pqn=1)
\item 
def \mbox{\hyperlink{namespacevisualisation_a9756d369d218ccf60a488ec02542eac6}{plot\+\_\+3D}} (X, Y, Z, wfn, R1, R2)
\item 
def \mbox{\hyperlink{namespacevisualisation_a73a6709541da1825e8af407b3558240e}{example\+\_\+\+H1s\+\_\+wfn}} (bond\+\_\+length=2.\+0)
\item 
def \mbox{\hyperlink{namespacevisualisation_a58db1c83502abb038c648f3bb1076432}{plot\+\_\+3D}} (X, Y, Z, wfn)
\item 
def \mbox{\hyperlink{namespacevisualisation_ac345463eb554d7c90613773996e74748}{view\+\_\+original\+\_\+trace}} (filename)
\begin{DoxyCompactList}\small\item\em Plots the original trace(s) of an MCMC run. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespacevisualisation_a26c9ab9270b803a8d15c40d621769c46}{get\+\_\+autocorrelation\+\_\+time}} (filename, burn, tuning, plotting=True)
\begin{DoxyCompactList}\small\item\em Function which suggests a thinning parameter for a MCMC chain. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains functions for burning/thinning and visualization for Dice. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespacevisualisation_a5c80a150bab5e4176013e33b5fec9816}\label{namespacevisualisation_a5c80a150bab5e4176013e33b5fec9816}} 
\index{visualisation@{visualisation}!load\_results@{load\_results}}
\index{load\_results@{load\_results}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{load\_results()}{load\_results()}}
{\footnotesize\ttfamily def visualisation.\+load\+\_\+results (\begin{DoxyParamCaption}\item[{}]{filename = {\ttfamily \textquotesingle{}results.nc\textquotesingle{}} }\end{DoxyParamCaption})}



Loads the results as a dataset Net\+CDF object to be passed to other functions. 

\begin{DoxyVerb}Parameters:
    filename: The name of the file containing the results, defaults to 'results.nc'. 
\end{DoxyVerb}
 

Definition at line 17 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{17 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a5c80a150bab5e4176013e33b5fec9816}{load\_results}}(filename = 'results.nc'):}
\DoxyCodeLine{18 }
\DoxyCodeLine{19     \textcolor{stringliteral}{"{}"{}"{}Loads the results as a dataset NetCDF object to be passed to other functions}}
\DoxyCodeLine{20 \textcolor{stringliteral}{    }}
\DoxyCodeLine{21 \textcolor{stringliteral}{    Parameters:}}
\DoxyCodeLine{22 \textcolor{stringliteral}{        filename: The name of the file containing the results, defaults to 'results.nc'. "{}"{}"{}}}
\DoxyCodeLine{23     }
\DoxyCodeLine{24     \textcolor{keywordflow}{try}:}
\DoxyCodeLine{25         rootgrp = Dataset(filename)}
\DoxyCodeLine{26     \textcolor{keywordflow}{except} OSError \textcolor{keyword}{as} err:}
\DoxyCodeLine{27         print(f\textcolor{stringliteral}{"{}OS error: \{err\}"{}})}
\DoxyCodeLine{28     \textcolor{keywordflow}{return} rootgrp}
\DoxyCodeLine{29 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{namespacevisualisation_a5c80a150bab5e4176013e33b5fec9816_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_a6a2287f360d1e76cd639bd70f229fe6c}\label{namespacevisualisation_a6a2287f360d1e76cd639bd70f229fe6c}} 
\index{visualisation@{visualisation}!load\_global\_attr@{load\_global\_attr}}
\index{load\_global\_attr@{load\_global\_attr}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{load\_global\_attr()}{load\_global\_attr()}}
{\footnotesize\ttfamily def visualisation.\+load\+\_\+global\+\_\+attr (\begin{DoxyParamCaption}\item[{}]{rootgrp,  }\item[{}]{verbose = {\ttfamily True} }\end{DoxyParamCaption})}



Loads the global metadata in the results file into a dictionary. 

\begin{DoxyVerb}Parameters:
    rootgrp: NetCDF4 dataset object which loaded in using 'load_results()'.
    verbose: Defaults to true. Prints the value of global attributes which have been loaded
\end{DoxyVerb}
 

Definition at line 30 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{30 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a6a2287f360d1e76cd639bd70f229fe6c}{load\_global\_attr}}(rootgrp, verbose = True):}
\DoxyCodeLine{31     \textcolor{stringliteral}{"{}"{}"{}Loads the global metadata in the results file into a dictionary}}
\DoxyCodeLine{32 \textcolor{stringliteral}{    }}
\DoxyCodeLine{33 \textcolor{stringliteral}{    Parameters:}}
\DoxyCodeLine{34 \textcolor{stringliteral}{        rootgrp: NetCDF4 dataset object which loaded in using 'load\_results()'.}}
\DoxyCodeLine{35 \textcolor{stringliteral}{        verbose: Defaults to true. Prints the value of global attributes which have been loaded}}
\DoxyCodeLine{36 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{37     global\_dict =\{\}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39     \textcolor{keywordflow}{for} name \textcolor{keywordflow}{in} rootgrp.ncattrs():}
\DoxyCodeLine{40         \textcolor{keywordflow}{if} verbose:}
\DoxyCodeLine{41             print(\textcolor{stringliteral}{"{}\{\} = \{\}"{}}.format(name, getattr(rootgrp, name)))}
\DoxyCodeLine{42 }
\DoxyCodeLine{43     global\_dict[name] = getattr(rootgrp, name)}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{keywordflow}{return} global\_dict}
\DoxyCodeLine{47 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{namespacevisualisation_a6a2287f360d1e76cd639bd70f229fe6c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_a72a74f351b2aeb7073d75d659c0a37fe}\label{namespacevisualisation_a72a74f351b2aeb7073d75d659c0a37fe}} 
\index{visualisation@{visualisation}!load\_variables@{load\_variables}}
\index{load\_variables@{load\_variables}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{load\_variables()}{load\_variables()}}
{\footnotesize\ttfamily def visualisation.\+load\+\_\+variables (\begin{DoxyParamCaption}\item[{}]{rootgrp,  }\item[{}]{verbose = {\ttfamily True} }\end{DoxyParamCaption})}



Loads the variables in the results file into a dictionary. 

\begin{DoxyVerb}Parameters:
    rootgrp: NetCDF4 dataset object which loaded in using 'load_results()'
    verbose: Defaults to true. Prints the value of variables which have been loaded
\end{DoxyVerb}
 

Definition at line 48 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{48 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a72a74f351b2aeb7073d75d659c0a37fe}{load\_variables}}(rootgrp, verbose = True):}
\DoxyCodeLine{49     \textcolor{stringliteral}{"{}"{}"{}Loads the variables in the results file into a dictionary}}
\DoxyCodeLine{50 \textcolor{stringliteral}{    }}
\DoxyCodeLine{51 \textcolor{stringliteral}{    Parameters:}}
\DoxyCodeLine{52 \textcolor{stringliteral}{        rootgrp: NetCDF4 dataset object which loaded in using 'load\_results()'}}
\DoxyCodeLine{53 \textcolor{stringliteral}{        verbose: Defaults to true. Prints the value of variables which have been loaded}}
\DoxyCodeLine{54 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{55     var\_dict = \{\}}
\DoxyCodeLine{56     \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} rootgrp.variables.keys():}
\DoxyCodeLine{57         \textcolor{keywordflow}{if} verbose:}
\DoxyCodeLine{58             print(\textcolor{stringliteral}{"{}\{\} = \{\}"{}}.format(k, rootgrp[k][:]))}
\DoxyCodeLine{59         var\_dict[k] = rootgrp[k][:]}
\DoxyCodeLine{60 }
\DoxyCodeLine{61     \textcolor{keywordflow}{return} var\_dict}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 }
\DoxyCodeLine{64 \textcolor{comment}{\#}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=314pt]{namespacevisualisation_a72a74f351b2aeb7073d75d659c0a37fe_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_a9e23aabdaf405841cfdfd7c6cc2800e0}\label{namespacevisualisation_a9e23aabdaf405841cfdfd7c6cc2800e0}} 
\index{visualisation@{visualisation}!QHO\_eng\_plot@{QHO\_eng\_plot}}
\index{QHO\_eng\_plot@{QHO\_eng\_plot}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{QHO\_eng\_plot()}{QHO\_eng\_plot()}}
{\footnotesize\ttfamily def visualisation.\+QHO\+\_\+eng\+\_\+plot (\begin{DoxyParamCaption}\item[{}]{rootgrp,  }\item[{}]{equil = {\ttfamily False} }\end{DoxyParamCaption})}



energy\+\_\+plot() Plots the energy at each step as the MC converges 



Definition at line 65 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{65 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a9e23aabdaf405841cfdfd7c6cc2800e0}{QHO\_eng\_plot}}(rootgrp,equil=False):}
\DoxyCodeLine{66     \textcolor{stringliteral}{"{}"{}"{}energy\_plot()}}
\DoxyCodeLine{67 \textcolor{stringliteral}{    Plots the energy at each step as the MC converges}}
\DoxyCodeLine{68 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70     energies = np.array(rootgrp.variables[\textcolor{stringliteral}{'energy\_at\_alphas\_array'}][:])}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     alphas = np.array((rootgrp.variables[\textcolor{stringliteral}{'Alpha\_array'}][:]))}
\DoxyCodeLine{73 }
\DoxyCodeLine{74     \textcolor{keywordflow}{if} (equil):}
\DoxyCodeLine{75         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77     data = go.Scatter(x=alphas, y=energies, mode=\textcolor{stringliteral}{'markers'})}
\DoxyCodeLine{78     fig = go.Figure(data)}
\DoxyCodeLine{79     fig.show()}
\DoxyCodeLine{80     }
\DoxyCodeLine{81     \textcolor{keywordflow}{return} data}
\DoxyCodeLine{82     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacevisualisation_ad727a435fed6e71da862d749a6169558}\label{namespacevisualisation_ad727a435fed6e71da862d749a6169558}} 
\index{visualisation@{visualisation}!QHO\_prob\_plot@{QHO\_prob\_plot}}
\index{QHO\_prob\_plot@{QHO\_prob\_plot}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{QHO\_prob\_plot()}{QHO\_prob\_plot()}}
{\footnotesize\ttfamily def visualisation.\+QHO\+\_\+prob\+\_\+plot (\begin{DoxyParamCaption}\item[{}]{rootgrp }\end{DoxyParamCaption})}



Definition at line 83 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{83 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_ad727a435fed6e71da862d749a6169558}{QHO\_prob\_plot}}(rootgrp):}
\DoxyCodeLine{84     }
\DoxyCodeLine{85     positions = np.array((rootgrp.variables[\textcolor{stringliteral}{'Alpha\_array'}][:]))}
\DoxyCodeLine{86     \textcolor{comment}{\#data2 =  trying to figure out how to do a histogram using the go package. If not possible, switch to mpl}}
\DoxyCodeLine{87     }
\DoxyCodeLine{88     \textcolor{comment}{\#fig2 = ff.create\_distplot(positions, 'distribution', colors='\#FF0000',bin\_size=, show\_rug=False)}}
\DoxyCodeLine{89     \textcolor{comment}{\#fig2.show()}}
\DoxyCodeLine{90 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacevisualisation_a15512bdc0a35b851921f281f89e6460f}\label{namespacevisualisation_a15512bdc0a35b851921f281f89e6460f}} 
\index{visualisation@{visualisation}!H2\_eng\_plot@{H2\_eng\_plot}}
\index{H2\_eng\_plot@{H2\_eng\_plot}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{H2\_eng\_plot()}{H2\_eng\_plot()}}
{\footnotesize\ttfamily def visualisation.\+H2\+\_\+eng\+\_\+plot (\begin{DoxyParamCaption}\item[{}]{variables }\end{DoxyParamCaption})}



Plots the energies against the parameters checked during the grid search Parameters\+: variables\+: Dictionary which contains data about the variables in the netcdf4 object. 



Definition at line 91 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{91 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a15512bdc0a35b851921f281f89e6460f}{H2\_eng\_plot}}(variables):}
\DoxyCodeLine{92     \textcolor{stringliteral}{"{}"{}"{}Plots the energies against the parameters checked during the grid search}}
\DoxyCodeLine{93 \textcolor{stringliteral}{       Parameters:}}
\DoxyCodeLine{94 \textcolor{stringliteral}{         variables: Dictionary which contains data about the variables in the netcdf4 object"{}"{}"{}}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 }
\DoxyCodeLine{97     fig = go.Figure()}
\DoxyCodeLine{98 }
\DoxyCodeLine{99     fig.add\_trace(}
\DoxyCodeLine{100         go.Scatter(}
\DoxyCodeLine{101             x=variables[\textcolor{stringliteral}{'Bondlength\_array'}],}
\DoxyCodeLine{102             y=variables[\textcolor{stringliteral}{'total\_energies'}],}
\DoxyCodeLine{103             error\_y=dict(}
\DoxyCodeLine{104             type=\textcolor{stringliteral}{'data'},}
\DoxyCodeLine{105             array=variables[\textcolor{stringliteral}{'Uncertainties'}],}
\DoxyCodeLine{106             visible=\textcolor{keyword}{True})}
\DoxyCodeLine{107             )}
\DoxyCodeLine{108         )}
\DoxyCodeLine{109     }
\DoxyCodeLine{110     fig.update\_layout(}
\DoxyCodeLine{111     title=f\textcolor{stringliteral}{"{}Energies vs Bond Lengths"{}},}
\DoxyCodeLine{112     xaxis\_title=\textcolor{stringliteral}{"{}Bond Length"{}},}
\DoxyCodeLine{113     yaxis\_title=\textcolor{stringliteral}{"{}Energy"{}}}
\DoxyCodeLine{114     )}
\DoxyCodeLine{115 }
\DoxyCodeLine{116     }
\DoxyCodeLine{117 }
\DoxyCodeLine{118     }
\DoxyCodeLine{119     fig.show()}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     }
\DoxyCodeLine{122     \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{123     }
\DoxyCodeLine{124     \textcolor{comment}{\#function due to change depending on how complicated our grid parameter search is}}
\DoxyCodeLine{125 }
\DoxyCodeLine{126 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevisualisation_a15512bdc0a35b851921f281f89e6460f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_afd9acdd2f2d70052a6eac6d2bbf9820f}\label{namespacevisualisation_afd9acdd2f2d70052a6eac6d2bbf9820f}} 
\index{visualisation@{visualisation}!H2ProbPlot@{H2ProbPlot}}
\index{H2ProbPlot@{H2ProbPlot}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{H2ProbPlot()}{H2ProbPlot()}}
{\footnotesize\ttfamily def visualisation.\+H2\+Prob\+Plot (\begin{DoxyParamCaption}\item[{}]{chainfile }\end{DoxyParamCaption})}



Definition at line 127 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{127 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_afd9acdd2f2d70052a6eac6d2bbf9820f}{H2ProbPlot}}(chainfile):}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     dat = Dataset(chainfile, \textcolor{stringliteral}{'r'}, format=\textcolor{stringliteral}{'NETCDF4'})}
\DoxyCodeLine{130 }
\DoxyCodeLine{131     positions = dat.variables[\textcolor{stringliteral}{'positions'}][:, :]}
\DoxyCodeLine{132     bond\_length = dat.bond\_length}
\DoxyCodeLine{133 }
\DoxyCodeLine{134     x\_pos = positions[:, 0]}
\DoxyCodeLine{135     y\_pos = positions[:, 1]}
\DoxyCodeLine{136     z\_pos = positions[:, 2]}
\DoxyCodeLine{137     R1 = [-\/bond\_length/2, 0.0, 0.0]}
\DoxyCodeLine{138     R2 = [bond\_length/2, 0.0, 0.0]}
\DoxyCodeLine{139 }
\DoxyCodeLine{140     print(len(positions))}
\DoxyCodeLine{141 }
\DoxyCodeLine{142     fig = \mbox{\hyperlink{namespacevisualisation_a665238431e964d48ad871c62f97c0eeb}{H2\_prob\_plot}}(x\_pos, y\_pos, z\_pos, R1, R2)}
\DoxyCodeLine{143 }
\DoxyCodeLine{144     fig.show()}
\DoxyCodeLine{145 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevisualisation_afd9acdd2f2d70052a6eac6d2bbf9820f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_a665238431e964d48ad871c62f97c0eeb}\label{namespacevisualisation_a665238431e964d48ad871c62f97c0eeb}} 
\index{visualisation@{visualisation}!H2\_prob\_plot@{H2\_prob\_plot}}
\index{H2\_prob\_plot@{H2\_prob\_plot}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{H2\_prob\_plot()}{H2\_prob\_plot()}}
{\footnotesize\ttfamily def visualisation.\+H2\+\_\+prob\+\_\+plot (\begin{DoxyParamCaption}\item[{}]{X,  }\item[{}]{Y,  }\item[{}]{Z,  }\item[{}]{R1,  }\item[{}]{R2 }\end{DoxyParamCaption})}



H2plus\+\_\+main\+\_\+plot() Plots the wavefunction for the quantum harmonic oscillator case. 

X\+: Array of the x values in the markov chain Y\+: Array of the y values in the markov chain Z\+: Array of the z values in the markov chain

R1\+: The location of the first atom R2\+: The location of the second atom 

Definition at line 146 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{146 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a665238431e964d48ad871c62f97c0eeb}{H2\_prob\_plot}}(X,Y,Z, R1, R2):}
\DoxyCodeLine{147 }
\DoxyCodeLine{148     \textcolor{stringliteral}{"{}"{}"{} H2plus\_main\_plot()}}
\DoxyCodeLine{149 \textcolor{stringliteral}{    Plots the wavefunction for the quantum harmonic oscillator case}}
\DoxyCodeLine{150 \textcolor{stringliteral}{    }}
\DoxyCodeLine{151 \textcolor{stringliteral}{    X: Array of the x values in the markov chain}}
\DoxyCodeLine{152 \textcolor{stringliteral}{    Y: Array of the y values in the markov chain}}
\DoxyCodeLine{153 \textcolor{stringliteral}{    Z: Array of the z values in the markov chain}}
\DoxyCodeLine{154 \textcolor{stringliteral}{    }}
\DoxyCodeLine{155 \textcolor{stringliteral}{    R1: The location of the first atom}}
\DoxyCodeLine{156 \textcolor{stringliteral}{    R2: The location of the second atom}}
\DoxyCodeLine{157 \textcolor{stringliteral}{}}
\DoxyCodeLine{158 \textcolor{stringliteral}{    "{}"{}"{}}   }
\DoxyCodeLine{159     \textcolor{comment}{\#data=[go.Scatter3d(x=X, y=Y, z=Z,mode='markers')]}}
\DoxyCodeLine{160     }
\DoxyCodeLine{161     fig = go.Figure()}
\DoxyCodeLine{162     }
\DoxyCodeLine{163     }
\DoxyCodeLine{164     fig.add\_trace(}
\DoxyCodeLine{165     go.Scatter3d(}
\DoxyCodeLine{166         mode=\textcolor{stringliteral}{'markers'},}
\DoxyCodeLine{167         x=X,}
\DoxyCodeLine{168         y=Y,}
\DoxyCodeLine{169         z=Z,}
\DoxyCodeLine{170         opacity=0.5,}
\DoxyCodeLine{171         marker=dict(}
\DoxyCodeLine{172             color=\textcolor{stringliteral}{'\#FF0000'},}
\DoxyCodeLine{173             size=2,}
\DoxyCodeLine{174             line=dict(}
\DoxyCodeLine{175                 color=\textcolor{stringliteral}{'Black'},}
\DoxyCodeLine{176                 width=2}
\DoxyCodeLine{177                 )}
\DoxyCodeLine{178             ),}
\DoxyCodeLine{179             name=\textcolor{stringliteral}{'Markov Chain positions'}}
\DoxyCodeLine{180         )}
\DoxyCodeLine{181     )}
\DoxyCodeLine{182     }
\DoxyCodeLine{183     fig.add\_trace(}
\DoxyCodeLine{184         go.Scatter3d(}
\DoxyCodeLine{185         mode=\textcolor{stringliteral}{'markers'},}
\DoxyCodeLine{186         x=[R1[0],R2[0]],}
\DoxyCodeLine{187         y=[R1[1],R2[1]],}
\DoxyCodeLine{188         z=[R1[2],R2[2]],}
\DoxyCodeLine{189         opacity=1.0,}
\DoxyCodeLine{190         marker=dict(}
\DoxyCodeLine{191             color=\textcolor{stringliteral}{'\#AAAAAA'},}
\DoxyCodeLine{192             size=10,}
\DoxyCodeLine{193             line=dict(}
\DoxyCodeLine{194                 color=\textcolor{stringliteral}{'Black'},}
\DoxyCodeLine{195                 width=2}
\DoxyCodeLine{196                 )}
\DoxyCodeLine{197             ),}
\DoxyCodeLine{198             name=\textcolor{stringliteral}{'Atoms'}}
\DoxyCodeLine{199         )}
\DoxyCodeLine{200     )}
\DoxyCodeLine{201     }
\DoxyCodeLine{202     \textcolor{comment}{\#fig.show()}}
\DoxyCodeLine{203     }
\DoxyCodeLine{204     }
\DoxyCodeLine{205     \textcolor{comment}{\#fig.write\_image("{}energies.png"{})}}
\DoxyCodeLine{206     }
\DoxyCodeLine{207     \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{208     }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevisualisation_a665238431e964d48ad871c62f97c0eeb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_ad3e838717595f5a5a4f080cfe6c73c05}\label{namespacevisualisation_ad3e838717595f5a5a4f080cfe6c73c05}} 
\index{visualisation@{visualisation}!process\_main\_results@{process\_main\_results}}
\index{process\_main\_results@{process\_main\_results}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{process\_main\_results()}{process\_main\_results()}}
{\footnotesize\ttfamily def visualisation.\+process\+\_\+main\+\_\+results (\begin{DoxyParamCaption}\item[{}]{filename = {\ttfamily \textquotesingle{}results.nc\textquotesingle{}},  }\item[{}]{verbose = {\ttfamily True} }\end{DoxyParamCaption})}



Processes the results output as a result of the parameter search from the Net\+CDF4 file. 

\begin{DoxyVerb}Parameters:
    filename: Defaults to 'results.nc'. The file which contains the data output by the parameter search
\end{DoxyVerb}
 

Definition at line 209 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{209 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_ad3e838717595f5a5a4f080cfe6c73c05}{process\_main\_results}}(filename='results.nc', verbose = True):}
\DoxyCodeLine{210     \textcolor{stringliteral}{"{}"{}"{}Processes the results output as a result of the parameter search from the NetCDF4 file}}
\DoxyCodeLine{211 \textcolor{stringliteral}{}}
\DoxyCodeLine{212 \textcolor{stringliteral}{    Parameters:}}
\DoxyCodeLine{213 \textcolor{stringliteral}{        filename: Defaults to 'results.nc'. The file which contains the data output by the parameter search}}
\DoxyCodeLine{214 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{215 }
\DoxyCodeLine{216 }
\DoxyCodeLine{217 }
\DoxyCodeLine{218     rootgrp = \mbox{\hyperlink{namespacevisualisation_a5c80a150bab5e4176013e33b5fec9816}{load\_results}}(filename)}
\DoxyCodeLine{219 }
\DoxyCodeLine{220     global\_attr = \mbox{\hyperlink{namespacevisualisation_a6a2287f360d1e76cd639bd70f229fe6c}{load\_global\_attr}}(rootgrp, verbose)}
\DoxyCodeLine{221 }
\DoxyCodeLine{222     variables = \mbox{\hyperlink{namespacevisualisation_a72a74f351b2aeb7073d75d659c0a37fe}{load\_variables}}(rootgrp, verbose)}
\DoxyCodeLine{223 }
\DoxyCodeLine{224 }
\DoxyCodeLine{225     \textcolor{keywordflow}{if} (global\_attr[\textcolor{stringliteral}{'system'}] == \textcolor{stringliteral}{'QHO'}):}
\DoxyCodeLine{226         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{227         \textcolor{comment}{\#data1 = QHO\_eng\_plot(rootgrp)}}
\DoxyCodeLine{228         \textcolor{comment}{\#fig = QHO\_prob\_plot(rootgrp)}}
\DoxyCodeLine{229     elif(global\_attr[\textcolor{stringliteral}{'system'}] == \textcolor{stringliteral}{'H2plus'}):}
\DoxyCodeLine{230         main\_fig = \mbox{\hyperlink{namespacevisualisation_a15512bdc0a35b851921f281f89e6460f}{H2\_eng\_plot}}(variables)}
\DoxyCodeLine{231         }
\DoxyCodeLine{232 }
\DoxyCodeLine{233     elif(global\_attr[\textcolor{stringliteral}{'system'}] == \textcolor{stringliteral}{'H2'}):}
\DoxyCodeLine{234         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{235 }
\DoxyCodeLine{236     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{237             \textcolor{keywordflow}{raise} Exception(\textcolor{stringliteral}{"{}Invalid system input into visualisation"{}})}
\DoxyCodeLine{238             }
\DoxyCodeLine{239     \textcolor{keywordflow}{return} global\_attr,variables,main\_fig}
\DoxyCodeLine{240 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevisualisation_ad3e838717595f5a5a4f080cfe6c73c05_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_aee22ef0385ad565e03cc2c8aae5c10c2}\label{namespacevisualisation_aee22ef0385ad565e03cc2c8aae5c10c2}} 
\index{visualisation@{visualisation}!orb\_1s@{orb\_1s}}
\index{orb\_1s@{orb\_1s}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{orb\_1s()}{orb\_1s()}}
{\footnotesize\ttfamily def visualisation.\+orb\+\_\+1s (\begin{DoxyParamCaption}\item[{}]{X,  }\item[{}]{Y,  }\item[{}]{Z,  }\item[{}]{R\+\_\+a }\end{DoxyParamCaption})}



functions plotting the wavefunction ab initio \#\#\#\#\#\#\# 



Definition at line 243 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{243 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_aee22ef0385ad565e03cc2c8aae5c10c2}{orb\_1s}}(X,Y,Z, R\_a): \textcolor{comment}{\#R\_a is the location of the atoms}}
\DoxyCodeLine{244     x\_a,y\_a,z\_a = R\_a}
\DoxyCodeLine{245     a0 = 1}
\DoxyCodeLine{246     orbital = 1/(((a0**1.5)*(np.sqrt(np.pi)))*\(\backslash\)}
\DoxyCodeLine{247                  np.exp(np.sqrt((X-\/x\_a)**2+(Y-\/y\_a)**2+(Z-\/z\_a)**2)/a0))}
\DoxyCodeLine{248     \textcolor{keywordflow}{return} orbital}
\DoxyCodeLine{249 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevisualisation_aee22ef0385ad565e03cc2c8aae5c10c2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_a622c163e8aa656ccc9b1745a3bfe545b}\label{namespacevisualisation_a622c163e8aa656ccc9b1745a3bfe545b}} 
\index{visualisation@{visualisation}!orb\_2s@{orb\_2s}}
\index{orb\_2s@{orb\_2s}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{orb\_2s()}{orb\_2s()}}
{\footnotesize\ttfamily def visualisation.\+orb\+\_\+2s (\begin{DoxyParamCaption}\item[{}]{r,  }\item[{}]{R\+\_\+a }\end{DoxyParamCaption})}



Definition at line 250 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{250 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a622c163e8aa656ccc9b1745a3bfe545b}{orb\_2s}}(r,R\_a):}
\DoxyCodeLine{251     a0 = 1}
\DoxyCodeLine{252     orbital = (2-\/np.linalg.norm(r-\/R\_a)()/a0)/((4*(a0**1.5)*(np.sqrt(2*np.pi)))*np.exp(np.linalg.norm(r-\/R\_a)/(2*a0)))}
\DoxyCodeLine{253     \textcolor{keywordflow}{return} orbital}
\DoxyCodeLine{254 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacevisualisation_aa711c68ba9bc3ff10d2589890a785ed2}\label{namespacevisualisation_aa711c68ba9bc3ff10d2589890a785ed2}} 
\index{visualisation@{visualisation}!polar\_to\_cart@{polar\_to\_cart}}
\index{polar\_to\_cart@{polar\_to\_cart}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{polar\_to\_cart()}{polar\_to\_cart()}}
{\footnotesize\ttfamily def visualisation.\+polar\+\_\+to\+\_\+cart (\begin{DoxyParamCaption}\item[{}]{r,  }\item[{}]{theta,  }\item[{}]{phi }\end{DoxyParamCaption})}



Definition at line 255 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{255 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_aa711c68ba9bc3ff10d2589890a785ed2}{polar\_to\_cart}}(r,theta, phi):}
\DoxyCodeLine{256     X = r*np.sin(phi)*np.cos(theta)}
\DoxyCodeLine{257     Y = r*np.sin(phi)*np.sin(theta)}
\DoxyCodeLine{258     Z = r*np.cos(phi)}
\DoxyCodeLine{259 }
\DoxyCodeLine{260     \textcolor{keywordflow}{return} X,Y,Z}
\DoxyCodeLine{261     }
\DoxyCodeLine{262 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacevisualisation_a8518056c83c83befbb585f14d97497d8}\label{namespacevisualisation_a8518056c83c83befbb585f14d97497d8}} 
\index{visualisation@{visualisation}!lcao\_wfn@{lcao\_wfn}}
\index{lcao\_wfn@{lcao\_wfn}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{lcao\_wfn()}{lcao\_wfn()}}
{\footnotesize\ttfamily def visualisation.\+lcao\+\_\+wfn (\begin{DoxyParamCaption}\item[{}]{X,  }\item[{}]{Y,  }\item[{}]{Z,  }\item[{}]{R1,  }\item[{}]{R2,  }\item[{}]{pqn = {\ttfamily 1} }\end{DoxyParamCaption})}



Definition at line 263 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{263 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a8518056c83c83befbb585f14d97497d8}{lcao\_wfn}}(X,Y,Z, R1, R2, pqn = 1):}
\DoxyCodeLine{264     \textcolor{comment}{\#for the linear combination of wavefunctions, to be added to and to be remove}}
\DoxyCodeLine{265     \textcolor{keywordflow}{if} pqn == 1:}
\DoxyCodeLine{266          wfn = np.sqrt(2)*\mbox{\hyperlink{namespacevisualisation_aee22ef0385ad565e03cc2c8aae5c10c2}{orb\_1s}}(X,Y,Z,R1) + np.sqrt(2)*\mbox{\hyperlink{namespacevisualisation_aee22ef0385ad565e03cc2c8aae5c10c2}{orb\_1s}}(X,Y,Z,R2)}
\DoxyCodeLine{267     \textcolor{keywordflow}{if} pqn == 2:}
\DoxyCodeLine{268         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{269 }
\DoxyCodeLine{270     \textcolor{keywordflow}{return} wfn}
\DoxyCodeLine{271 }
\DoxyCodeLine{272 }
\DoxyCodeLine{273 }
\DoxyCodeLine{274 }
\DoxyCodeLine{275 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{namespacevisualisation_a8518056c83c83befbb585f14d97497d8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=337pt]{namespacevisualisation_a8518056c83c83befbb585f14d97497d8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_a9756d369d218ccf60a488ec02542eac6}\label{namespacevisualisation_a9756d369d218ccf60a488ec02542eac6}} 
\index{visualisation@{visualisation}!plot\_3D@{plot\_3D}}
\index{plot\_3D@{plot\_3D}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{plot\_3D()}{plot\_3D()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily def visualisation.\+plot\+\_\+3D (\begin{DoxyParamCaption}\item[{}]{X,  }\item[{}]{Y,  }\item[{}]{Z,  }\item[{}]{wfn,  }\item[{}]{R1,  }\item[{}]{R2 }\end{DoxyParamCaption})}



Definition at line 276 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{276 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a58db1c83502abb038c648f3bb1076432}{plot\_3D}}(X,Y,Z,wfn,R1,R2):}
\DoxyCodeLine{277       }
\DoxyCodeLine{278     fig = go.Figure()}
\DoxyCodeLine{279     \textcolor{comment}{\#for plotting wavefunctions, to be removed}}
\DoxyCodeLine{280     fig.add\_trace(go.Volume(}
\DoxyCodeLine{281     x=X.flatten(),}
\DoxyCodeLine{282     y=Y.flatten(),}
\DoxyCodeLine{283     z=Z.flatten(),}
\DoxyCodeLine{284     value=wfn.flatten(),}
\DoxyCodeLine{285     opacity=0.1, }
\DoxyCodeLine{286     surface\_count=21, }
\DoxyCodeLine{287     ))}
\DoxyCodeLine{288     }
\DoxyCodeLine{289     fig.add\_trace(go.Scatter3d(}
\DoxyCodeLine{290         mode=\textcolor{stringliteral}{'markers'},}
\DoxyCodeLine{291         x=[R1[0],R2[0]],}
\DoxyCodeLine{292         y=[R1[1],R2[1]],}
\DoxyCodeLine{293         z=[R1[2],R2[2]],}
\DoxyCodeLine{294         opacity=1.0,}
\DoxyCodeLine{295         marker=dict(}
\DoxyCodeLine{296             color=\textcolor{stringliteral}{'\#AAAAAA'},}
\DoxyCodeLine{297             size=10,}
\DoxyCodeLine{298             line=dict(}
\DoxyCodeLine{299                 color=\textcolor{stringliteral}{'Black'},}
\DoxyCodeLine{300                 width=2}
\DoxyCodeLine{301                 )}
\DoxyCodeLine{302             ),}
\DoxyCodeLine{303             name=\textcolor{stringliteral}{'Atoms'}}
\DoxyCodeLine{304         )}
\DoxyCodeLine{305     )}
\DoxyCodeLine{306     \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{307 }
\DoxyCodeLine{308 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{namespacevisualisation_a9756d369d218ccf60a488ec02542eac6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_a73a6709541da1825e8af407b3558240e}\label{namespacevisualisation_a73a6709541da1825e8af407b3558240e}} 
\index{visualisation@{visualisation}!example\_H1s\_wfn@{example\_H1s\_wfn}}
\index{example\_H1s\_wfn@{example\_H1s\_wfn}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{example\_H1s\_wfn()}{example\_H1s\_wfn()}}
{\footnotesize\ttfamily def visualisation.\+example\+\_\+\+H1s\+\_\+wfn (\begin{DoxyParamCaption}\item[{}]{bond\+\_\+length = {\ttfamily 2.0} }\end{DoxyParamCaption})}



Definition at line 309 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{309 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a73a6709541da1825e8af407b3558240e}{example\_H1s\_wfn}}(bond\_length=2.0):}
\DoxyCodeLine{310     }
\DoxyCodeLine{311 }
\DoxyCodeLine{312     x, y, z = np.mgrid[-\/3:3:40j, -\/3:3:40j, -\/3:3:40j]}
\DoxyCodeLine{313 }
\DoxyCodeLine{314     R\_1 = (-\/0.5*bond\_length, 0,0)}
\DoxyCodeLine{315     R\_2 = (0.5*bond\_length, 0,0)}
\DoxyCodeLine{316     }
\DoxyCodeLine{317     wfn = \mbox{\hyperlink{namespacevisualisation_a8518056c83c83befbb585f14d97497d8}{lcao\_wfn}}(x,y,z,R\_1,R\_2)}
\DoxyCodeLine{318     density = wfn**2}
\DoxyCodeLine{319     }
\DoxyCodeLine{320     density\_plot = \mbox{\hyperlink{namespacevisualisation_a58db1c83502abb038c648f3bb1076432}{plot\_3D}}(x,y,z,density,R\_1,R\_2)}
\DoxyCodeLine{321     \textcolor{keywordflow}{return} density\_plot}
\DoxyCodeLine{322 }
\DoxyCodeLine{323     }
\DoxyCodeLine{324 }
\DoxyCodeLine{325 }
\DoxyCodeLine{326 }
\DoxyCodeLine{327     \textcolor{keywordflow}{return} wfn}
\DoxyCodeLine{328 }
\DoxyCodeLine{329 }
\DoxyCodeLine{330 }
\DoxyCodeLine{331 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacevisualisation_a73a6709541da1825e8af407b3558240e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_a58db1c83502abb038c648f3bb1076432}\label{namespacevisualisation_a58db1c83502abb038c648f3bb1076432}} 
\index{visualisation@{visualisation}!plot\_3D@{plot\_3D}}
\index{plot\_3D@{plot\_3D}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{plot\_3D()}{plot\_3D()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily def visualisation.\+plot\+\_\+3D (\begin{DoxyParamCaption}\item[{}]{X,  }\item[{}]{Y,  }\item[{}]{Z,  }\item[{}]{wfn }\end{DoxyParamCaption})}



Definition at line 332 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{332 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a58db1c83502abb038c648f3bb1076432}{plot\_3D}}(X,Y,Z,wfn):}
\DoxyCodeLine{333     \textcolor{comment}{\#for plotting wavefunctions, to be removed}}
\DoxyCodeLine{334     fig = go.Figure(data=go.Volume(}
\DoxyCodeLine{335     x=X.flatten(),}
\DoxyCodeLine{336     y=Y.flatten(),}
\DoxyCodeLine{337     z=Z.flatten(),}
\DoxyCodeLine{338     value=wfn.flatten(),}
\DoxyCodeLine{339     isomin=0.0,}
\DoxyCodeLine{340     isomax=1.2,}
\DoxyCodeLine{341     opacity=0.1, }
\DoxyCodeLine{342     surface\_count=21, }
\DoxyCodeLine{343     ))}
\DoxyCodeLine{344     \textcolor{comment}{\#fig.save("{}wavefunction.png"{})}}
\DoxyCodeLine{345     \textcolor{keywordflow}{return} fig}
\DoxyCodeLine{346 }
\DoxyCodeLine{347     }
\DoxyCodeLine{348 }
\DoxyCodeLine{349 \textcolor{comment}{\#-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{350 \textcolor{comment}{\# Burn / Thin FUNCTION DEFINITIONS -\/}}
\DoxyCodeLine{351 \textcolor{comment}{\#-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{352 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=328pt]{namespacevisualisation_a58db1c83502abb038c648f3bb1076432_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacevisualisation_ac345463eb554d7c90613773996e74748}\label{namespacevisualisation_ac345463eb554d7c90613773996e74748}} 
\index{visualisation@{visualisation}!view\_original\_trace@{view\_original\_trace}}
\index{view\_original\_trace@{view\_original\_trace}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{view\_original\_trace()}{view\_original\_trace()}}
{\footnotesize\ttfamily def visualisation.\+view\+\_\+original\+\_\+trace (\begin{DoxyParamCaption}\item[{}]{filename }\end{DoxyParamCaption})}



Plots the original trace(s) of an MCMC run. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em filename} & Filename of MCMC equilibration run \\
\hline
\end{DoxyParams}


Definition at line 357 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{357 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_ac345463eb554d7c90613773996e74748}{view\_original\_trace}}(filename):}
\DoxyCodeLine{358     rootgrp = Dataset(filename, \textcolor{stringliteral}{"{}r"{}}, format = \textcolor{stringliteral}{"{}NETCDF4"{}})}
\DoxyCodeLine{359     chain = np.array(rootgrp[\textcolor{stringliteral}{'positions'}][:])}
\DoxyCodeLine{360     \textcolor{keywordflow}{if} len(chain.shape) == 1:}
\DoxyCodeLine{361         plt.plot(range(len(chain)), chain, linewidth=1.0)}
\DoxyCodeLine{362         plt.xlabel(\textcolor{stringliteral}{"{}Position in chain"{}})}
\DoxyCodeLine{363         plt.ylabel(\textcolor{stringliteral}{"{}Chain value"{}})}
\DoxyCodeLine{364         plt.title(\textcolor{stringliteral}{"{}Original Chain"{}})}
\DoxyCodeLine{365         plt.show()}
\DoxyCodeLine{366         }
\DoxyCodeLine{367     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{368         chainx = chain[:,0]}
\DoxyCodeLine{369         chainy = chain[:,1]}
\DoxyCodeLine{370         chainz = chain[:,2]}
\DoxyCodeLine{371         }
\DoxyCodeLine{372         fig, (ax1,ax2,ax3) = plt.subplots(3,1)}
\DoxyCodeLine{373         ax1.plot(range(len(chainx)), chainx, linewidth=1.0)}
\DoxyCodeLine{374         ax2.plot(range(len(chainy)), chainy, linewidth=1.0)}
\DoxyCodeLine{375         ax3.plot(range(len(chainz)), chainz, linewidth=1.0)}
\DoxyCodeLine{376     }
\DoxyCodeLine{377     \textcolor{keywordflow}{return}}
\DoxyCodeLine{378 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacevisualisation_a26c9ab9270b803a8d15c40d621769c46}\label{namespacevisualisation_a26c9ab9270b803a8d15c40d621769c46}} 
\index{visualisation@{visualisation}!get\_autocorrelation\_time@{get\_autocorrelation\_time}}
\index{get\_autocorrelation\_time@{get\_autocorrelation\_time}!visualisation@{visualisation}}
\doxysubsubsection{\texorpdfstring{get\_autocorrelation\_time()}{get\_autocorrelation\_time()}}
{\footnotesize\ttfamily def visualisation.\+get\+\_\+autocorrelation\+\_\+time (\begin{DoxyParamCaption}\item[{}]{filename,  }\item[{}]{burn,  }\item[{}]{tuning,  }\item[{}]{plotting = {\ttfamily True} }\end{DoxyParamCaption})}



Function which suggests a thinning parameter for a MCMC chain. 

Takes as input a burning parameter and a tuning parameter which controls how aggressively you tune out autocorrelation in the trace, and prints a suggested thinning parameter (if one was found). Intention is to use interactively, to illustrate procedure for burning and thinning, as default values are provided. Plots generated are the autocorrelation as a function of lag time, and the burnt and thinned trace / chain.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em filename} & Filename of MCMC equilibration run \\
\hline
\mbox{\texttt{ in}}  & {\em burn} & Number of samples from chain to burn / discard \\
\hline
\mbox{\texttt{ in}}  & {\em tuning} & Parameter which controls aggression of thinning \\
\hline
\mbox{\texttt{ in}}  & {\em plotting} & Controls whether to display plots \\
\hline
\end{DoxyParams}


Definition at line 395 of file visualisation.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{395 \textcolor{keyword}{def }\mbox{\hyperlink{namespacevisualisation_a26c9ab9270b803a8d15c40d621769c46}{get\_autocorrelation\_time}}(filename, burn, tuning, plotting=True):}
\DoxyCodeLine{396     rootgrp = Dataset(filename, \textcolor{stringliteral}{"{}r"{}}, format = \textcolor{stringliteral}{"{}NETCDF4"{}})}
\DoxyCodeLine{397     chain = np.array(rootgrp[\textcolor{stringliteral}{'positions'}][:])}
\DoxyCodeLine{398     \textcolor{keywordflow}{if} len(chain.shape) == 1:}
\DoxyCodeLine{399         acp = sps.fftconvolve(chain,chain[::-\/1],mode=\textcolor{stringliteral}{'full'})}
\DoxyCodeLine{400         acp = acp[int(acp.size / 2):]}
\DoxyCodeLine{401         acp = acp / max(acp)}
\DoxyCodeLine{402         acp = acp[burn:]}
\DoxyCodeLine{403 }
\DoxyCodeLine{404         thin = np.argmax(abs(acp) < tuning)}
\DoxyCodeLine{405         \textcolor{keywordflow}{if} thin == 0:}
\DoxyCodeLine{406             \textcolor{keywordflow}{if} acp[thin] < tuning:}
\DoxyCodeLine{407                 thin = 1}
\DoxyCodeLine{408             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{409                 print(\textcolor{stringliteral}{"{}No thinning value found -\/ tuning may be too aggressive. Defaulting to no thinning, thin=1."{}})}
\DoxyCodeLine{410                 print()}
\DoxyCodeLine{411                 thin = 1}
\DoxyCodeLine{412 }
\DoxyCodeLine{413         print(\textcolor{stringliteral}{"{}burning parameter = "{}}, burn)}
\DoxyCodeLine{414         print(\textcolor{stringliteral}{"{}proposed thinning parameter = "{}}, thin)}
\DoxyCodeLine{415 }
\DoxyCodeLine{416         chain\_new = chain[burn::thin]}
\DoxyCodeLine{417         print(\textcolor{stringliteral}{"{}length of new chain = "{}}, len(chain\_new))}
\DoxyCodeLine{418 }
\DoxyCodeLine{419         \textcolor{keywordflow}{if} plotting==\textcolor{keyword}{True}:}
\DoxyCodeLine{420             plt.plot(range(len(acp)), acp, linewidth=1.0)}
\DoxyCodeLine{421             plt.xlabel(\textcolor{stringliteral}{"{}Position in chain / Lag time"{}})}
\DoxyCodeLine{422             plt.ylabel(\textcolor{stringliteral}{"{}ACF"{}})}
\DoxyCodeLine{423             plt.title(\textcolor{stringliteral}{"{}Autocorrelation function vs lag time"{}})}
\DoxyCodeLine{424             plt.show()}
\DoxyCodeLine{425 }
\DoxyCodeLine{426             plt.plot(range(len(chain\_new)), chain\_new, linewidth=1.0)}
\DoxyCodeLine{427             plt.xlabel(\textcolor{stringliteral}{"{}Position in chain"{}})}
\DoxyCodeLine{428             plt.ylabel(\textcolor{stringliteral}{"{}Chain value"{}})}
\DoxyCodeLine{429             plt.title(\textcolor{stringliteral}{"{}New Chain"{}})}
\DoxyCodeLine{430             plt.show()}
\DoxyCodeLine{431             }
\DoxyCodeLine{432         \textcolor{keywordflow}{return} burn, thin}
\DoxyCodeLine{433             }
\DoxyCodeLine{434     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{435         chainx = chain[:,0]}
\DoxyCodeLine{436         chainy = chain[:,1]}
\DoxyCodeLine{437         chainz = chain[:,2]}
\DoxyCodeLine{438         }
\DoxyCodeLine{439         threed\_thin = []}
\DoxyCodeLine{440         chain\_lengths = []}
\DoxyCodeLine{441         }
\DoxyCodeLine{442         \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} [chainx,chainy,chainz]:}
\DoxyCodeLine{443             acp = sps.fftconvolve(c,c[::-\/1],mode=\textcolor{stringliteral}{'full'})}
\DoxyCodeLine{444             acp = acp[int(acp.size / 2):]}
\DoxyCodeLine{445             acp = acp / max(acp)}
\DoxyCodeLine{446             acp = acp[burn:]}
\DoxyCodeLine{447 }
\DoxyCodeLine{448             thin = np.argmax(abs(acp) < tuning)}
\DoxyCodeLine{449             \textcolor{keywordflow}{if} thin == 0:}
\DoxyCodeLine{450                 \textcolor{keywordflow}{if} acp[thin] < tuning:}
\DoxyCodeLine{451                     thin = 1}
\DoxyCodeLine{452                 \textcolor{keywordflow}{else}:}
\DoxyCodeLine{453                     print(\textcolor{stringliteral}{"{}No thinning value found -\/ tuning may be too aggressive. Defaulting to no thinning, thin=1."{}})}
\DoxyCodeLine{454                     print()}
\DoxyCodeLine{455                     thin = 1}
\DoxyCodeLine{456                     }
\DoxyCodeLine{457             threed\_thin.append(thin)}
\DoxyCodeLine{458 }
\DoxyCodeLine{459             chain\_new = c[burn::thin]}
\DoxyCodeLine{460             chain\_lengths.append(len(chain\_new))}
\DoxyCodeLine{461 }
\DoxyCodeLine{462             \textcolor{keywordflow}{if} plotting==\textcolor{keyword}{True}:}
\DoxyCodeLine{463                 plt.plot(range(len(acp)), acp, linewidth=1.0)}
\DoxyCodeLine{464                 plt.xlabel(\textcolor{stringliteral}{"{}Position in chain / Lag time"{}})}
\DoxyCodeLine{465                 plt.ylabel(\textcolor{stringliteral}{"{}ACF"{}})}
\DoxyCodeLine{466                 plt.title(\textcolor{stringliteral}{"{}Autocorrelation function vs lag time"{}})}
\DoxyCodeLine{467                 plt.show()}
\DoxyCodeLine{468 }
\DoxyCodeLine{469 \textcolor{comment}{\#                 plt.plot(range(len(chain\_new)), chain\_new, linewidth=1.0)}}
\DoxyCodeLine{470 \textcolor{comment}{\#                 plt.xlabel("{}Position in chain"{})}}
\DoxyCodeLine{471 \textcolor{comment}{\#                 plt.ylabel("{}Chain value"{})}}
\DoxyCodeLine{472 \textcolor{comment}{\#                 plt.title("{}New Chain"{})}}
\DoxyCodeLine{473 \textcolor{comment}{\#                 plt.show()}}
\DoxyCodeLine{474         print(\textcolor{stringliteral}{"{}burning parameter = "{}}, burn)}
\DoxyCodeLine{475         print(\textcolor{stringliteral}{"{}proposed thinning parameters from the 3 chains: "{}}, threed\_thin)}
\DoxyCodeLine{476         print(\textcolor{stringliteral}{"{}chain lengths from proposed thins"{}}, chain\_lengths)}
\DoxyCodeLine{477 }
\DoxyCodeLine{478         \textcolor{keywordflow}{return} burn, threed\_thin}
\DoxyCodeLine{479 }
\DoxyCodeLine{480 }
\DoxyCodeLine{481 }
\DoxyCodeLine{482 }
\DoxyCodeLine{483 }
\DoxyCodeLine{484 }

\end{DoxyCode}
