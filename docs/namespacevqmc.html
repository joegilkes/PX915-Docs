<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Group_A_Codes: vqmc Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Group_A_Codes
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacevqmc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">vqmc Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains a random number generator, a sub-routine that draws from a normal distribution and a VQMC solver for the three different problems.  
<a href="namespacevqmc.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a6b89c5b7a64a3e438695787b90a62359"><td class="memItemLeft" align="right" valign="top">real(real64) function, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#a6b89c5b7a64a3e438695787b90a62359">linspace</a> (start, end, num)</td></tr>
<tr class="separator:a6b89c5b7a64a3e438695787b90a62359"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed182179994b5465f5466b4d909a764e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#aed182179994b5465f5466b4d909a764e">init_ran1</a> ()</td></tr>
<tr class="separator:aed182179994b5465f5466b4d909a764e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01b80444204a0cd0b5cddde82cbc7651"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#a01b80444204a0cd0b5cddde82cbc7651">ran1</a> (sample, dseed)</td></tr>
<tr class="separator:a01b80444204a0cd0b5cddde82cbc7651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62ec9b662e5d9b46ec37d52ff93cb335"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#a62ec9b662e5d9b46ec37d52ff93cb335">random_normal</a> (dim, x)</td></tr>
<tr class="separator:a62ec9b662e5d9b46ec37d52ff93cb335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af750525012cfc872fca742b9ef803120"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#af750525012cfc872fca742b9ef803120">vqmc_qho</a> (sigma, N, burn, thin, alpha_const, X, accept_rate, energy_chain)</td></tr>
<tr class="memdesc:af750525012cfc872fca742b9ef803120"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs VQMC for QHO.  <a href="namespacevqmc.html#af750525012cfc872fca742b9ef803120">More...</a><br /></td></tr>
<tr class="separator:af750525012cfc872fca742b9ef803120"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a156887f8e878c4d01de5d2d4fa606a18"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#a156887f8e878c4d01de5d2d4fa606a18">vqmc_h_2_plus</a> (sigma, N, burn, thin, c_const, R_a, R_b, X, accept_rate, energy_chain)</td></tr>
<tr class="memdesc:a156887f8e878c4d01de5d2d4fa606a18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs VQMC for H_2_plus <br  />
  <a href="namespacevqmc.html#a156887f8e878c4d01de5d2d4fa606a18">More...</a><br /></td></tr>
<tr class="separator:a156887f8e878c4d01de5d2d4fa606a18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdead1c964c264b80a7698da1bc3e792"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#afdead1c964c264b80a7698da1bc3e792">vqmc_h_2</a> (sigma, N, burn, thin, c_const, R_a, R_b, X_1, X_2, accept_rate, energy_chain)</td></tr>
<tr class="memdesc:afdead1c964c264b80a7698da1bc3e792"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs VQMC for H_2 <br  />
  <a href="namespacevqmc.html#afdead1c964c264b80a7698da1bc3e792">More...</a><br /></td></tr>
<tr class="separator:afdead1c964c264b80a7698da1bc3e792"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4acb6b64bbac5c4684654d00393f7f24"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#a4acb6b64bbac5c4684654d00393f7f24">ntab</a> = 32</td></tr>
<tr class="separator:a4acb6b64bbac5c4684654d00393f7f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86db46440794b9ef7cfd9fbf1fd69930"><td class="memItemLeft" align="right" valign="top">integer(int64), dimension(<a class="el" href="namespacevqmc.html#a4acb6b64bbac5c4684654d00393f7f24">ntab</a>), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#a86db46440794b9ef7cfd9fbf1fd69930">iv</a> = 0</td></tr>
<tr class="separator:a86db46440794b9ef7cfd9fbf1fd69930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1608372d703310a49afc4243ccf27368"><td class="memItemLeft" align="right" valign="top">integer(int64), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#a1608372d703310a49afc4243ccf27368">iy</a> = 0</td></tr>
<tr class="separator:a1608372d703310a49afc4243ccf27368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a986f071589794992c4bc31de25c63976"><td class="memItemLeft" align="right" valign="top">integer(int64), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevqmc.html#a986f071589794992c4bc31de25c63976">seed</a></td></tr>
<tr class="separator:a986f071589794992c4bc31de25c63976"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains a random number generator, a sub-routine that draws from a normal distribution and a VQMC solver for the three different problems. </p>
<p>Module contains the VQMC solver for quantum harmonic oscillator (QHO), hydrogen ion (H_2_plus) and hydrogen molecule (H_2). It also has the sub_routine random normal which generates a sample from a normal distribution using the Box-Muller transfrom, which is needed for the Metropolis algorythm used in VQMC. The VQMC solvers uses the module solvers to obtain the transitional probabilities need for the Metropolis algorythm and to calculate the local energies given the position of the random walker. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a6b89c5b7a64a3e438695787b90a62359"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b89c5b7a64a3e438695787b90a62359">&#9670;&nbsp;</a></span>linspace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function, dimension(:), allocatable vqmc::linspace </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00045">45</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: start, end, num</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: ls_array</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordtype">integer</span> :: i, inum</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">        real</span>(real64) :: step</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="comment">! Handle real value for num</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        inum = int(num)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="comment">! Generate array</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keyword">allocate</span>(ls_array(inum))</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="comment">! Find step size</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        step = (<span class="keyword">end </span>- start) / real(inum-1, kind=real64)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">! Fill array</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">do</span> i = 1, inum</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            ls_array(i) = start + (i-1)*step</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacevqmc_a6b89c5b7a64a3e438695787b90a62359_icgraph.png" border="0" usemap="#anamespacevqmc_a6b89c5b7a64a3e438695787b90a62359_icgraph" alt=""/></div>
<map name="anamespacevqmc_a6b89c5b7a64a3e438695787b90a62359_icgraph" id="anamespacevqmc_a6b89c5b7a64a3e438695787b90a62359_icgraph">
<area shape="rect" title=" " alt="" coords="104,5,212,32"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="aed182179994b5465f5466b4d909a764e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed182179994b5465f5466b4d909a764e">&#9670;&nbsp;</a></span>init_ran1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vqmc::init_ran1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00072">72</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordtype">integer</span> :: fu, rc, l_seed</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordtype">character(len=30)</span> :: c_seed</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keyword">open</span> (access=<span class="stringliteral">&#39;stream&#39;</span>, action=<span class="stringliteral">&#39;read&#39;</span>, file=<span class="stringliteral">&#39;/dev/urandom&#39;</span>, &amp;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        form=<span class="stringliteral">&#39;unformatted&#39;</span>, iostat=rc, newunit=fu)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> (rc == 0) <span class="keyword">read</span> (fu) seed</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">close</span> (fu)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keyword">write</span>(c_seed, <span class="stringliteral">&quot;(I30)&quot;</span>) seed</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        l_seed = len(c_seed)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        c_seed = adjustl(c_seed)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        c_seed = c_seed(7:l_seed)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keyword">read</span>(c_seed, *) seed</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">if</span> (seed .gt. 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            seed = -seed</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span> (verbose) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keyword">write</span>(logid, <span class="stringliteral">&quot;(&#39;Initial seed from /dev/urandom: &#39;, I20)&quot;</span>) seed</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keyword">write</span>(logid, <span class="stringliteral">&quot;(&#39;&#39;)&quot;</span>)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacevqmc_aed182179994b5465f5466b4d909a764e_icgraph.png" border="0" usemap="#anamespacevqmc_aed182179994b5465f5466b4d909a764e_icgraph" alt=""/></div>
<map name="anamespacevqmc_aed182179994b5465f5466b4d909a764e_icgraph" id="anamespacevqmc_aed182179994b5465f5466b4d909a764e_icgraph">
<area shape="rect" title=" " alt="" coords="104,5,213,32"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a01b80444204a0cd0b5cddde82cbc7651"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01b80444204a0cd0b5cddde82cbc7651">&#9670;&nbsp;</a></span>ran1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vqmc::ran1 </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(out)&#160;</td>
          <td class="paramname"><em>sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int64), intent(inout)&#160;</td>
          <td class="paramname"><em>dseed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00106">106</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordtype">integer(int64)</span>, <span class="keywordtype">intent(inout)</span> :: dseed</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span> :: sample</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">! Constants defined in Press et al</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordtype">integer(int64)</span>, <span class="keywordtype">parameter</span> :: ia = 16807, im = 2147483647, iq = 1<span class="comment">27773</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span>        <span class="keywordtype">integer(int64)</span>, <span class="keywordtype">parameter</span> :: ir = 2836, &amp;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                     ndiv = 1 + floor((real(im, kind=real64<span class="comment">)-1.0)/ntab)</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span><span class="keywordtype">        real</span>(real64), <span class="keywordtype">parameter</span> :: am = 1.0/real(im, kind=real64), eps =<span class="comment"> 1.2e-7, &amp;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span>                                   rnmx = 1.0-eps</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">! Loop counters</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordtype">integer(int64)</span> :: j, k</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="comment">! The following is transcribed directly from Press et al</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">if</span> (dseed&lt;=0 .or. iy==0) <span class="keywordflow">then</span> <span class="comment">! initialization</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                      <span class="comment">! NB this may need to be modified to allow for restarting as iy will be 0</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            dseed = max(-dseed,1)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">do</span> j = ntab+8, 1, -1</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                k = floor(real(dseed, kind=real64)/real(iq, kind=real64)<span class="comment">)</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"></span>                dseed = ia * (dseed-k*iq) - ir * k</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="keywordflow">if</span> (dseed &lt; 0) dseed = dseed + im</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keywordflow">if</span> (j &lt;= ntab) iv(j) = dseed</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordflow">            end do</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            iy = iv(1)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        k = floor(real(dseed, kind=real64)/real(iq, kind=real64))</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        dseed = ia * (dseed-k*iq) - ir * k</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">if</span> (dseed &lt; 0) dseed = dseed + im</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        j = 1_int64 + iy / ndiv</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        iy = iv(j)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        iv(j) = dseed</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        sample = min(am*iy, rnmx)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacevqmc_a01b80444204a0cd0b5cddde82cbc7651_icgraph.png" border="0" usemap="#anamespacevqmc_a01b80444204a0cd0b5cddde82cbc7651_icgraph" alt=""/></div>
<map name="anamespacevqmc_a01b80444204a0cd0b5cddde82cbc7651_icgraph" id="anamespacevqmc_a01b80444204a0cd0b5cddde82cbc7651_icgraph">
<area shape="rect" title=" " alt="" coords="672,107,757,133"/>
<area shape="rect" href="namespacevqmc.html#a62ec9b662e5d9b46ec37d52ff93cb335" title=" " alt="" coords="475,157,624,184"/>
<area shape="rect" href="namespacevqmc.html#afdead1c964c264b80a7698da1bc3e792" title="Performs VQMC for H_2" alt="" coords="291,56,411,83"/>
<area shape="rect" href="namespacevqmc.html#a156887f8e878c4d01de5d2d4fa606a18" title="Performs VQMC for H_2_plus" alt="" coords="276,107,427,133"/>
<area shape="rect" href="namespacevqmc.html#af750525012cfc872fca742b9ef803120" title="Performs VQMC for QHO." alt="" coords="291,224,411,251"/>
<area shape="rect" href="namespacetesting.html#adb38a97b7ceaad408410367f1510e997" title="Tests the ran1 function in the vqmc module." alt="" coords="489,5,610,32"/>
<area shape="rect" href="namespacetesting.html#acbf13e7eaa077016d7d1712b58fc5223" title="Tests the random_normal function in the vqmc module." alt="" coords="282,158,421,199"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="104,165,228,192"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="5,195,56,221"/>
</map>
</div>

</div>
</div>
<a id="a62ec9b662e5d9b46ec37d52ff93cb335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62ec9b662e5d9b46ec37d52ff93cb335">&#9670;&nbsp;</a></span>random_normal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vqmc::random_normal </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00150">150</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordtype">implicit none</span> </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: dim</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span> :: x </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordtype">        real</span>(real64) :: u_1, u_2 </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">do</span> i = 1, dim</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="comment">! call random_number(u_1)</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment">! call random_number(u_2)</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keyword">call </span>ran1(u_1, seed)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keyword">call </span>ran1(u_2, seed)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            x(i) = sqrt(-2*log(u_1))*cos(2*pi*u_2)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keywordflow">        end do</span> </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_cgraph.png" border="0" usemap="#anamespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_cgraph" alt=""/></div>
<map name="anamespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_cgraph" id="anamespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,155,32"/>
<area shape="rect" href="namespacevqmc.html#a01b80444204a0cd0b5cddde82cbc7651" title=" " alt="" coords="203,5,288,32"/>
</map>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_icgraph.png" border="0" usemap="#anamespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_icgraph" alt=""/></div>
<map name="anamespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_icgraph" id="anamespacevqmc_a62ec9b662e5d9b46ec37d52ff93cb335_icgraph">
<area shape="rect" title=" " alt="" coords="475,97,624,123"/>
<area shape="rect" href="namespacetesting.html#acbf13e7eaa077016d7d1712b58fc5223" title="Tests the random_normal function in the vqmc module." alt="" coords="282,5,421,47"/>
<area shape="rect" href="namespacevqmc.html#afdead1c964c264b80a7698da1bc3e792" title="Performs VQMC for H_2" alt="" coords="291,71,411,98"/>
<area shape="rect" href="namespacevqmc.html#a156887f8e878c4d01de5d2d4fa606a18" title="Performs VQMC for H_2_plus" alt="" coords="276,122,427,149"/>
<area shape="rect" href="namespacevqmc.html#af750525012cfc872fca742b9ef803120" title="Performs VQMC for QHO." alt="" coords="106,118,226,145"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="104,41,228,67"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="5,93,56,119"/>
</map>
</div>

</div>
</div>
<a id="af750525012cfc872fca742b9ef803120"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af750525012cfc872fca742b9ef803120">&#9670;&nbsp;</a></span>vqmc_qho()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vqmc::vqmc_qho </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>burn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>thin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>alpha_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out)&#160;</td>
          <td class="paramname"><em>accept_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>energy_chain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs VQMC for QHO. </p>
<p>Computes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma</td><td>Step size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>Number of steps to take </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">burn</td><td>Number of sample to discard at the beginning </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thin</td><td>The frequency at which we discard the samples from the MCMC chain after burning <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha_const</td><td>Parameter </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The full MCMC chain for the random walker </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">accept_rate</td><td>The acceptance rate of the MCMC chain </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">energy_chain</td><td>An array with the local energies of the each points in the MCMC chain </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00194">194</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordtype">implicit none</span> </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: sigma, alpha_const</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: N, burn, thin </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;         </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span> :: accept_rate</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: X, energy_chain<span class="comment"> </span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">        </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span><span class="keywordtype">        real</span>(real64) :: log_prob_n                      <span class="comment">! The natural logarithm of the transition proability</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordtype">        real</span>(real64) :: a_prob_trans                    <span class="comment">! Acceptance ratio of the transition probability </span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordtype">        real</span>(real64) :: unif_num                        <span class="comment">! A random sample from the uniform distribution </span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(1)</span> :: x_start           <span class="comment">! The starting point of the MCMC chain </span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(1)</span> :: X_n               <span class="comment">! The proposed step </span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(1)</span> :: sample_normal     <span class="comment">! A sample from the normal distribution </span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordtype">integer</span> :: accept                               <span class="comment">! Number of accepted steps </span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordtype">integer</span> :: i                                    <span class="comment">! Loop variable </span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordtype">character(len=1)</span> :: acceptance                  <span class="comment">! Yes/No signpost for acceptance</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keyword">allocate</span>(x(1:n+1)); x(:) = 0.0_real64</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keyword">allocate</span>(energy_chain(1:n+1)); energy_chain(:) = 0.0_real64</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="comment">! Creates the initial position of the random walker </span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keyword">call </span>random_normal(1, sample_normal)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        x_start = sample_normal</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        x(1) = x_start(1)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">! Calculates the local energy of the initial position</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        energy_chain(1) = qho_energy(alpha_const, x(1))</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="comment">! Start the counter for the number of accepted moves</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        accept = 0 </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">if</span> (verbose) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keyword">write</span>(logid, <span class="stringliteral">&quot;(&#39;Markov chain for alpha = &#39;, F7.4)&quot;</span>) alpha_const</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keyword">write</span>(logid, <span class="stringliteral">&quot;(&#39;Position       Local Energy     Accepted?&#39;)&quot;</span><span class="comment">)</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span>            <span class="keyword">write</span>(logid, <span class="stringliteral">&quot;(F12.8, &#39;   &#39;, F12.8)&quot;</span>) x(1), energy_chain(1)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;       </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment">! Metropolis Algorithm</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">do</span> i = 2, n+1 </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="comment">! Propose the next step</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keyword">call </span>random_normal(1, sample_normal)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            x_n = x(i-1) + sigma * sample_normal</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">! Calculate the transition probability between proposed step and current step</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            log_prob_n = log(qho_prob(alpha_const, x(i-1), x_n(1)))</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="comment">! Calculate the acceptance ratio</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            a_prob_trans = min(1.0_real64, exp(log_prob_n))</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">! Generate sample from uniform distribution </span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="keyword">call </span>ran1(unif_num, seed)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="comment">! Compare the drawn sample from the uniform distribution with the acceptance ratio </span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">if</span> (a_prob_trans &gt;= unif_num) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="comment">! If accepted calculate local energy and add proposed position to the MCMC chain</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                x(i) = x_n(1) </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                accept = accept + 1</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                acceptance = <span class="stringliteral">&#39;Y&#39;</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                energy_chain(i) = qho_energy(alpha_const, x_n(1))</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="comment">! If rejected the proposed step is the current step</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                x(i) = x(i-1)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                acceptance = <span class="stringliteral">&#39;N&#39;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="comment">! The local energy of the proposed step is the same as the current step when rejected</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                energy_chain(i) = energy_chain(i-1)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keywordflow">            end if</span> </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">if</span> (verbose) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="keywordflow">if</span> (mod(i, 1) .eq. 0.0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="keyword">write</span>(logid, <span class="stringliteral">&quot;(F12.8, &#39;   &#39;, F12.8, &#39;     &#39;, A1)&quot;</span>) &amp;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    x(i), energy_chain(i), acceptance</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordflow">        end do</span> </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">! if (verbose) write(logid, &quot;(&#39;&#39;)&quot;)</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keyword">write</span>(*, *) <span class="stringliteral">&#39;[Temp output] variable accept = &#39;</span>, accept</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">if</span> (verbose) <span class="keyword">write</span>(0, <span class="stringliteral">&quot;(&#39;&#39;)&quot;</span>)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">! Calculate the acceptance ratio </span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        accept_rate = accept / n </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacevqmc_af750525012cfc872fca742b9ef803120_cgraph.png" border="0" usemap="#anamespacevqmc_af750525012cfc872fca742b9ef803120_cgraph" alt=""/></div>
<map name="anamespacevqmc_af750525012cfc872fca742b9ef803120_cgraph" id="anamespacevqmc_af750525012cfc872fca742b9ef803120_cgraph">
<area shape="rect" title="Performs VQMC for QHO." alt="" coords="5,5,125,32"/>
<area shape="rect" href="namespacevqmc.html#a01b80444204a0cd0b5cddde82cbc7651" title=" " alt="" coords="371,5,456,32"/>
<area shape="rect" href="namespacevqmc.html#a62ec9b662e5d9b46ec37d52ff93cb335" title=" " alt="" coords="173,31,323,57"/>
</map>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacevqmc_af750525012cfc872fca742b9ef803120_icgraph.png" border="0" usemap="#anamespacevqmc_af750525012cfc872fca742b9ef803120_icgraph" alt=""/></div>
<map name="anamespacevqmc_af750525012cfc872fca742b9ef803120_icgraph" id="anamespacevqmc_af750525012cfc872fca742b9ef803120_icgraph">
<area shape="rect" title="Performs VQMC for QHO." alt="" coords="104,5,224,32"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a156887f8e878c4d01de5d2d4fa606a18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a156887f8e878c4d01de5d2d4fa606a18">&#9670;&nbsp;</a></span>vqmc_h_2_plus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vqmc::vqmc_h_2_plus </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>burn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>thin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:, :), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out)&#160;</td>
          <td class="paramname"><em>accept_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>energy_chain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs VQMC for H_2_plus <br  />
 </p>
<p>Computes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma</td><td>Step size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>Number of steps to take </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">burn</td><td>Number of sample to discard at the beginning </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thin</td><td>The frequency at which we discard the samples from the MCMC chain after burning <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c_const</td><td>Parameter(s) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>The full MCMC chain for the random walker </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">accept_rate</td><td>The acceptance rate of the MCMC chain </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">energy_chain</td><td>An array with the local energis of the each points in the MCMC chain </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00309">309</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordtype">implicit none</span> </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(3)</span> :: R_a, R_b</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: sigma</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: c_const</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: N, burn, thin </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span> :: accept_rate</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:, :)</span>, <span class="keywordtype">allocatable</span> :: X</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: energy_chain</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keywordtype">        real</span>(real64) :: log_prob_n                      <span class="comment">! The natural logarithm of the transition proability</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordtype">        real</span>(real64) :: a_prob_trans                    <span class="comment">! Acceptance ratio of the transitional probability </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordtype">        real</span>(real64) :: unif_num                        <span class="comment">! A random sample from the uniform distribution </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span> :: x_start           <span class="comment">! Starting point of MCMC chain</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span> :: X_n               <span class="comment">! The proposed step </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span> :: sample_normal     <span class="comment">! A sample from the normal distribution </span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordtype">integer</span> :: accept                               <span class="comment">! Number of accepted steps </span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordtype">integer</span> :: i                                    <span class="comment">! Loop variable </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keyword">allocate</span>(x(3, 1:n+1)) </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keyword">allocate</span>(energy_chain(1:n+1))</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">! Create the initial position of the random walker </span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keyword">call </span>random_normal(3, sample_normal)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        x_start = sample_normal</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        x(:,1) = x_start </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="comment">! Calculate the local energy of the initial step </span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        energy_chain(1) = h_2_plus_energy(c_const, x(:, 1), r_a, r_b)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment">! Start the counter for the number of accepted moves</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        accept = 0  </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="comment">! Metropolis algorithm </span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">do</span> i = 2, n+1 </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="comment">! Propose the next step</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keyword">call </span>random_normal(3, sample_normal)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            x_n = x(:, i-1) + sigma * sample_normal</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="comment">! Calculate the transition probability between proposed step and current step </span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            log_prob_n = log(h_2_plus_prob(c_const, x(:, i-1), x_n, r_a,<span class="comment"> r_b))</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"></span>            <span class="comment">! Calculate the acceptance ratio </span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            a_prob_trans = min(1.0_real64, exp(log_prob_n))</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="comment">! Generate sample from uniform distribution</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keyword">call </span>ran1(unif_num, seed)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="comment">! Compare the drawn sample from the uniform distribution with the acceptance ratio</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">if</span> (a_prob_trans &gt;= unif_num) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                <span class="comment">! If accepted calculate local energy and add proposed position to the MCMC chain</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                x(:, i) = x_n </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                accept =  1 + accept</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                energy_chain(i) = h_2_plus_energy(c_const, x_n, r_a, r_b<span class="comment">)</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span>            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="comment">! If rejected the proposed step is the current step </span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                x(:, i) = x(:, i-1)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="comment">! The local energy of the proposed step is the same as the current step when rejected</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                energy_chain(i) = energy_chain(i-1)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordflow">            end if</span> </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keywordflow">        end do</span> </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment">! Calculate the acceptance ratio</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        accept_rate = accept / n </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacevqmc_a156887f8e878c4d01de5d2d4fa606a18_cgraph.png" border="0" usemap="#anamespacevqmc_a156887f8e878c4d01de5d2d4fa606a18_cgraph" alt=""/></div>
<map name="anamespacevqmc_a156887f8e878c4d01de5d2d4fa606a18_cgraph" id="anamespacevqmc_a156887f8e878c4d01de5d2d4fa606a18_cgraph">
<area shape="rect" title="Performs VQMC for H_2_plus" alt="" coords="5,5,156,32"/>
<area shape="rect" href="namespacevqmc.html#a01b80444204a0cd0b5cddde82cbc7651" title=" " alt="" coords="401,5,487,32"/>
<area shape="rect" href="namespacevqmc.html#a62ec9b662e5d9b46ec37d52ff93cb335" title=" " alt="" coords="204,31,353,57"/>
</map>
</div>

</div>
</div>
<a id="afdead1c964c264b80a7698da1bc3e792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdead1c964c264b80a7698da1bc3e792">&#9670;&nbsp;</a></span>vqmc_h_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vqmc::vqmc_h_2 </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>burn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>thin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:, :), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>X_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:, :), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>X_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out)&#160;</td>
          <td class="paramname"><em>accept_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out), allocatable&#160;</td>
          <td class="paramname"><em>energy_chain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs VQMC for H_2 <br  />
 </p>
<p>Computes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma</td><td>Step size </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>Number of steps to take </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">burn</td><td>Number of sample to discard at the beginning </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thin</td><td>The frequency at which we discard the samples from the MCMC chain after burning <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c_const</td><td>Parameter(s) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X_1</td><td>The full MCMC chain for random walker 1 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X_2</td><td>The full MCMC chain for random walker 2 </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">accept_rate</td><td>The acceptance rate of the MCMC chain </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">energy_chain</td><td>An array with the local energies of the each points in the MCMC chains </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00407">407</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordtype">implicit none</span> </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(3)</span> :: R_a, R_b</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: sigma</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span> :: c_const </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: N, burn, thin </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;         </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span> :: accept_rate</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:, :)</span>, <span class="keywordtype">allocatable</span> :: X_1, X_2</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: energy_chain</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordtype">        real</span>(real64) :: log_prob_n                              <span class="comment">! The natural logarithm of the transition proability </span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordtype">        real</span>(real64) :: a_prob_trans                            <span class="comment">! Acceptance ratio of the transitional probability                   </span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordtype">        real</span>(real64) :: unif_num                                <span class="comment">! A random sample from the uniform distribution </span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span> :: x_start_1, x_start_2      <span class="comment">! Starting points for the random walkers </span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span> :: X_n_1, X_n_2              <span class="comment">! The propsed steps for the random walkers </span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span> :: sample_normal             <span class="comment">! Sample from the normal distribution </span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordtype">integer</span> :: accept                                       <span class="comment">! Number of accepted steps </span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordtype">integer</span> :: i                                            <span class="comment">! Loop variable </span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keyword">allocate</span>(x_1(3, 1:n+1)) </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keyword">allocate</span>(x_2(3, 1:n+1))</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keyword">allocate</span>(energy_chain(1:n+1))</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keyword">call </span>random_normal(3, sample_normal)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        x_start_1 = sample_normal</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keyword">call </span>random_normal(3, sample_normal)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        x_start_2 = sample_normal </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        x_1(:,1) = x_start_1</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        x_2(:,1) = x_start_2</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        accept = 0 </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        energy_chain(1) = h_2_energy(c_const, x_1(:,1), x_2(:,1), r_a, r_b<span class="comment">) </span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span>        </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">do</span> i = 2, n+1 </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="comment">! Propose the next step</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keyword">call </span>random_normal(3, sample_normal)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            x_n_1 = x_1(:, i-1) + sigma * sample_normal</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keyword">call </span>random_normal(3, sample_normal)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            x_n_2 = x_2(:, i-1) + sigma * sample_normal</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            log_prob_n = log(h_2_prob(c_const, x_1(:, i-1), x_2(:, i-1),<span class="comment"> x_n_1, x_n_2, r_a, r_b))</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span>            a_prob_trans = min(1.0_real64, exp(log_prob_n))</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keyword">call </span>ran1(unif_num, seed)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="keywordflow">if</span> (a_prob_trans &gt;= unif_num) <span class="keywordflow">then</span> </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                x_1(:, i) = x_n_1</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                x_2(:, i) = x_n_2 </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                accept =  1 + accept</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                energy_chain(i) = h_2_energy(c_const, x_n_1, x_n_2, r_a,<span class="comment"> r_b)</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span>            <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                x_1(:, i) = x_1(:, i-1)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                x_2(:, i) = x_2(:, i-1) </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                energy_chain(i) = energy_chain(i-1)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="keywordflow">            end if</span> </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordflow">        end do</span> </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        accept_rate = accept / n </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacevqmc_afdead1c964c264b80a7698da1bc3e792_cgraph.png" border="0" usemap="#anamespacevqmc_afdead1c964c264b80a7698da1bc3e792_cgraph" alt=""/></div>
<map name="anamespacevqmc_afdead1c964c264b80a7698da1bc3e792_cgraph" id="anamespacevqmc_afdead1c964c264b80a7698da1bc3e792_cgraph">
<area shape="rect" title="Performs VQMC for H_2" alt="" coords="5,5,125,32"/>
<area shape="rect" href="namespacevqmc.html#a01b80444204a0cd0b5cddde82cbc7651" title=" " alt="" coords="371,5,456,32"/>
<area shape="rect" href="namespacevqmc.html#a62ec9b662e5d9b46ec37d52ff93cb335" title=" " alt="" coords="173,31,323,57"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4acb6b64bbac5c4684654d00393f7f24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4acb6b64bbac5c4684654d00393f7f24">&#9670;&nbsp;</a></span>ntab</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter vqmc::ntab = 32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00032">32</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: ntab = 32</div>
</div><!-- fragment -->
</div>
</div>
<a id="a86db46440794b9ef7cfd9fbf1fd69930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86db46440794b9ef7cfd9fbf1fd69930">&#9670;&nbsp;</a></span>iv</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(int64), dimension(<a class="el" href="namespacevqmc.html#a4acb6b64bbac5c4684654d00393f7f24">ntab</a>), save vqmc::iv = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00033">33</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">integer(int64)</span>, <span class="keywordtype">dimension(ntab)</span>, <span class="keywordtype">save</span> :: iv = 0 <span class="comment">! &#39;threadprivate&#39; by default since using MPI</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1608372d703310a49afc4243ccf27368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1608372d703310a49afc4243ccf27368">&#9670;&nbsp;</a></span>iy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(int64), save vqmc::iy = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00034">34</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordtype">integer(int64)</span>, <span class="keywordtype">save</span> :: iy = 0</div>
</div><!-- fragment -->
</div>
</div>
<a id="a986f071589794992c4bc31de25c63976"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a986f071589794992c4bc31de25c63976">&#9670;&nbsp;</a></span>seed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(int64), public vqmc::seed</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="vqmc_8f90_source.html#l00035">35</a> of file <a class="el" href="vqmc_8f90_source.html">vqmc.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordtype">integer(int64)</span> :: seed</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacevqmc.html">vqmc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
