<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Group_A_Codes: solvers Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Group_A_Codes
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacesolvers.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">solvers Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains local energy and transition probability solvers for available problems.  
<a href="namespacesolvers.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a722edf182d188ad1db7fa6a675fea13c"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a722edf182d188ad1db7fa6a675fea13c">qho_prob</a> (alpha, x_current, x_next)</td></tr>
<tr class="memdesc:a722edf182d188ad1db7fa6a675fea13c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates transition probability for quantum harmonic oscillator problem.  <a href="namespacesolvers.html#a722edf182d188ad1db7fa6a675fea13c">More...</a><br /></td></tr>
<tr class="separator:a722edf182d188ad1db7fa6a675fea13c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f0054c0d0d2f5080c92a04557feaf52"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a4f0054c0d0d2f5080c92a04557feaf52">qho_energy</a> (alpha, x)</td></tr>
<tr class="memdesc:a4f0054c0d0d2f5080c92a04557feaf52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates local energy for quantum harmonic oscillator problem.  <a href="namespacesolvers.html#a4f0054c0d0d2f5080c92a04557feaf52">More...</a><br /></td></tr>
<tr class="separator:a4f0054c0d0d2f5080c92a04557feaf52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d32620a8f8a8780a0b0ef83c490e8f7"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7">h1s_wfn</a> (r_elec, R_nuc)</td></tr>
<tr class="memdesc:a7d32620a8f8a8780a0b0ef83c490e8f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates value of the wavefunction of a hydrogen 1s orbital.  <a href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7">More...</a><br /></td></tr>
<tr class="separator:a7d32620a8f8a8780a0b0ef83c490e8f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89943685e3d86544f0261f24fac44419"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a89943685e3d86544f0261f24fac44419">h2s_wfn</a> (r_elec, R_nuc)</td></tr>
<tr class="memdesc:a89943685e3d86544f0261f24fac44419"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates value of the wavefunction of a hydrogen 2s orbital.  <a href="namespacesolvers.html#a89943685e3d86544f0261f24fac44419">More...</a><br /></td></tr>
<tr class="separator:a89943685e3d86544f0261f24fac44419"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d705d11696b64991f1624e298067bed"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed">h_2_plus_wfn</a> (c, r, R_a, R_b)</td></tr>
<tr class="memdesc:a6d705d11696b64991f1624e298067bed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates trial wavefunction for the \( H_{2}^{+} \) problem.  <a href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed">More...</a><br /></td></tr>
<tr class="separator:a6d705d11696b64991f1624e298067bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5695d107239a7a8fb1f8b096786af028"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a5695d107239a7a8fb1f8b096786af028">h_2_plus_prob</a> (c, r_current, r_next, R_a, R_b)</td></tr>
<tr class="memdesc:a5695d107239a7a8fb1f8b096786af028"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates transition probability for the \( H_{2}^{+} \) problem.  <a href="namespacesolvers.html#a5695d107239a7a8fb1f8b096786af028">More...</a><br /></td></tr>
<tr class="separator:a5695d107239a7a8fb1f8b096786af028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f21386928aadfc3dd6bc5cfb82fb94f"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a1f21386928aadfc3dd6bc5cfb82fb94f">h_2_plus_energy</a> (c, r, R_a, R_b, fdstep)</td></tr>
<tr class="memdesc:a1f21386928aadfc3dd6bc5cfb82fb94f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates local energy for the \( H_{2}^{+} \) problem.  <a href="namespacesolvers.html#a1f21386928aadfc3dd6bc5cfb82fb94f">More...</a><br /></td></tr>
<tr class="separator:a1f21386928aadfc3dd6bc5cfb82fb94f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0515876b10a8cebd7f381e14b1ff856"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#aa0515876b10a8cebd7f381e14b1ff856">h_2_wfn</a> (c, r_1, r_2, R_a, R_b)</td></tr>
<tr class="memdesc:aa0515876b10a8cebd7f381e14b1ff856"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates trial wavefunction for the \( H_{2} \) problem.  <a href="namespacesolvers.html#aa0515876b10a8cebd7f381e14b1ff856">More...</a><br /></td></tr>
<tr class="separator:aa0515876b10a8cebd7f381e14b1ff856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d0f254ede019bb0bf743397cd0069f7"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a0d0f254ede019bb0bf743397cd0069f7">h_2_prob</a> (c, r_1_current, r_2_current, r_1_next, r_2_next, R_a, R_b)</td></tr>
<tr class="memdesc:a0d0f254ede019bb0bf743397cd0069f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates transition probability for the \( H_{2} \) problem.  <a href="namespacesolvers.html#a0d0f254ede019bb0bf743397cd0069f7">More...</a><br /></td></tr>
<tr class="separator:a0d0f254ede019bb0bf743397cd0069f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab21b7ec07e33a8417b62ecb75c327a6f"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#ab21b7ec07e33a8417b62ecb75c327a6f">h_2_energy</a> (c, r_1, r_2, R_a, R_b, fdstep)</td></tr>
<tr class="memdesc:ab21b7ec07e33a8417b62ecb75c327a6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates local energy for the \( H_{2} \) problem.  <a href="namespacesolvers.html#ab21b7ec07e33a8417b62ecb75c327a6f">More...</a><br /></td></tr>
<tr class="separator:ab21b7ec07e33a8417b62ecb75c327a6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains local energy and transition probability solvers for available problems. </p>
<p>Module containing quantum mechanical solvers for local energy and Metropolis algorithm probability. Contains solvers for quantum harmonic oscillator (QHO), hydrogen ion (H_2_plus) and hydrogen molecule (H_2). Solvers can be linked to a function pointer by the input parsing module, depending on the problem specified by the input. This way, the main code and the VQMC algorithm can be made (mostly) independent of problem choice. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a722edf182d188ad1db7fa6a675fea13c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a722edf182d188ad1db7fa6a675fea13c">&#9670;&nbsp;</a></span>qho_prob()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::qho_prob </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>x_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>x_next</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates transition probability for quantum harmonic oscillator problem. </p>
<p>Computes </p><p class="formulaDsp">
\[ \frac{P(x_{i+1})}{P(x)} = \frac{\psi^{\alpha}_{T}(x_{i+1})}{\psi^{\alpha}_{T}(x)} = e^{-2\alpha(x^{2}_{i+1}-x^{2}_{i})} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>Parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_current</td><td>Current position of walker </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_next</td><td>Proposed position of walker </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Prob</td><td>Transition probability </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00050">50</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: alpha</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: x_current, x_next</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordtype">        real</span>(real64) :: Prob</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        prob = exp(-2*alpha*(x_next*x_next - x_current*x_current))</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a722edf182d188ad1db7fa6a675fea13c_icgraph.png" border="0" usemap="#anamespacesolvers_a722edf182d188ad1db7fa6a675fea13c_icgraph" alt=""/></div>
<map name="anamespacesolvers_a722edf182d188ad1db7fa6a675fea13c_icgraph" id="anamespacesolvers_a722edf182d188ad1db7fa6a675fea13c_icgraph">
<area shape="rect" title="Calculates transition probability for quantum harmonic oscillator problem." alt="" coords="173,5,296,32"/>
<area shape="rect" href="namespacevqmc.html#aa1f3818a0761a8d2907614fa15256a10" title=" " alt="" coords="5,5,125,32"/>
</map>
</div>

</div>
</div>
<a id="a4f0054c0d0d2f5080c92a04557feaf52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f0054c0d0d2f5080c92a04557feaf52">&#9670;&nbsp;</a></span>qho_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::qho_energy </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates local energy for quantum harmonic oscillator problem. </p>
<p>Computes </p><p class="formulaDsp">
\[ E^{\alpha}_{L}(x) = \frac{\hat{H}\psi^{\alpha}_{T}(x)}{\psi^{\alpha}_{T}(x)} = \alpha+x^{2}\left ( \frac{1}{2}-2\alpha^{2} \right ) \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>Parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position of walker </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">E_loc</td><td>Local energy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00079">79</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: alpha</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: x</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keywordtype">        real</span>(real64) :: E_loc</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        e_loc = alpha + (x*x)*(0.5 - (2*alpha*alpha))</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52_icgraph.png" border="0" usemap="#anamespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52_icgraph" alt=""/></div>
<map name="anamespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52_icgraph" id="anamespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52_icgraph">
<area shape="rect" title="Calculates local energy for quantum harmonic oscillator problem." alt="" coords="173,5,309,32"/>
<area shape="rect" href="namespacevqmc.html#aa1f3818a0761a8d2907614fa15256a10" title=" " alt="" coords="5,5,125,32"/>
</map>
</div>

</div>
</div>
<a id="a7d32620a8f8a8780a0b0ef83c490e8f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d32620a8f8a8780a0b0ef83c490e8f7">&#9670;&nbsp;</a></span>h1s_wfn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h1s_wfn </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_nuc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates value of the wavefunction of a hydrogen 1s orbital. </p>
<p>Function to calculate the wavefunction of an electron at position \( \mathbf{r} \) in a hydrogenic 1s atomic orbital, centred on nuclear position \( \mathbf{R}_{nuc}. \) Computes </p><p class="formulaDsp">
\[ \phi_{1s}(\mathbf{r}) = \frac{1}{\sqrt{\pi}a_{0}^{3/2}} e^{-\frac{\left |\mathbf{r-\mathbf{R}_{nuc}} \right |}{a_{0}}}, \]
</p>
<p> where </p><p class="formulaDsp">
\[a_{0}=\frac{\hbar^{2}}{2m} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">r_elec</td><td>Electron position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_nuc</td><td>Nuclear position </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">H1s_wfn</td><td>Value of wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00116">116</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_elec, R_nuc</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keywordtype">        real</span>(real64) :: H1s_wfn, prefac, expfac</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        prefac = 1 / (sqrt(pi) * (a_0**1.5)) <span class="comment">!OPT! can be made into a constant to save on processing time</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        expfac = -(norm2(r_elec - r_nuc) / a_0)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        h1s_wfn = prefac * exp(expfac)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7_icgraph.png" border="0" usemap="#anamespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7_icgraph" alt=""/></div>
<map name="anamespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7_icgraph" id="anamespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7_icgraph">
<area shape="rect" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="617,81,736,108"/>
<area shape="rect" href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="419,56,569,83"/>
<area shape="rect" href="namespacesolvers.html#aa0515876b10a8cebd7f381e14b1ff856" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="435,107,553,133"/>
<area shape="rect" href="namespacesolvers.html#a1f21386928aadfc3dd6bc5cfb82fb94f" title="Calculates local energy for the &#160;problem." alt="" coords="204,5,371,32"/>
<area shape="rect" href="namespacesolvers.html#a5695d107239a7a8fb1f8b096786af028" title="Calculates transition probability for the &#160;problem." alt="" coords="210,56,365,83"/>
<area shape="rect" href="namespacevqmc.html#ab903fb33ac49e462c789d47067ba311d" title=" " alt="" coords="5,44,156,71"/>
<area shape="rect" href="namespacesolvers.html#ab21b7ec07e33a8417b62ecb75c327a6f" title="Calculates local energy for the &#160;problem." alt="" coords="219,107,355,133"/>
<area shape="rect" href="namespacesolvers.html#a0d0f254ede019bb0bf743397cd0069f7" title="Calculates transition probability for the &#160;problem." alt="" coords="226,157,349,184"/>
<area shape="rect" href="namespacevqmc.html#a82cd0f11ac51e9fc6f3246db0ca923aa" title=" " alt="" coords="21,120,141,147"/>
</map>
</div>

</div>
</div>
<a id="a89943685e3d86544f0261f24fac44419"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89943685e3d86544f0261f24fac44419">&#9670;&nbsp;</a></span>h2s_wfn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h2s_wfn </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_nuc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates value of the wavefunction of a hydrogen 2s orbital. </p>
<p>Function to calculate the wavefunction of an electron at position \( \mathbf{r} \) in a hydrogenic 2s atomic orbital, centred on nuclear position \( \mathbf{R}_{nuc}. \) Computes </p><p class="formulaDsp">
\[ \psi_{2s} = \frac{1}{4\sqrt{2\pi}a_{0}^{3/2}} \left [ 2 - \frac{\left |\mathbf{r-\mathbf{R}_{A}} \right |}{a_{0}} \right ] e^{-\frac{\left |\mathbf{r-\mathbf{R}_{A}} \right |}{2a_{0}}}, \]
</p>
<p> where </p><p class="formulaDsp">
\[a_{0}=\frac{\hbar^{2}}{2m} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">r_elec</td><td>Electron position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_nuc</td><td>Nuclear position </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">H2s_wfn</td><td>Value of wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00151">151</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_elec, R_nuc</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordtype">        real</span>(real64) :: H2s_wfn, prefac, expfac, r_norm</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        r_norm = norm2(r_elec - r_nuc)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        prefac = (1 / (4 * sqrt(2*pi) * (a_0**1.5))) * (2 - (r_norm / a_0<span class="comment">)) !OPT! can be made into a constant to save on processing time</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        expfac = -(r_norm / (2 * a_0))</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        h2s_wfn = prefac*exp(expfac)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a89943685e3d86544f0261f24fac44419_icgraph.png" border="0" usemap="#anamespacesolvers_a89943685e3d86544f0261f24fac44419_icgraph" alt=""/></div>
<map name="anamespacesolvers_a89943685e3d86544f0261f24fac44419_icgraph" id="anamespacesolvers_a89943685e3d86544f0261f24fac44419_icgraph">
<area shape="rect" title="Calculates value of the wavefunction of a hydrogen 2s orbital." alt="" coords="617,81,736,108"/>
<area shape="rect" href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="419,56,569,83"/>
<area shape="rect" href="namespacesolvers.html#aa0515876b10a8cebd7f381e14b1ff856" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="435,107,553,133"/>
<area shape="rect" href="namespacesolvers.html#a1f21386928aadfc3dd6bc5cfb82fb94f" title="Calculates local energy for the &#160;problem." alt="" coords="204,5,371,32"/>
<area shape="rect" href="namespacesolvers.html#a5695d107239a7a8fb1f8b096786af028" title="Calculates transition probability for the &#160;problem." alt="" coords="210,56,365,83"/>
<area shape="rect" href="namespacevqmc.html#ab903fb33ac49e462c789d47067ba311d" title=" " alt="" coords="5,44,156,71"/>
<area shape="rect" href="namespacesolvers.html#ab21b7ec07e33a8417b62ecb75c327a6f" title="Calculates local energy for the &#160;problem." alt="" coords="219,107,355,133"/>
<area shape="rect" href="namespacesolvers.html#a0d0f254ede019bb0bf743397cd0069f7" title="Calculates transition probability for the &#160;problem." alt="" coords="226,157,349,184"/>
<area shape="rect" href="namespacevqmc.html#a82cd0f11ac51e9fc6f3246db0ca923aa" title=" " alt="" coords="21,120,141,147"/>
</map>
</div>

</div>
</div>
<a id="a6d705d11696b64991f1624e298067bed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d705d11696b64991f1624e298067bed">&#9670;&nbsp;</a></span>h_2_plus_wfn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_plus_wfn </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates trial wavefunction for the \( H_{2}^{+} \) problem. </p>
<p>Function to calculate the wavefunction of an electron at position \( \mathbf{r} \) in the hydrogen molecular ion \( H_{2}^{+} \). Depending on the value of variable <em>include_pqn</em>, will either calculate </p><p class="formulaDsp">
\[ \psi^{c}_{T}(\mathbf{r}) = c\phi_{1s}^{A}(\mathbf{r}) + \sqrt{1-c^{2}}\phi_{1s}^{B}(\mathbf{r}) \]
</p>
<p> if <em>include_pqn</em> is set to 1, or </p><p class="formulaDsp">
\[ \psi^{\mathbf{c}}_{T}(\mathbf{r}) = c_{1}\phi_{1s}^{A} + \sqrt{1-c_{1}^{2}}\phi_{1s}^{B} + c_{2}\phi_{2s}^{A} + \sqrt{1-c_{2}^{2}}\phi_{2s}^{B} \]
</p>
<p> if <em>include_pqn</em> is set to 2. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter(s) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Electron position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">wfn</td><td>Value of trial wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00196">196</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: c</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keywordtype">        real</span>(real64) :: wfn</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">if</span> (include_pqn .eq. 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            wfn = (c(1) * h1s_wfn(r, r_a)) + (sqrt(1 - (c(1)*c(1))) * h1s_wfn<span class="comment">(r, r_b))</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (include_pqn .eq. 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            wfn = (c(1) * h1s_wfn(r, r_a)) + (sqrt(1 - (c(1)*c(1))) * h1s_wfn<span class="comment">(r, r_b)) &amp;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span>                    + (c(2) * h2s_wfn(r, r_a)) + (sqrt(1 - (c(2)*c(2))) <span class="comment">* h2s_wfn(r, r_b))</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span>        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            error stop <span class="stringliteral">&#39;Global include_pqn can only take values 1 or 2.&#39;</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a6d705d11696b64991f1624e298067bed_cgraph.png" border="0" usemap="#anamespacesolvers_a6d705d11696b64991f1624e298067bed_cgraph" alt=""/></div>
<map name="anamespacesolvers_a6d705d11696b64991f1624e298067bed_cgraph" id="anamespacesolvers_a6d705d11696b64991f1624e298067bed_cgraph">
<area shape="rect" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="5,31,156,57"/>
<area shape="rect" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="204,5,323,32"/>
<area shape="rect" href="namespacesolvers.html#a89943685e3d86544f0261f24fac44419" title="Calculates value of the wavefunction of a hydrogen 2s orbital." alt="" coords="204,56,323,83"/>
</map>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a6d705d11696b64991f1624e298067bed_icgraph.png" border="0" usemap="#anamespacesolvers_a6d705d11696b64991f1624e298067bed_icgraph" alt=""/></div>
<map name="anamespacesolvers_a6d705d11696b64991f1624e298067bed_icgraph" id="anamespacesolvers_a6d705d11696b64991f1624e298067bed_icgraph">
<area shape="rect" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="419,31,569,57"/>
<area shape="rect" href="namespacesolvers.html#a1f21386928aadfc3dd6bc5cfb82fb94f" title="Calculates local energy for the &#160;problem." alt="" coords="204,5,371,32"/>
<area shape="rect" href="namespacesolvers.html#a5695d107239a7a8fb1f8b096786af028" title="Calculates transition probability for the &#160;problem." alt="" coords="210,56,365,83"/>
<area shape="rect" href="namespacevqmc.html#ab903fb33ac49e462c789d47067ba311d" title=" " alt="" coords="5,31,156,57"/>
</map>
</div>

</div>
</div>
<a id="a5695d107239a7a8fb1f8b096786af028"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5695d107239a7a8fb1f8b096786af028">&#9670;&nbsp;</a></span>h_2_plus_prob()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_plus_prob </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates transition probability for the \( H_{2}^{+} \) problem. </p>
<p>Function to calculate transition probability for walkers in the \( H_{2}^{+} \) problem. Computes </p><p class="formulaDsp">
\[ \frac{P(x_{i+1})}{P(x)} = \frac{\psi^{c}_{T}(\mathbf{r}_{i+1})}{\psi^{c}_{T}(\mathbf{r})} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter(s) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_current</td><td>Current position of walker </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_next</td><td>Proposed position of walker </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Prob</td><td>Transition probability </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00237">237</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: c</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_current, r_next</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keywordtype">        real</span>(real64) :: Prob</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        prob = h_2_plus_wfn(c, r_next, r_a, r_b) / h_2_plus_wfn(c, r_current<span class="comment">, r_a, r_b)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
</div><!-- fragment --><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a5695d107239a7a8fb1f8b096786af028_cgraph.png" border="0" usemap="#anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_cgraph" alt=""/></div>
<map name="anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_cgraph" id="anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_cgraph">
<area shape="rect" title="Calculates transition probability for the &#160;problem." alt="" coords="5,31,160,57"/>
<area shape="rect" href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="208,31,359,57"/>
<area shape="rect" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="407,5,525,32"/>
<area shape="rect" href="namespacesolvers.html#a89943685e3d86544f0261f24fac44419" title="Calculates value of the wavefunction of a hydrogen 2s orbital." alt="" coords="407,56,525,83"/>
</map>
</div>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a5695d107239a7a8fb1f8b096786af028_icgraph.png" border="0" usemap="#anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_icgraph" alt=""/></div>
<map name="anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_icgraph" id="anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_icgraph">
<area shape="rect" title="Calculates transition probability for the &#160;problem." alt="" coords="204,5,359,32"/>
<area shape="rect" href="namespacevqmc.html#ab903fb33ac49e462c789d47067ba311d" title=" " alt="" coords="5,5,156,32"/>
</map>
</div>

</div>
</div>
<a id="a1f21386928aadfc3dd6bc5cfb82fb94f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f21386928aadfc3dd6bc5cfb82fb94f">&#9670;&nbsp;</a></span>h_2_plus_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_plus_energy </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), optional&#160;</td>
          <td class="paramname"><em>fdstep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates local energy for the \( H_{2}^{+} \) problem. </p>
<p>Function to calculate the local energy of a walker in the \( H_{2}^{+} \) problem. Computes </p><p class="formulaDsp">
\[ E^{c}_{L}(\mathbf{r}) = \frac{\hat{H}\psi^{c}_{T}(\mathbf{r})}{\psi^{c}_{T}(\mathbf{r})} \]
</p>
<p> where </p><p class="formulaDsp">
\[ \hat{H} = -\frac{\hbar^{2}}{2m}\nabla^{2} - \frac{e^{2}}{4\pi\epsilon_{0}\left | \mathbf{r}-\mathbf{R}_{A} \right |} - \frac{e^{2}}{4\pi\epsilon_{0}\left | \mathbf{r}-\mathbf{R}_{B} \right |} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter(s) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Position of walker </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fdstep</td><td>Finite difference step size (optional, default = 1e-10) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">E_loc</td><td>Local energy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00275">275</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: c</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">optional</span> :: fdstep</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordtype">        real</span>(real64) :: step                    <span class="comment">! Auxiliary variable for defaulting</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">        real</span>(real64) :: laplacian               <span class="comment">! 2nd derivative of trial wavefunction</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordtype">        real</span>(real64) :: coulomb                 <span class="comment">! Coulomb terms of Hamiltonian</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span> :: r_temp</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(2, 3)</span> :: diffs  <span class="comment">! Wavefunction finite differences</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordtype">        real</span>(real64) :: wfn, wfnx2              <span class="comment">! Wavefunction at walker position</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keywordtype">        real</span>(real64) :: E_loc</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">! Allow the finite difference step size to take a default value.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(fdstep)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            step = fdstep</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            step = 1e-10_real64</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">! Calculate trial wavefunction at provided point.</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        wfn = h_2_plus_wfn(c, r, r_a, r_b)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        wfnx2 = 2 * wfn</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="comment">! Calculate trial wavefunction in finite difference directions.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">do</span> i = 1, 3</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            r_temp = r</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            r_temp(i) = r(i) - step</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            diffs(1, i) = h_2_plus_wfn(c, r_temp, r_a, r_b)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            r_temp(i) = r(i) + step</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            diffs(2, i) = h_2_plus_wfn(c, r_temp, r_a, r_b)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">! Assemble Hamiltonian</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        laplacian = ((diffs(1, 1) - wfnx2 + diffs(2, 1)) + &amp;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                     (diffs(1, 2) - wfnx2 + diffs(2, 2)) + &amp;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                     (diffs(1, 3) - wfnx2 + diffs(2, 3))) / (step*step)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        laplacian = laplacian * (-(hbar * hbar) / (2  * m_elec))</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        coulomb = -(((e_chg * e_chg) / (4 * pi * eps_0)) * &amp;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                  ((1  / norm2(r - r_a)) + (1 / norm2(r - r_b)))) * wfn</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        e_loc = (laplacian + coulomb) / wfn</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        </div>
</div><!-- fragment --><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f_cgraph.png" border="0" usemap="#anamespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f_cgraph" alt=""/></div>
<map name="anamespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f_cgraph" id="anamespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f_cgraph">
<area shape="rect" title="Calculates local energy for the &#160;problem." alt="" coords="5,31,172,57"/>
<area shape="rect" href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="220,31,371,57"/>
<area shape="rect" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="419,5,537,32"/>
<area shape="rect" href="namespacesolvers.html#a89943685e3d86544f0261f24fac44419" title="Calculates value of the wavefunction of a hydrogen 2s orbital." alt="" coords="419,56,537,83"/>
</map>
</div>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f_icgraph.png" border="0" usemap="#anamespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f_icgraph" alt=""/></div>
<map name="anamespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f_icgraph" id="anamespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f_icgraph">
<area shape="rect" title="Calculates local energy for the &#160;problem." alt="" coords="204,5,371,32"/>
<area shape="rect" href="namespacevqmc.html#ab903fb33ac49e462c789d47067ba311d" title=" " alt="" coords="5,5,156,32"/>
</map>
</div>

</div>
</div>
<a id="aa0515876b10a8cebd7f381e14b1ff856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0515876b10a8cebd7f381e14b1ff856">&#9670;&nbsp;</a></span>h_2_wfn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_wfn </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates trial wavefunction for the \( H_{2} \) problem. </p>
<p>Function to calculate the wavefunction of two electrons at positions \( \mathbf{r}_{1} \) and \( \mathbf{r}_{2} \) in the hydrogen molecule \( H_{2} \). Depending on the value of variable <em>include_pqn</em>, will either calculate </p><p class="formulaDsp">
\[ \psi^{c}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2}) = c \left ( \phi_{1s}^{A}(\mathbf{r}_{1})\phi_{1s}^{B}(\mathbf{r}_{2}) + \phi_{1s}^{A}(\mathbf{r}_{2})\phi_{1s}^{B}(\mathbf{r}_{1}) \right ) \]
</p>
<p> if <em>include_pqn</em> is set to 1, or </p><p class="formulaDsp">
\[ \psi^{\mathbf{c}}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2}) = c_{1} \left ( \phi_{1s}^{A}(\mathbf{r}_{1})\phi_{1s}^{B}(\mathbf{r}_{2}) + \phi_{1s}^{A}(\mathbf{r}_{2})\phi_{1s}^{B}(\mathbf{r}_{1}) \right ) + c_{2} \left ( \phi_{2s}^{A}(\mathbf{r}_{1})\phi_{2s}^{B}(\mathbf{r}_{2}) + \phi_{2s}^{A}(\mathbf{r}_{2})\phi_{2s}^{B}(\mathbf{r}_{1}) \right ) \]
</p>
<p> if <em>include_pqn</em> is set to 2. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter(s) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_1</td><td>Position of electron 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_2</td><td>Position of electron 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">wfn</td><td>Value of trial wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00362">362</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: c</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_1, r_2</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordtype">        real</span>(real64) :: wfn</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span> (include_pqn .eq. 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            wfn = c(1) * ((h1s_wfn(r_1, r_a) * h1s_wfn(r_2, r_b)) &amp;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                  + (h1s_wfn(r_2, r_a) * h1s_wfn(r_1, r_b)))</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (include_pqn .eq. 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            wfn = c(1) * ((h1s_wfn(r_1, r_a) * h1s_wfn(r_2, r_b)) &amp;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                  + (h1s_wfn(r_2, r_a) * h1s_wfn(r_1, r_b))) + &amp; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                  c(2) * ((h2s_wfn(r_1, r_a) * h2s_wfn(r_2, r_b)) &amp;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                  + (h2s_wfn(r_2, r_a) * h2s_wfn(r_1, r_b)))</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            error stop <span class="stringliteral">&#39;Global include_pqn can only take values 1 or 2.&#39;</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_aa0515876b10a8cebd7f381e14b1ff856_cgraph.png" border="0" usemap="#anamespacesolvers_aa0515876b10a8cebd7f381e14b1ff856_cgraph" alt=""/></div>
<map name="anamespacesolvers_aa0515876b10a8cebd7f381e14b1ff856_cgraph" id="anamespacesolvers_aa0515876b10a8cebd7f381e14b1ff856_cgraph">
<area shape="rect" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="5,31,124,57"/>
<area shape="rect" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="172,5,291,32"/>
<area shape="rect" href="namespacesolvers.html#a89943685e3d86544f0261f24fac44419" title="Calculates value of the wavefunction of a hydrogen 2s orbital." alt="" coords="172,56,291,83"/>
</map>
</div>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_aa0515876b10a8cebd7f381e14b1ff856_icgraph.png" border="0" usemap="#anamespacesolvers_aa0515876b10a8cebd7f381e14b1ff856_icgraph" alt=""/></div>
<map name="anamespacesolvers_aa0515876b10a8cebd7f381e14b1ff856_icgraph" id="anamespacesolvers_aa0515876b10a8cebd7f381e14b1ff856_icgraph">
<area shape="rect" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="357,31,476,57"/>
<area shape="rect" href="namespacesolvers.html#ab21b7ec07e33a8417b62ecb75c327a6f" title="Calculates local energy for the &#160;problem." alt="" coords="173,5,309,32"/>
<area shape="rect" href="namespacesolvers.html#a0d0f254ede019bb0bf743397cd0069f7" title="Calculates transition probability for the &#160;problem." alt="" coords="180,56,303,83"/>
<area shape="rect" href="namespacevqmc.html#a82cd0f11ac51e9fc6f3246db0ca923aa" title=" " alt="" coords="5,31,125,57"/>
</map>
</div>

</div>
</div>
<a id="a0d0f254ede019bb0bf743397cd0069f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d0f254ede019bb0bf743397cd0069f7">&#9670;&nbsp;</a></span>h_2_prob()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_prob </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_1_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_2_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_1_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_2_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates transition probability for the \( H_{2} \) problem. </p>
<p>Function to calculate transition probability for walkers in the \( H_{2} \) problem. Computes </p><p class="formulaDsp">
\[ \frac{P(x_{i+1})}{P(x)} = \frac{\psi^{c}_{T}(\mathbf{r}_{1}^{i+1}, \mathbf{r}_{2}^{i+1})} {\psi^{c}_{T}(\mathbf{r}_{1}^{i}, \mathbf{r}_{2}^{i})} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter(s) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_1_current</td><td>Current position of walker 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_2_current</td><td>Current position of walker 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_1_next</td><td>Proposed position of walker 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_2_next</td><td>Proposed position of walker 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Prob</td><td>Transition probability </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00409">409</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: c</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_1_current, r_2_current</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_1_next, r_2_next</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="keywordtype">        real</span>(real64) :: Prob</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        prob = h_2_wfn(c, r_1_next, r_2_next, r_a, r_b) / &amp;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;               h_2_wfn(c, r_1_current, r_2_current, r_a, r_b)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a0d0f254ede019bb0bf743397cd0069f7_cgraph.png" border="0" usemap="#anamespacesolvers_a0d0f254ede019bb0bf743397cd0069f7_cgraph" alt=""/></div>
<map name="anamespacesolvers_a0d0f254ede019bb0bf743397cd0069f7_cgraph" id="anamespacesolvers_a0d0f254ede019bb0bf743397cd0069f7_cgraph">
<area shape="rect" title="Calculates transition probability for the &#160;problem." alt="" coords="5,31,128,57"/>
<area shape="rect" href="namespacesolvers.html#aa0515876b10a8cebd7f381e14b1ff856" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="176,31,295,57"/>
<area shape="rect" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="343,5,461,32"/>
<area shape="rect" href="namespacesolvers.html#a89943685e3d86544f0261f24fac44419" title="Calculates value of the wavefunction of a hydrogen 2s orbital." alt="" coords="343,56,461,83"/>
</map>
</div>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a0d0f254ede019bb0bf743397cd0069f7_icgraph.png" border="0" usemap="#anamespacesolvers_a0d0f254ede019bb0bf743397cd0069f7_icgraph" alt=""/></div>
<map name="anamespacesolvers_a0d0f254ede019bb0bf743397cd0069f7_icgraph" id="anamespacesolvers_a0d0f254ede019bb0bf743397cd0069f7_icgraph">
<area shape="rect" title="Calculates transition probability for the &#160;problem." alt="" coords="173,5,296,32"/>
<area shape="rect" href="namespacevqmc.html#a82cd0f11ac51e9fc6f3246db0ca923aa" title=" " alt="" coords="5,5,125,32"/>
</map>
</div>

</div>
</div>
<a id="ab21b7ec07e33a8417b62ecb75c327a6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab21b7ec07e33a8417b62ecb75c327a6f">&#9670;&nbsp;</a></span>h_2_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_energy </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), optional&#160;</td>
          <td class="paramname"><em>fdstep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates local energy for the \( H_{2} \) problem. </p>
<p>Function to calculate the local energy of two walkers in the \( H_{2} \) problem. Computes </p><p class="formulaDsp">
\[ E^{c}_{L}(\mathbf{r}_{1}, \mathbf{r}_{2}) = \frac{\hat{H}\psi^{c}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2})} {\psi^{c}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2})} \]
</p>
<p> where </p><p class="formulaDsp">
\[ \hat{H} = -\frac{\hbar^{2}}{2m}\nabla^{2} + \frac{e^{2}}{4\pi\epsilon_{0}} \left ( -\frac{1}{\left | \mathbf{r}_{1}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}_{1}-\mathbf{R}_{B} \right |} - \frac{1}{\left | \mathbf{r}_{2}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}_{2}-\mathbf{R}_{B} \right |} + \frac{1}{\left | \mathbf{r}_{1}-\mathbf{r}_{2} \right |} \right ) \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter(s) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_1</td><td>Position of walker 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_2</td><td>Position of walker 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fdstep</td><td>Finite difference step size (optional, default = 1e-10) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">E_loc</td><td>Local energy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00455">455</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: c</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_1, r_2</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">optional</span> :: fdstep</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordtype">        real</span>(real64) :: step                                <span class="comment">! Auxiliary variable for defaulting</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keywordtype">        real</span>(real64) :: laplacian                           <span class="comment">! 2nd derivative of trial wavefunction</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordtype">        real</span>(real64) :: coulomb                             <span class="comment">! Coulomb terms of Hamiltonian</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span> :: r_1_temp, r_2_temp</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(2, 3)</span> :: diffs_1, diffs_2   <span class="comment">! Wavefunction finite differences</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordtype">        real</span>(real64) :: wfn, wfnx2                          <span class="comment">! Wavefunction at walker positions</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordtype">integer</span> :: backdiff, forwdiff</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordtype">integer</span> :: i</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordtype">        real</span>(real64) :: E_loc</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="comment">! Allow the finite difference step size to take a default value.</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">present</span>(fdstep)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            step = fdstep</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            step = 1e-10_real64</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="comment">! Calculate trial wavefunction at provided walker positions.</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        wfn = h_2_wfn(c, r_1, r_2, r_a, r_b)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        wfnx2 = 2 * wfn <span class="comment">! Reduce unneccessary multiplication</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        backdiff = 1</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        forwdiff = 2</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="comment">! Calculate trial wavefunction in finite difference directions.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">do</span> i = 1, 3</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            r_1_temp = r_1</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            r_2_temp = r_2</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            r_1_temp(i) = r_1(i) - step</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            r_2_temp(i) = r_2(i) - step</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            diffs_1(backdiff, i) = h_2_wfn(c, r_1_temp, r_2, r_a, r_b)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            diffs_2(backdiff, i) = h_2_wfn(c, r_1, r_2_temp, r_a, r_b)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            r_1_temp(i) = r_1(i) + step</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            r_2_temp(i) = r_2(i) + step</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            diffs_1(forwdiff, i) = h_2_wfn(c, r_1_temp, r_2, r_a, r_b)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            diffs_2(forwdiff, i) = h_2_wfn(c, r_1, r_2_temp, r_a, r_b)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">! Assemble Hamiltonian.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        laplacian = (((diffs_1(backdiff, 1) - wfnx2 + diffs_1(forwdiff, <span class="comment">1)) + &amp;</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"></span>                      (diffs_1(backdiff, 2) - wfnx2 + diffs_1(forwdiff, <span class="comment">2)) + &amp;</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"></span>                      (diffs_1(backdiff, 3) - wfnx2 + diffs_1(forwdiff, <span class="comment">3))) + &amp;</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"></span>                     ((diffs_2(backdiff, 1) - wfnx2 + diffs_2(forwdiff, <span class="comment">1)) + &amp;</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"></span>                      (diffs_2(backdiff, 2) - wfnx2 + diffs_2(forwdiff, <span class="comment">2)) + &amp;</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"></span>                      (diffs_2(backdiff, 3) - wfnx2 + diffs_2(forwdiff, <span class="comment">3)))) &amp;</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span>                    / (step*step)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        laplacian = laplacian * (-(hbar * hbar) / (2  * m_elec))</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        coulomb = (((e_chg * e_chg) / (4 * pi * eps_0)) * &amp;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                   (- (1 / norm2(r_1 - r_a)) - (1 / norm2(r_1 - r_b)) &amp;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    - (1 / norm2(r_2 - r_a)) - (1 / norm2(r_2 - r_b)) &amp;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    + (1 / norm2(r_1 - r_2)))) * wfn</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        e_loc = (laplacian + coulomb) / wfn</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        </div>
</div><!-- fragment --><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f_cgraph.png" border="0" usemap="#anamespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f_cgraph" alt=""/></div>
<map name="anamespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f_cgraph" id="anamespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f_cgraph">
<area shape="rect" title="Calculates local energy for the &#160;problem." alt="" coords="5,31,141,57"/>
<area shape="rect" href="namespacesolvers.html#aa0515876b10a8cebd7f381e14b1ff856" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="189,31,308,57"/>
<area shape="rect" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="356,5,475,32"/>
<area shape="rect" href="namespacesolvers.html#a89943685e3d86544f0261f24fac44419" title="Calculates value of the wavefunction of a hydrogen 2s orbital." alt="" coords="356,56,475,83"/>
</map>
</div>
<div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f_icgraph.png" border="0" usemap="#anamespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f_icgraph" alt=""/></div>
<map name="anamespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f_icgraph" id="anamespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f_icgraph">
<area shape="rect" title="Calculates local energy for the &#160;problem." alt="" coords="173,5,309,32"/>
<area shape="rect" href="namespacevqmc.html#a82cd0f11ac51e9fc6f3246db0ca923aa" title=" " alt="" coords="5,5,125,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesolvers.html">solvers</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
