\hypertarget{namespacesolvers}{}\doxysection{solvers Module Reference}
\label{namespacesolvers}\index{solvers@{solvers}}


Contains local energy and transition probability solvers for available problems.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a722edf182d188ad1db7fa6a675fea13c}{qho\+\_\+prob}} (alpha, x\+\_\+current, x\+\_\+next)
\begin{DoxyCompactList}\small\item\em Calculates transition probability for quantum harmonic oscillator problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52}{qho\+\_\+energy}} (alpha, x)
\begin{DoxyCompactList}\small\item\em Calculates local energy for quantum harmonic oscillator problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7}{h1s\+\_\+wfn}} (r\+\_\+elec, R\+\_\+nuc)
\begin{DoxyCompactList}\small\item\em Calculates value of the wavefunction of a hydrogen 1s orbital. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a89943685e3d86544f0261f24fac44419}{h2s\+\_\+wfn}} (r\+\_\+elec, R\+\_\+nuc)
\begin{DoxyCompactList}\small\item\em Calculates value of the wavefunction of a hydrogen 2s orbital. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a6d705d11696b64991f1624e298067bed}{h\+\_\+2\+\_\+plus\+\_\+wfn}} (c, r, R\+\_\+a, R\+\_\+b)
\begin{DoxyCompactList}\small\item\em Calculates trial wavefunction for the $ H_{2}^{+} $ problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a5695d107239a7a8fb1f8b096786af028}{h\+\_\+2\+\_\+plus\+\_\+prob}} (c, r\+\_\+current, r\+\_\+next, R\+\_\+a, R\+\_\+b)
\begin{DoxyCompactList}\small\item\em Calculates transition probability for the $ H_{2}^{+} $ problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f}{h\+\_\+2\+\_\+plus\+\_\+energy}} (c, r, R\+\_\+a, R\+\_\+b, fdstep)
\begin{DoxyCompactList}\small\item\em Calculates local energy for the $ H_{2}^{+} $ problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_aa0515876b10a8cebd7f381e14b1ff856}{h\+\_\+2\+\_\+wfn}} (c, r\+\_\+1, r\+\_\+2, R\+\_\+a, R\+\_\+b)
\begin{DoxyCompactList}\small\item\em Calculates trial wavefunction for the $ H_{2} $ problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a0d0f254ede019bb0bf743397cd0069f7}{h\+\_\+2\+\_\+prob}} (c, r\+\_\+1\+\_\+current, r\+\_\+2\+\_\+current, r\+\_\+1\+\_\+next, r\+\_\+2\+\_\+next, R\+\_\+a, R\+\_\+b)
\begin{DoxyCompactList}\small\item\em Calculates transition probability for the $ H_{2} $ problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f}{h\+\_\+2\+\_\+energy}} (c, r\+\_\+1, r\+\_\+2, R\+\_\+a, R\+\_\+b, fdstep)
\begin{DoxyCompactList}\small\item\em Calculates local energy for the $ H_{2} $ problem. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains local energy and transition probability solvers for available problems. 

Module containing quantum mechanical solvers for local energy and Metropolis algorithm probability. Contains solvers for quantum harmonic oscillator (QHO), hydrogen ion (H\+\_\+2\+\_\+plus) and hydrogen molecule (H\+\_\+2). Solvers can be linked to a function pointer by the input parsing module, depending on the problem specified by the input. This way, the main code and the VQMC algorithm can be made (mostly) independent of problem choice. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacesolvers_a722edf182d188ad1db7fa6a675fea13c}\label{namespacesolvers_a722edf182d188ad1db7fa6a675fea13c}} 
\index{solvers@{solvers}!qho\_prob@{qho\_prob}}
\index{qho\_prob@{qho\_prob}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{qho\_prob()}{qho\_prob()}}
{\footnotesize\ttfamily real(real64) function solvers\+::qho\+\_\+prob (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{alpha,  }\item[{real(real64), intent(in)}]{x\+\_\+current,  }\item[{real(real64), intent(in)}]{x\+\_\+next }\end{DoxyParamCaption})}



Calculates transition probability for quantum harmonic oscillator problem. 

Computes \[ \frac{P(x_{i+1})}{P(x)} = \frac{\psi^{\alpha}_{T}(x_{i+1})}{\psi^{\alpha}_{T}(x)} = e^{-2\alpha(x^{2}_{i+1}-x^{2}_{i})} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em alpha} & Parameter \\
\hline
\mbox{\texttt{ in}}  & {\em x\+\_\+current} & Current position of walker \\
\hline
\mbox{\texttt{ in}}  & {\em x\+\_\+next} & Proposed position of walker \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em Prob} & Transition probability \\
\hline
\end{DoxyRetVals}


Definition at line 50 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{51 }
\DoxyCodeLine{52         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: alpha}
\DoxyCodeLine{55 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: x\_current, x\_next}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{keywordtype}{        real}(real64) :: Prob}
\DoxyCodeLine{58 }
\DoxyCodeLine{59         prob = exp(-\/2*alpha*(x\_next*x\_next -\/ x\_current*x\_current))}
\DoxyCodeLine{60 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a722edf182d188ad1db7fa6a675fea13c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52}\label{namespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52}} 
\index{solvers@{solvers}!qho\_energy@{qho\_energy}}
\index{qho\_energy@{qho\_energy}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{qho\_energy()}{qho\_energy()}}
{\footnotesize\ttfamily real(real64) function solvers\+::qho\+\_\+energy (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{alpha,  }\item[{real(real64), intent(in)}]{x }\end{DoxyParamCaption})}



Calculates local energy for quantum harmonic oscillator problem. 

Computes \[ E^{\alpha}_{L}(x) = \frac{\hat{H}\psi^{\alpha}_{T}(x)}{\psi^{\alpha}_{T}(x)} = \alpha+x^{2}\left ( \frac{1}{2}-2\alpha^{2} \right ) \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em alpha} & Parameter \\
\hline
\mbox{\texttt{ in}}  & {\em x} & Position of walker \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em E\+\_\+loc} & Local energy \\
\hline
\end{DoxyRetVals}


Definition at line 79 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{80 }
\DoxyCodeLine{81         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: alpha}
\DoxyCodeLine{84 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: x}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \textcolor{keywordtype}{        real}(real64) :: E\_loc}
\DoxyCodeLine{87 }
\DoxyCodeLine{88         e\_loc = alpha + (x*x)*(0.5 -\/ (2*alpha*alpha))}
\DoxyCodeLine{89 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7}\label{namespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7}} 
\index{solvers@{solvers}!h1s\_wfn@{h1s\_wfn}}
\index{h1s\_wfn@{h1s\_wfn}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h1s\_wfn()}{h1s\_wfn()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h1s\+\_\+wfn (\begin{DoxyParamCaption}\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+elec,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+nuc }\end{DoxyParamCaption})}



Calculates value of the wavefunction of a hydrogen 1s orbital. 

Function to calculate the wavefunction of an electron at position $ \mathbf{r} $ in a hydrogenic 1s atomic orbital, centred on nuclear position $ \mathbf{R}_{nuc}. $ Computes \[ \phi_{1s}^{A}(\mathbf{r}) = \frac{1}{\sqrt{\pi}}e^{-\left |\mathbf{r-\mathbf{R}_{nuc}} \right |} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em r\+\_\+elec} & Electron position \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+nuc} & Nuclear position \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em H1s\+\_\+wfn} & Value of wavefunction \\
\hline
\end{DoxyRetVals}


Definition at line 114 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{115 }
\DoxyCodeLine{116         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_elec, R\_nuc}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \textcolor{keywordtype}{        real}(real64) :: H1s\_wfn, expfac}
\DoxyCodeLine{121 }
\DoxyCodeLine{122         expfac = -\/norm2(r\_elec -\/ r\_nuc)}
\DoxyCodeLine{123 }
\DoxyCodeLine{124         h1s\_wfn = pi\_dash * exp(expfac)}
\DoxyCodeLine{125 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a89943685e3d86544f0261f24fac44419}\label{namespacesolvers_a89943685e3d86544f0261f24fac44419}} 
\index{solvers@{solvers}!h2s\_wfn@{h2s\_wfn}}
\index{h2s\_wfn@{h2s\_wfn}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h2s\_wfn()}{h2s\_wfn()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h2s\+\_\+wfn (\begin{DoxyParamCaption}\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+elec,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+nuc }\end{DoxyParamCaption})}



Calculates value of the wavefunction of a hydrogen 2s orbital. 

Function to calculate the wavefunction of an electron at position $ \mathbf{r} $ in a hydrogenic 2s atomic orbital, centred on nuclear position $ \mathbf{R}_{nuc}. $ Computes \[ \psi^{A}_{2s} = \frac{1}{4\sqrt{2\pi}}\left [ 2 - \left |\mathbf{r-\mathbf{R}_{nuc}} \right | \right ] e^{-\frac{\left |\mathbf{r-\mathbf{R}_{nuc}} \right |}{2}} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em r\+\_\+elec} & Electron position \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+nuc} & Nuclear position \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em H2s\+\_\+wfn} & Value of wavefunction \\
\hline
\end{DoxyRetVals}


Definition at line 147 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{148 }
\DoxyCodeLine{149         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_elec, R\_nuc}
\DoxyCodeLine{152 }
\DoxyCodeLine{153 \textcolor{keywordtype}{        real}(real64) :: H2s\_wfn, prefac, expfac, r\_norm}
\DoxyCodeLine{154 }
\DoxyCodeLine{155         r\_norm = norm2(r\_elec -\/ r\_nuc)}
\DoxyCodeLine{156         prefac = pi\_dash\_2 * (2 -\/ r\_norm)}
\DoxyCodeLine{157         expfac = -\/(r\_norm / 2)}
\DoxyCodeLine{158 }
\DoxyCodeLine{159         h2s\_wfn = prefac * exp(expfac)}
\DoxyCodeLine{160 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a89943685e3d86544f0261f24fac44419_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a6d705d11696b64991f1624e298067bed}\label{namespacesolvers_a6d705d11696b64991f1624e298067bed}} 
\index{solvers@{solvers}!h\_2\_plus\_wfn@{h\_2\_plus\_wfn}}
\index{h\_2\_plus\_wfn@{h\_2\_plus\_wfn}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_plus\_wfn()}{h\_2\_plus\_wfn()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+plus\+\_\+wfn (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{c,  }\item[{real(real64), dimension(3), intent(in)}]{r,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b }\end{DoxyParamCaption})}



Calculates trial wavefunction for the $ H_{2}^{+} $ problem. 

Function to calculate the wavefunction of an electron at position $ \mathbf{r} $ in the hydrogen molecular ion $ H_{2}^{+} $. Depending on the value of variable {\itshape include\+\_\+pqn}, will either calculate \[ \psi^{c}_{T}(\mathbf{r}) = c\phi_{1s}^{A}(\mathbf{r}) + \sqrt{1-c^{2}}\phi_{1s}^{B}(\mathbf{r}) \] if {\itshape include\+\_\+pqn} in \mbox{\hyperlink{structshared__data_1_1h2plus__type}{H2plus }} is set to 1, or \[ \psi^{\mathbf{c}}_{T}(\mathbf{r}) = c_{1}\phi_{1s}^{A} + \sqrt{1-c_{1}^{2}}\phi_{1s}^{B} + c_{2}\phi_{2s}^{A} + \sqrt{1-c_{2}^{2}}\phi_{2s}^{B} \] if {\itshape include\+\_\+pqn} in \mbox{\hyperlink{structshared__data_1_1h2plus__type}{H2plus }} is set to 2. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r} & Electron position \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em wfn} & Value of trial wavefunction \\
\hline
\end{DoxyRetVals}


Definition at line 192 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{193 }
\DoxyCodeLine{194         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: c}
\DoxyCodeLine{197 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r}
\DoxyCodeLine{198 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{199 }
\DoxyCodeLine{200 \textcolor{keywordtype}{        real}(real64) :: wfn}
\DoxyCodeLine{201 }
\DoxyCodeLine{202         \textcolor{keywordflow}{if} (h2plus\%include\_pqn .eq. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{203             wfn = (c(1) * h1s\_wfn(r, r\_a)) + (sqrt(1 -\/ (c(1)*c(1))) * h1s\_wfn\textcolor{comment}{(r, r\_b))}}
\DoxyCodeLine{204 \textcolor{comment}{}        \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (h2plus\%include\_pqn .eq. 2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{205             wfn = (c(1) * h1s\_wfn(r, r\_a)) + (sqrt(1 -\/ (c(1)*c(1))) * h1s\_wfn\textcolor{comment}{(r, r\_b)) \&}}
\DoxyCodeLine{206 \textcolor{comment}{}                    + (c(2) * h2s\_wfn(r, r\_a)) + (sqrt(1 -\/ (c(2)*c(2))) \textcolor{comment}{* h2s\_wfn(r, r\_b))}}
\DoxyCodeLine{207 \textcolor{comment}{}        \textcolor{keywordflow}{else}}
\DoxyCodeLine{208             error stop \textcolor{stringliteral}{'Global include\_pqn can only take values 1 or 2.'}}
\DoxyCodeLine{209 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{210 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{namespacesolvers_a6d705d11696b64991f1624e298067bed_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a6d705d11696b64991f1624e298067bed_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a5695d107239a7a8fb1f8b096786af028}\label{namespacesolvers_a5695d107239a7a8fb1f8b096786af028}} 
\index{solvers@{solvers}!h\_2\_plus\_prob@{h\_2\_plus\_prob}}
\index{h\_2\_plus\_prob@{h\_2\_plus\_prob}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_plus\_prob()}{h\_2\_plus\_prob()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+plus\+\_\+prob (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{c,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+current,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+next,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b }\end{DoxyParamCaption})}



Calculates transition probability for the $ H_{2}^{+} $ problem. 

Function to calculate transition probability for walkers in the $ H_{2}^{+} $ problem. Computes \[ \frac{P(x_{i+1})}{P(x)} = \frac{\psi^{c}_{T}(\mathbf{r}_{i+1})}{\psi^{c}_{T}(\mathbf{r})} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+current} & Current position of walker \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+next} & Proposed position of walker \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em Prob} & Transition probability \\
\hline
\end{DoxyRetVals}


Definition at line 233 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{234 }
\DoxyCodeLine{235         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{236 }
\DoxyCodeLine{237 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: c}
\DoxyCodeLine{238 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_current, r\_next}
\DoxyCodeLine{239 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{240 }
\DoxyCodeLine{241 \textcolor{keywordtype}{        real}(real64) :: Prob}
\DoxyCodeLine{242 }
\DoxyCodeLine{243         prob = h\_2\_plus\_wfn(c, r\_next, r\_a, r\_b) / h\_2\_plus\_wfn(c, r\_current\textcolor{comment}{, r\_a, r\_b)}}
\DoxyCodeLine{244 \textcolor{comment}{}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a5695d107239a7a8fb1f8b096786af028_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a5695d107239a7a8fb1f8b096786af028_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f}\label{namespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f}} 
\index{solvers@{solvers}!h\_2\_plus\_energy@{h\_2\_plus\_energy}}
\index{h\_2\_plus\_energy@{h\_2\_plus\_energy}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_plus\_energy()}{h\_2\_plus\_energy()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+plus\+\_\+energy (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{c,  }\item[{real(real64), dimension(3), intent(in)}]{r,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b,  }\item[{real(real64), optional}]{fdstep }\end{DoxyParamCaption})}



Calculates local energy for the $ H_{2}^{+} $ problem. 

Function to calculate the local energy of a walker in the $ H_{2}^{+} $ problem. Computes \[ E^{c}_{L}(\mathbf{r}) = \frac{\hat{H}\psi^{c}_{T}(\mathbf{r})}{\psi^{c}_{T}(\mathbf{r})} \] where \[ \hat{H} = -\frac{1}{2}\nabla^{2} - \frac{1}{\left | \mathbf{r}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}-\mathbf{R}_{B} \right |} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r} & Position of walker \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\mbox{\texttt{ in}}  & {\em fdstep} & Finite difference step size (optional, default = 1e-\/3 Bohr) \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em E\+\_\+loc} & Local energy \\
\hline
\end{DoxyRetVals}


Definition at line 271 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{272 }
\DoxyCodeLine{273         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{274 }
\DoxyCodeLine{275 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: c}
\DoxyCodeLine{276 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r}
\DoxyCodeLine{277 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{278 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{optional} :: fdstep}
\DoxyCodeLine{279 }
\DoxyCodeLine{280 \textcolor{keywordtype}{        real}(real64) :: step                    \textcolor{comment}{! Auxiliary variable for defaulting}}
\DoxyCodeLine{281 \textcolor{keywordtype}{        real}(real64) :: laplacian               \textcolor{comment}{! 2nd derivative of trial wavefunction}}
\DoxyCodeLine{282 \textcolor{keywordtype}{        real}(real64) :: coulomb                 \textcolor{comment}{! Coulomb terms of Hamiltonian}}
\DoxyCodeLine{283 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)} :: r\_temp}
\DoxyCodeLine{284 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(2, 3)} :: diffs  \textcolor{comment}{! Wavefunction finite differences}}
\DoxyCodeLine{285 \textcolor{keywordtype}{        real}(real64) :: wfn, wfnx2              \textcolor{comment}{! Wavefunction at walker position}}
\DoxyCodeLine{286         \textcolor{keywordtype}{integer} :: i}
\DoxyCodeLine{287 }
\DoxyCodeLine{288 \textcolor{keywordtype}{        real}(real64) :: E\_loc}
\DoxyCodeLine{289 }
\DoxyCodeLine{290         \textcolor{comment}{! Allow the finite difference step size to take a default value.}}
\DoxyCodeLine{291         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(fdstep)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{292             step = fdstep}
\DoxyCodeLine{293         \textcolor{keywordflow}{else}}
\DoxyCodeLine{294             step = 1e-\/3\_real64}
\DoxyCodeLine{295 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{296 }
\DoxyCodeLine{297         \textcolor{comment}{! Calculate trial wavefunction at provided point.}}
\DoxyCodeLine{298         wfn = h\_2\_plus\_wfn(c, r, r\_a, r\_b)}
\DoxyCodeLine{299         wfnx2 = 2 * wfn}
\DoxyCodeLine{300 }
\DoxyCodeLine{301         \textcolor{comment}{! Calculate trial wavefunction in finite difference directions.}}
\DoxyCodeLine{302         \textcolor{keywordflow}{do} i = 1, 3}
\DoxyCodeLine{303             r\_temp(:) = r(:)}
\DoxyCodeLine{304             r\_temp(i) = r(i) -\/ step}
\DoxyCodeLine{305             diffs(1, i) = h\_2\_plus\_wfn(c, r\_temp, r\_a, r\_b)}
\DoxyCodeLine{306 }
\DoxyCodeLine{307             r\_temp(i) = r(i) + step}
\DoxyCodeLine{308             diffs(2, i) = h\_2\_plus\_wfn(c, r\_temp, r\_a, r\_b)}
\DoxyCodeLine{309 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{310 }
\DoxyCodeLine{311         \textcolor{comment}{! Assemble Hamiltonian}}
\DoxyCodeLine{312         laplacian = ((diffs(1, 1) -\/ wfnx2 + diffs(2, 1)) + \&}
\DoxyCodeLine{313                      (diffs(1, 2) -\/ wfnx2 + diffs(2, 2)) + \&}
\DoxyCodeLine{314                      (diffs(1, 3) -\/ wfnx2 + diffs(2, 3))) / (step*step)}
\DoxyCodeLine{315         laplacian = laplacian * (-\/0.5\_real64)}
\DoxyCodeLine{316 }
\DoxyCodeLine{317         coulomb = -\/(1  / norm2(r -\/ r\_a))*wfn -\/ (1 / norm2(r -\/ r\_b))*wfn}
\DoxyCodeLine{318         }
\DoxyCodeLine{319         e\_loc = (laplacian + coulomb) / wfn}
\DoxyCodeLine{320         }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a1f21386928aadfc3dd6bc5cfb82fb94f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_aa0515876b10a8cebd7f381e14b1ff856}\label{namespacesolvers_aa0515876b10a8cebd7f381e14b1ff856}} 
\index{solvers@{solvers}!h\_2\_wfn@{h\_2\_wfn}}
\index{h\_2\_wfn@{h\_2\_wfn}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_wfn()}{h\_2\_wfn()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+wfn (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{c,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+1,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+2,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b }\end{DoxyParamCaption})}



Calculates trial wavefunction for the $ H_{2} $ problem. 

Function to calculate the wavefunction of two electrons at positions $ \mathbf{r}_{1} $ and $ \mathbf{r}_{2} $ in the hydrogen molecule $ H_{2} $. Depending on the value of variable {\itshape include\+\_\+pqn}, will either calculate \[ \psi^{c}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2}) = c \left ( \phi_{1s}^{A}(\mathbf{r}_{1})\phi_{1s}^{B}(\mathbf{r}_{2}) + \phi_{1s}^{A}(\mathbf{r}_{2})\phi_{1s}^{B}(\mathbf{r}_{1}) \right ) \] if {\itshape include\+\_\+pqn} in \mbox{\hyperlink{structshared__data_1_1h2__type}{H2 }} is set to 1, or \[ \psi^{\mathbf{c}}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2}) = c_{1} \left ( \phi_{1s}^{A}(\mathbf{r}_{1})\phi_{1s}^{B}(\mathbf{r}_{2}) + \phi_{1s}^{A}(\mathbf{r}_{2})\phi_{1s}^{B}(\mathbf{r}_{1}) \right ) + c_{2} \left ( \phi_{2s}^{A}(\mathbf{r}_{1})\phi_{2s}^{B}(\mathbf{r}_{2}) + \phi_{2s}^{A}(\mathbf{r}_{2})\phi_{2s}^{B}(\mathbf{r}_{1}) \right ) \] if {\itshape include\+\_\+pqn} in \mbox{\hyperlink{structshared__data_1_1h2__type}{H2 }} is set to 2. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+1} & Position of electron 1 \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+2} & Position of electron 2 \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em wfn} & Value of trial wavefunction \\
\hline
\end{DoxyRetVals}


Definition at line 357 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{358 }
\DoxyCodeLine{359         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{360 }
\DoxyCodeLine{361 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: c}
\DoxyCodeLine{362 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_1, r\_2}
\DoxyCodeLine{363 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{364 }
\DoxyCodeLine{365 \textcolor{keywordtype}{        real}(real64) :: wfn}
\DoxyCodeLine{366 }
\DoxyCodeLine{367         \textcolor{keywordflow}{if} (h2\%include\_pqn .eq. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{368             wfn = c(1) * ((h1s\_wfn(r\_1, r\_a) * h1s\_wfn(r\_2, r\_b)) \&}
\DoxyCodeLine{369                   + (h1s\_wfn(r\_2, r\_a) * h1s\_wfn(r\_1, r\_b)))}
\DoxyCodeLine{370         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (h2\%include\_pqn .eq. 2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{371             wfn = c(1) * ((h1s\_wfn(r\_1, r\_a) * h1s\_wfn(r\_2, r\_b)) \&}
\DoxyCodeLine{372                   + (h1s\_wfn(r\_2, r\_a) * h1s\_wfn(r\_1, r\_b))) + \& }
\DoxyCodeLine{373                   c(2) * ((h2s\_wfn(r\_1, r\_a) * h2s\_wfn(r\_2, r\_b)) \&}
\DoxyCodeLine{374                   + (h2s\_wfn(r\_2, r\_a) * h2s\_wfn(r\_1, r\_b)))}
\DoxyCodeLine{375         \textcolor{keywordflow}{else}}
\DoxyCodeLine{376             error stop \textcolor{stringliteral}{'Global include\_pqn can only take values 1 or 2.'}}
\DoxyCodeLine{377 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{378 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=294pt]{namespacesolvers_aa0515876b10a8cebd7f381e14b1ff856_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_aa0515876b10a8cebd7f381e14b1ff856_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a0d0f254ede019bb0bf743397cd0069f7}\label{namespacesolvers_a0d0f254ede019bb0bf743397cd0069f7}} 
\index{solvers@{solvers}!h\_2\_prob@{h\_2\_prob}}
\index{h\_2\_prob@{h\_2\_prob}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_prob()}{h\_2\_prob()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+prob (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{c,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+1\+\_\+current,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+2\+\_\+current,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+1\+\_\+next,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+2\+\_\+next,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b }\end{DoxyParamCaption})}



Calculates transition probability for the $ H_{2} $ problem. 

Function to calculate transition probability for walkers in the $ H_{2} $ problem. Computes \[ \frac{P(x_{i+1})}{P(x)} = \frac{\psi^{c}_{T}(\mathbf{r}_{1}^{i+1}, \mathbf{r}_{2}^{i+1})} {\psi^{c}_{T}(\mathbf{r}_{1}^{i}, \mathbf{r}_{2}^{i})} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+1\+\_\+current} & Current position of walker 1 \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+2\+\_\+current} & Current position of walker 2 \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+1\+\_\+next} & Proposed position of walker 1 \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+2\+\_\+next} & Proposed position of walker 2 \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em Prob} & Transition probability \\
\hline
\end{DoxyRetVals}


Definition at line 404 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{406 }
\DoxyCodeLine{407         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{408 }
\DoxyCodeLine{409 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: c}
\DoxyCodeLine{410 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_1\_current, r\_2\_current}
\DoxyCodeLine{411 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_1\_next, r\_2\_next}
\DoxyCodeLine{412 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{413 }
\DoxyCodeLine{414 \textcolor{keywordtype}{        real}(real64) :: Prob}
\DoxyCodeLine{415 }
\DoxyCodeLine{416         prob = h\_2\_wfn(c, r\_1\_next, r\_2\_next, r\_a, r\_b) / \&}
\DoxyCodeLine{417                h\_2\_wfn(c, r\_1\_current, r\_2\_current, r\_a, r\_b)}
\DoxyCodeLine{418 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a0d0f254ede019bb0bf743397cd0069f7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a0d0f254ede019bb0bf743397cd0069f7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f}\label{namespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f}} 
\index{solvers@{solvers}!h\_2\_energy@{h\_2\_energy}}
\index{h\_2\_energy@{h\_2\_energy}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_energy()}{h\_2\_energy()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+energy (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{c,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+1,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+2,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b,  }\item[{real(real64), optional}]{fdstep }\end{DoxyParamCaption})}



Calculates local energy for the $ H_{2} $ problem. 

Function to calculate the local energy of two walkers in the $ H_{2} $ problem. Computes \[ E^{c}_{L}(\mathbf{r}_{1}, \mathbf{r}_{2}) = \frac{\hat{H}\psi^{c}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2})} {\psi^{c}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2})} \] where \[ \hat{H} = -\frac{1}{2}\nabla^{2} - \frac{1}{\left | \mathbf{r}_{1}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}_{1}-\mathbf{R}_{B} \right |} - \frac{1}{\left | \mathbf{r}_{2}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}_{2}-\mathbf{R}_{B} \right |} + \frac{1}{\left | \mathbf{r}_{1}-\mathbf{r}_{2} \right |} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+1} & Position of walker 1 \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+2} & Position of walker 2 \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\mbox{\texttt{ in}}  & {\em fdstep} & Finite difference step size (optional, default = 1e-\/3 Bohr) \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em E\+\_\+loc} & Local energy \\
\hline
\end{DoxyRetVals}


Definition at line 450 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{451 }
\DoxyCodeLine{452         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{453 }
\DoxyCodeLine{454 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: c}
\DoxyCodeLine{455 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_1, r\_2}
\DoxyCodeLine{456 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{457 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{optional} :: fdstep}
\DoxyCodeLine{458 }
\DoxyCodeLine{459 \textcolor{keywordtype}{        real}(real64) :: step                                \textcolor{comment}{! Auxiliary variable for defaulting}}
\DoxyCodeLine{460 \textcolor{keywordtype}{        real}(real64) :: laplacian                           \textcolor{comment}{! 2nd derivative of trial wavefunction}}
\DoxyCodeLine{461 \textcolor{keywordtype}{        real}(real64) :: coulomb                             \textcolor{comment}{! Coulomb terms of Hamiltonian}}
\DoxyCodeLine{462 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)} :: r\_1\_temp, r\_2\_temp}
\DoxyCodeLine{463 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(2, 3)} :: diffs\_1, diffs\_2   \textcolor{comment}{! Wavefunction finite differences}}
\DoxyCodeLine{464 \textcolor{keywordtype}{        real}(real64) :: wfn, wfnx2                          \textcolor{comment}{! Wavefunction at walker positions}}
\DoxyCodeLine{465         \textcolor{keywordtype}{integer} :: backdiff, forwdiff}
\DoxyCodeLine{466         \textcolor{keywordtype}{integer} :: i}
\DoxyCodeLine{467 }
\DoxyCodeLine{468 \textcolor{keywordtype}{        real}(real64) :: E\_loc}
\DoxyCodeLine{469 }
\DoxyCodeLine{470         \textcolor{comment}{! Allow the finite difference step size to take a default value.}}
\DoxyCodeLine{471         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(fdstep)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{472             step = fdstep}
\DoxyCodeLine{473         \textcolor{keywordflow}{else}}
\DoxyCodeLine{474             step = 1e-\/3\_real64}
\DoxyCodeLine{475 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{476 }
\DoxyCodeLine{477         \textcolor{comment}{! Calculate trial wavefunction at provided walker positions.}}
\DoxyCodeLine{478         wfn = h\_2\_wfn(c, r\_1, r\_2, r\_a, r\_b)}
\DoxyCodeLine{479         wfnx2 = 2 * wfn \textcolor{comment}{! Reduce unneccessary multiplication}}
\DoxyCodeLine{480 }
\DoxyCodeLine{481         backdiff = 1}
\DoxyCodeLine{482         forwdiff = 2}
\DoxyCodeLine{483         \textcolor{comment}{! Calculate trial wavefunction in finite difference directions.}}
\DoxyCodeLine{484         \textcolor{keywordflow}{do} i = 1, 3}
\DoxyCodeLine{485             r\_1\_temp = r\_1}
\DoxyCodeLine{486             r\_2\_temp = r\_2}
\DoxyCodeLine{487             r\_1\_temp(i) = r\_1(i) -\/ step}
\DoxyCodeLine{488             r\_2\_temp(i) = r\_2(i) -\/ step}
\DoxyCodeLine{489             diffs\_1(backdiff, i) = h\_2\_wfn(c, r\_1\_temp, r\_2, r\_a, r\_b)}
\DoxyCodeLine{490             diffs\_2(backdiff, i) = h\_2\_wfn(c, r\_1, r\_2\_temp, r\_a, r\_b)}
\DoxyCodeLine{491 }
\DoxyCodeLine{492             r\_1\_temp(i) = r\_1(i) + step}
\DoxyCodeLine{493             r\_2\_temp(i) = r\_2(i) + step}
\DoxyCodeLine{494             diffs\_1(forwdiff, i) = h\_2\_wfn(c, r\_1\_temp, r\_2, r\_a, r\_b)}
\DoxyCodeLine{495             diffs\_2(forwdiff, i) = h\_2\_wfn(c, r\_1, r\_2\_temp, r\_a, r\_b)}
\DoxyCodeLine{496 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{497 }
\DoxyCodeLine{498         \textcolor{comment}{! Assemble Hamiltonian.}}
\DoxyCodeLine{499         laplacian = (((diffs\_1(backdiff, 1) -\/ wfnx2 + diffs\_1(forwdiff, \textcolor{comment}{1)) + \&}}
\DoxyCodeLine{500 \textcolor{comment}{}                      (diffs\_1(backdiff, 2) -\/ wfnx2 + diffs\_1(forwdiff, \textcolor{comment}{2)) + \&}}
\DoxyCodeLine{501 \textcolor{comment}{}                      (diffs\_1(backdiff, 3) -\/ wfnx2 + diffs\_1(forwdiff, \textcolor{comment}{3))) + \&}}
\DoxyCodeLine{502 \textcolor{comment}{}                     ((diffs\_2(backdiff, 1) -\/ wfnx2 + diffs\_2(forwdiff, \textcolor{comment}{1)) + \&}}
\DoxyCodeLine{503 \textcolor{comment}{}                      (diffs\_2(backdiff, 2) -\/ wfnx2 + diffs\_2(forwdiff, \textcolor{comment}{2)) + \&}}
\DoxyCodeLine{504 \textcolor{comment}{}                      (diffs\_2(backdiff, 3) -\/ wfnx2 + diffs\_2(forwdiff, \textcolor{comment}{3)))) \&}}
\DoxyCodeLine{505 \textcolor{comment}{}                    / (step*step)}
\DoxyCodeLine{506         laplacian = laplacian * (-\/0.5\_real64)}
\DoxyCodeLine{507 }
\DoxyCodeLine{508         coulomb = (-\/ (1 / norm2(r\_1 -\/ r\_a)) -\/ (1 / norm2(r\_1 -\/ r\_b)) \&}
\DoxyCodeLine{509                    -\/ (1 / norm2(r\_2 -\/ r\_a)) -\/ (1 / norm2(r\_2 -\/ r\_b)) \&}
\DoxyCodeLine{510                    + (1 / norm2(r\_1 -\/ r\_2))) * wfn}
\DoxyCodeLine{511         }
\DoxyCodeLine{512         e\_loc = (laplacian + coulomb) / wfn}
\DoxyCodeLine{513         }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_ab21b7ec07e33a8417b62ecb75c327a6f_icgraph}
\end{center}
\end{figure}
