\hypertarget{namespacesolvers}{}\doxysection{solvers Module Reference}
\label{namespacesolvers}\index{solvers@{solvers}}


Contains local energy and transition probability solvers for available problems.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a722edf182d188ad1db7fa6a675fea13c}{qho\+\_\+prob}} (alpha, x\+\_\+current, x\+\_\+next)
\begin{DoxyCompactList}\small\item\em Calculates transition probability for quantum harmonic oscillator problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52}{qho\+\_\+energy}} (alpha, x)
\begin{DoxyCompactList}\small\item\em Calculates local energy for quantum harmonic oscillator problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7}{h1s\+\_\+wfn}} (r\+\_\+elec, R\+\_\+nuc)
\begin{DoxyCompactList}\small\item\em Calculates value of the wavefunction of a hydrogen 1s orbital. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a89943685e3d86544f0261f24fac44419}{h2s\+\_\+wfn}} (r\+\_\+elec, R\+\_\+nuc)
\begin{DoxyCompactList}\small\item\em Calculates value of the wavefunction of a hydrogen 2s orbital. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a6d705d11696b64991f1624e298067bed}{h\+\_\+2\+\_\+plus\+\_\+wfn}} (c, r, R\+\_\+a, R\+\_\+b)
\begin{DoxyCompactList}\small\item\em Calculates trial wavefunction for the $ H_{2}^{+} $ problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a5695d107239a7a8fb1f8b096786af028}{h\+\_\+2\+\_\+plus\+\_\+prob}} (c, r\+\_\+current, r\+\_\+next, R\+\_\+a, R\+\_\+b)
\begin{DoxyCompactList}\small\item\em Calculates transition probability for the $ H_{2}^{+} $ problem. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f}{h\+\_\+2\+\_\+plus\+\_\+energy}} (c, r, R\+\_\+a, R\+\_\+b, E\+\_\+loc, gradient)
\begin{DoxyCompactList}\small\item\em Calculates local energy for the $ H_{2}^{+} $ problem. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolvers_acb91c2bfc7ae441b3e24f83d0f49d55a}{h\+\_\+2\+\_\+plus\+\_\+update\+\_\+c}} (c\+\_\+old, gradient, c\+\_\+new)
\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_a38259c21a02a250a91f45d79e4165742}{h\+\_\+2\+\_\+cusp}} (s)
\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_ac603f31a67286a6e89588cf4de29bd1b}{h\+\_\+2\+\_\+wfn}} (a, beta, r\+\_\+1, r\+\_\+2, R\+\_\+a, R\+\_\+b)
\begin{DoxyCompactList}\small\item\em \{UPDATE ME\} Calculates trial wavefunction for the $ H_{2} $ problem. \end{DoxyCompactList}\item 
real(real64) function \mbox{\hyperlink{namespacesolvers_ac30d1c7141f673647e837524ecb26b07}{h\+\_\+2\+\_\+prob}} (a, beta, r\+\_\+1\+\_\+current, r\+\_\+2\+\_\+current, r\+\_\+1\+\_\+next, r\+\_\+2\+\_\+next, R\+\_\+a, R\+\_\+b)
\begin{DoxyCompactList}\small\item\em Calculates transition probability for the $ H_{2} $ problem. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolvers_a9afbcdcc0405d544d4441e9786f440a2}{h\+\_\+2\+\_\+energy}} (a, beta, r\+\_\+1, r\+\_\+2, R\+\_\+a, R\+\_\+b, E\+\_\+loc, Dphi\+Dbeta)
\begin{DoxyCompactList}\small\item\em Calculates local energy for the $ H_{2} $ problem. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolvers_a4b4d370a4ee50b231f53058ab62e4084}{h\+\_\+2\+\_\+update\+\_\+beta}} (beta\+\_\+old, gradient, beta\+\_\+new)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains local energy and transition probability solvers for available problems. 

Module containing quantum mechanical solvers for local energy and Metropolis algorithm probability. Contains solvers for quantum harmonic oscillator (QHO), hydrogen ion (H\+\_\+2\+\_\+plus) and hydrogen molecule (H\+\_\+2). Solvers can be linked to a function pointer by the input parsing module, depending on the problem specified by the input. This way, the main code and the VQMC algorithm can be made (mostly) independent of problem choice. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacesolvers_a722edf182d188ad1db7fa6a675fea13c}\label{namespacesolvers_a722edf182d188ad1db7fa6a675fea13c}} 
\index{solvers@{solvers}!qho\_prob@{qho\_prob}}
\index{qho\_prob@{qho\_prob}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{qho\_prob()}{qho\_prob()}}
{\footnotesize\ttfamily real(real64) function solvers\+::qho\+\_\+prob (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{alpha,  }\item[{real(real64), intent(in)}]{x\+\_\+current,  }\item[{real(real64), intent(in)}]{x\+\_\+next }\end{DoxyParamCaption})}



Calculates transition probability for quantum harmonic oscillator problem. 

Computes \[ \frac{P(x_{i+1})}{P(x)} = \frac{\psi^{\alpha}_{T}(x_{i+1})}{\psi^{\alpha}_{T}(x)} = e^{-2\alpha(x^{2}_{i+1}-x^{2}_{i})} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em alpha} & Parameter \\
\hline
\mbox{\texttt{ in}}  & {\em x\+\_\+current} & Current position of walker \\
\hline
\mbox{\texttt{ in}}  & {\em x\+\_\+next} & Proposed position of walker \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em Prob} & Transition probability \\
\hline
\end{DoxyRetVals}


Definition at line 50 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{51 }
\DoxyCodeLine{52         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: alpha}
\DoxyCodeLine{55 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: x\_current, x\_next}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{keywordtype}{        real}(real64) :: Prob}
\DoxyCodeLine{58 }
\DoxyCodeLine{59         prob = exp(-\/2*alpha*(x\_next*x\_next -\/ x\_current*x\_current))}
\DoxyCodeLine{60 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a722edf182d188ad1db7fa6a675fea13c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52}\label{namespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52}} 
\index{solvers@{solvers}!qho\_energy@{qho\_energy}}
\index{qho\_energy@{qho\_energy}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{qho\_energy()}{qho\_energy()}}
{\footnotesize\ttfamily real(real64) function solvers\+::qho\+\_\+energy (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{alpha,  }\item[{real(real64), intent(in)}]{x }\end{DoxyParamCaption})}



Calculates local energy for quantum harmonic oscillator problem. 

Computes \[ E^{\alpha}_{L}(x) = \frac{\hat{H}\psi^{\alpha}_{T}(x)}{\psi^{\alpha}_{T}(x)} = \alpha+x^{2}\left ( \frac{1}{2}-2\alpha^{2} \right ) \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em alpha} & Parameter \\
\hline
\mbox{\texttt{ in}}  & {\em x} & Position of walker \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em E\+\_\+loc} & Local energy \\
\hline
\end{DoxyRetVals}


Definition at line 79 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{80 }
\DoxyCodeLine{81         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: alpha}
\DoxyCodeLine{84 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: x}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 \textcolor{keywordtype}{        real}(real64) :: E\_loc}
\DoxyCodeLine{87 }
\DoxyCodeLine{88         e\_loc = alpha + (x*x)*(0.5 -\/ (2*alpha*alpha))}
\DoxyCodeLine{89 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7}\label{namespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7}} 
\index{solvers@{solvers}!h1s\_wfn@{h1s\_wfn}}
\index{h1s\_wfn@{h1s\_wfn}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h1s\_wfn()}{h1s\_wfn()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h1s\+\_\+wfn (\begin{DoxyParamCaption}\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+elec,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+nuc }\end{DoxyParamCaption})}



Calculates value of the wavefunction of a hydrogen 1s orbital. 

Function to calculate the wavefunction of an electron at position $ \mathbf{r} $ in a hydrogenic 1s atomic orbital, centred on nuclear position $ \mathbf{R}_{nuc}. $ Computes \[ \phi_{1s}^{A}(\mathbf{r}) = \frac{1}{\sqrt{\pi}}e^{-\left |\mathbf{r-\mathbf{R}_{nuc}} \right |} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em r\+\_\+elec} & Electron position \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+nuc} & Nuclear position \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em H1s\+\_\+wfn} & Value of wavefunction \\
\hline
\end{DoxyRetVals}


Definition at line 114 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{115 }
\DoxyCodeLine{116         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{117 }
\DoxyCodeLine{118 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_elec, R\_nuc}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \textcolor{keywordtype}{        real}(real64) :: H1s\_wfn, expfac}
\DoxyCodeLine{121 }
\DoxyCodeLine{122         expfac = -\/norm2(r\_elec -\/ r\_nuc)}
\DoxyCodeLine{123 }
\DoxyCodeLine{124         h1s\_wfn = pi\_dash * exp(expfac)}
\DoxyCodeLine{125 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a89943685e3d86544f0261f24fac44419}\label{namespacesolvers_a89943685e3d86544f0261f24fac44419}} 
\index{solvers@{solvers}!h2s\_wfn@{h2s\_wfn}}
\index{h2s\_wfn@{h2s\_wfn}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h2s\_wfn()}{h2s\_wfn()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h2s\+\_\+wfn (\begin{DoxyParamCaption}\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+elec,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+nuc }\end{DoxyParamCaption})}



Calculates value of the wavefunction of a hydrogen 2s orbital. 

Function to calculate the wavefunction of an electron at position $ \mathbf{r} $ in a hydrogenic 2s atomic orbital, centred on nuclear position $ \mathbf{R}_{nuc}. $ Computes \[ \psi^{A}_{2s} = \frac{1}{4\sqrt{2\pi}}\left [ 2 - \left |\mathbf{r-\mathbf{R}_{nuc}} \right | \right ] e^{-\frac{\left |\mathbf{r-\mathbf{R}_{nuc}} \right |}{2}} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em r\+\_\+elec} & Electron position \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+nuc} & Nuclear position \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em H2s\+\_\+wfn} & Value of wavefunction \\
\hline
\end{DoxyRetVals}


Definition at line 147 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{148 }
\DoxyCodeLine{149         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_elec, R\_nuc}
\DoxyCodeLine{152 }
\DoxyCodeLine{153 \textcolor{keywordtype}{        real}(real64) :: H2s\_wfn, prefac, expfac, r\_norm}
\DoxyCodeLine{154 }
\DoxyCodeLine{155         r\_norm = norm2(r\_elec -\/ r\_nuc)}
\DoxyCodeLine{156         prefac = pi\_dash\_2 * (2 -\/ r\_norm)}
\DoxyCodeLine{157         expfac = -\/(r\_norm / 2)}
\DoxyCodeLine{158 }
\DoxyCodeLine{159         h2s\_wfn = prefac * exp(expfac)}
\DoxyCodeLine{160 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a89943685e3d86544f0261f24fac44419_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a6d705d11696b64991f1624e298067bed}\label{namespacesolvers_a6d705d11696b64991f1624e298067bed}} 
\index{solvers@{solvers}!h\_2\_plus\_wfn@{h\_2\_plus\_wfn}}
\index{h\_2\_plus\_wfn@{h\_2\_plus\_wfn}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_plus\_wfn()}{h\_2\_plus\_wfn()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+plus\+\_\+wfn (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{c,  }\item[{real(real64), dimension(3), intent(in)}]{r,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b }\end{DoxyParamCaption})}



Calculates trial wavefunction for the $ H_{2}^{+} $ problem. 

Function to calculate the wavefunction of an electron at position $ \mathbf{r} $ in the hydrogen molecular ion $ H_{2}^{+} $. Depending on the value of variable {\itshape include\+\_\+pqn}, will either calculate \[ \psi^{c}_{T}(\mathbf{r}) = c\phi_{1s}^{A}(\mathbf{r}) + \sqrt{1-c^{2}}\phi_{1s}^{B}(\mathbf{r}) \] if {\itshape include\+\_\+pqn} in \mbox{\hyperlink{structshared__data_1_1h2plus__type}{H2plus }} is set to 1, or \[ \psi^{\mathbf{c}}_{T}(\mathbf{r}) = c_{1}\phi_{1s}^{A} + \sqrt{1-c_{1}^{2}}\phi_{1s}^{B} + c_{2}\phi_{2s}^{A} + \sqrt{1-c_{2}^{2}}\phi_{2s}^{B} \] if {\itshape include\+\_\+pqn} in \mbox{\hyperlink{structshared__data_1_1h2plus__type}{H2plus }} is set to 2. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r} & Electron position \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em wfn} & Value of trial wavefunction \\
\hline
\end{DoxyRetVals}


Definition at line 192 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{193 }
\DoxyCodeLine{194         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: c}
\DoxyCodeLine{197 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r}
\DoxyCodeLine{198 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{199 }
\DoxyCodeLine{200 \textcolor{keywordtype}{        real}(real64) :: bond\_dist, overlap\_fac, wfn}
\DoxyCodeLine{201 }
\DoxyCodeLine{202         \textcolor{comment}{! wfn = c * (H1s\_wfn(r, R\_a) + H1s\_wfn(r, R\_b))}}
\DoxyCodeLine{203         \textcolor{comment}{! wfn = c * (H1s\_wfn(r, R\_a) -\/ H1s\_wfn(r, R\_b))}}
\DoxyCodeLine{204         \textcolor{comment}{! wfn = r2o2 * (H1s\_wfn\_mod(c, r, R\_a) + H1s\_wfn\_mod(c, r, R\_b))}}
\DoxyCodeLine{205         bond\_dist = norm2(r\_a -\/ r\_b)}
\DoxyCodeLine{206         \textcolor{comment}{!overlap = exp(-\/bond\_dist) * (1.0\_real64 + bond\_dist + (1.0\_real64 / 3.0\_real64)*bond\_dist*bond\_dist)}}
\DoxyCodeLine{207         overlap\_fac = 1.0\_real64 / sqrt(2 * (1.0\_real64 + c)) \textcolor{comment}{! here, c takes the place of the overlap integral}}
\DoxyCodeLine{208         wfn = overlap\_fac * (h1s\_wfn(r, r\_a) + h1s\_wfn(r, r\_b))}
\DoxyCodeLine{209 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{namespacesolvers_a6d705d11696b64991f1624e298067bed_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a6d705d11696b64991f1624e298067bed_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a5695d107239a7a8fb1f8b096786af028}\label{namespacesolvers_a5695d107239a7a8fb1f8b096786af028}} 
\index{solvers@{solvers}!h\_2\_plus\_prob@{h\_2\_plus\_prob}}
\index{h\_2\_plus\_prob@{h\_2\_plus\_prob}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_plus\_prob()}{h\_2\_plus\_prob()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+plus\+\_\+prob (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{c,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+current,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+next,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b }\end{DoxyParamCaption})}



Calculates transition probability for the $ H_{2}^{+} $ problem. 

Function to calculate transition probability for walkers in the $ H_{2}^{+} $ problem. Computes \[ \frac{P(x_{i+1})}{P(x)} = \frac{\psi^{c}_{T}(\mathbf{r}_{i+1})}{\psi^{c}_{T}(\mathbf{r})} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+current} & Current position of walker \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+next} & Proposed position of walker \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em Prob} & Transition probability \\
\hline
\end{DoxyRetVals}


Definition at line 232 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{233 }
\DoxyCodeLine{234         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{235 }
\DoxyCodeLine{236 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: c}
\DoxyCodeLine{237 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_current, r\_next}
\DoxyCodeLine{238 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{239 }
\DoxyCodeLine{240 \textcolor{keywordtype}{        real}(real64) :: Prob}
\DoxyCodeLine{241 }
\DoxyCodeLine{242         prob = abs(h\_2\_plus\_wfn(c, r\_next, r\_a, r\_b) / \&}
\DoxyCodeLine{243             h\_2\_plus\_wfn(c, r\_current, r\_a, r\_b))**2}
\DoxyCodeLine{244 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a5695d107239a7a8fb1f8b096786af028_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a5695d107239a7a8fb1f8b096786af028_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f}\label{namespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f}} 
\index{solvers@{solvers}!h\_2\_plus\_energy@{h\_2\_plus\_energy}}
\index{h\_2\_plus\_energy@{h\_2\_plus\_energy}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_plus\_energy()}{h\_2\_plus\_energy()}}
{\footnotesize\ttfamily subroutine solvers\+::h\+\_\+2\+\_\+plus\+\_\+energy (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{c,  }\item[{real(real64), dimension(3), intent(in)}]{r,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b,  }\item[{real(real64), intent(out)}]{E\+\_\+loc,  }\item[{real(real64), intent(out)}]{gradient }\end{DoxyParamCaption})}



Calculates local energy for the $ H_{2}^{+} $ problem. 

Function to calculate the local energy of a walker in the $ H_{2}^{+} $ problem. Computes \[ E^{c}_{L}(\mathbf{r}) = \frac{\hat{H}\psi^{c}_{T}(\mathbf{r})}{\psi^{c}_{T}(\mathbf{r})} \] where \[ \hat{H} = -\frac{1}{2}\nabla^{2} - \frac{1}{\left | \mathbf{r}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}-\mathbf{R}_{B} \right |} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r} & Position of walker \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\mbox{\texttt{ in}}  & {\em fdstep} & Finite difference step size (optional, default = 1e-\/3 Bohr) \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em E\+\_\+loc} & Local energy \\
\hline
\end{DoxyRetVals}


Definition at line 271 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{272 }
\DoxyCodeLine{273         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{274 }
\DoxyCodeLine{275 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: c}
\DoxyCodeLine{276 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r}
\DoxyCodeLine{277 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{278 }
\DoxyCodeLine{279 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: E\_loc}
\DoxyCodeLine{280 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: gradient}
\DoxyCodeLine{281   }
\DoxyCodeLine{282 \textcolor{keywordtype}{        real}(real64) :: laplacian               \textcolor{comment}{! 2nd derivative of trial wavefunction}}
\DoxyCodeLine{283 \textcolor{keywordtype}{        real}(real64) :: coulomb                 \textcolor{comment}{! Coulomb terms of Hamiltonian}}
\DoxyCodeLine{284 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)} :: r\_temp}
\DoxyCodeLine{285 \textcolor{keywordtype}{        real}(real64) :: c\_temp}
\DoxyCodeLine{286 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(2, 3)} :: r\_diffs  \textcolor{comment}{! Wavefunction finite differences}}
\DoxyCodeLine{287 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(2)} :: c\_diffs}
\DoxyCodeLine{288 \textcolor{keywordtype}{        real}(real64) :: wfn, wfnx2              \textcolor{comment}{! Wavefunction at walker position}}
\DoxyCodeLine{289         \textcolor{keywordtype}{integer} :: i}
\DoxyCodeLine{290 }
\DoxyCodeLine{291         \textcolor{comment}{! Calculate trial wavefunction at provided point.}}
\DoxyCodeLine{292         wfn = h\_2\_plus\_wfn(c, r, r\_a, r\_b)}
\DoxyCodeLine{293         wfnx2 = 2 * wfn}
\DoxyCodeLine{294 }
\DoxyCodeLine{295         \textcolor{comment}{! Calculate trial wavefunction in finite difference directions.}}
\DoxyCodeLine{296         \textcolor{keywordflow}{do} i = 1, 3}
\DoxyCodeLine{297             r\_temp(:) = r(:)}
\DoxyCodeLine{298             r\_temp(i) = r(i) -\/ h2plus\%ham\_fdstep}
\DoxyCodeLine{299             r\_diffs(1, i) = h\_2\_plus\_wfn(c, r\_temp, r\_a, r\_b)}
\DoxyCodeLine{300 }
\DoxyCodeLine{301             r\_temp(i) = r(i) + h2plus\%ham\_fdstep}
\DoxyCodeLine{302             r\_diffs(2, i) = h\_2\_plus\_wfn(c, r\_temp, r\_a, r\_b)}
\DoxyCodeLine{303 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{304 }
\DoxyCodeLine{305         \textcolor{comment}{! Assemble Hamiltonian}}
\DoxyCodeLine{306         laplacian = ((r\_diffs(1, 1) -\/ wfnx2 + r\_diffs(2, 1)) + \&}
\DoxyCodeLine{307                      (r\_diffs(1, 2) -\/ wfnx2 + r\_diffs(2, 2)) + \&}
\DoxyCodeLine{308                      (r\_diffs(1, 3) -\/ wfnx2 + r\_diffs(2, 3))) / (h2plus\%ham\_fdstep\textcolor{comment}{**2)}}
\DoxyCodeLine{309 \textcolor{comment}{}        laplacian = laplacian * (-\/0.5\_real64)}
\DoxyCodeLine{310 }
\DoxyCodeLine{311         coulomb = -\/(1  / norm2(r -\/ r\_a))*wfn -\/ (1 / norm2(r -\/ r\_b))*wfn}
\DoxyCodeLine{312         }
\DoxyCodeLine{313         e\_loc = ((laplacian + coulomb) / wfn) + (1 / norm2(r\_a -\/ r\_b))}
\DoxyCodeLine{314 }
\DoxyCodeLine{315         \textcolor{comment}{! Calculate wavefunction gradient wrt c}}
\DoxyCodeLine{316         c\_temp = c -\/ h2plus\%c\_fdstep}
\DoxyCodeLine{317         c\_diffs(1) = h\_2\_plus\_wfn(c\_temp, r, r\_a, r\_b)}
\DoxyCodeLine{318 }
\DoxyCodeLine{319         c\_temp = c + h2plus\%c\_fdstep}
\DoxyCodeLine{320         c\_diffs(2) = h\_2\_plus\_wfn(c\_temp, r, r\_a, r\_b)}
\DoxyCodeLine{321 }
\DoxyCodeLine{322         gradient = (c\_diffs(2) -\/ c\_diffs(1)) / (2.0\_real64 * h2plus\%c\_fdstep\textcolor{comment}{)}}
\DoxyCodeLine{323 \textcolor{comment}{}        }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_acb91c2bfc7ae441b3e24f83d0f49d55a}\label{namespacesolvers_acb91c2bfc7ae441b3e24f83d0f49d55a}} 
\index{solvers@{solvers}!h\_2\_plus\_update\_c@{h\_2\_plus\_update\_c}}
\index{h\_2\_plus\_update\_c@{h\_2\_plus\_update\_c}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_plus\_update\_c()}{h\_2\_plus\_update\_c()}}
{\footnotesize\ttfamily subroutine solvers\+::h\+\_\+2\+\_\+plus\+\_\+update\+\_\+c (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{c\+\_\+old,  }\item[{real(real64), intent(in)}]{gradient,  }\item[{real(real64), intent(out)}]{c\+\_\+new }\end{DoxyParamCaption})}



Definition at line 328 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{329 }
\DoxyCodeLine{330         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{331 }
\DoxyCodeLine{332 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: c\_old}
\DoxyCodeLine{333 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: gradient}
\DoxyCodeLine{334 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: c\_new}
\DoxyCodeLine{335 }
\DoxyCodeLine{336 \textcolor{keywordtype}{        real}(real64) :: damping = 1.0\_real64}
\DoxyCodeLine{337 }
\DoxyCodeLine{338         c\_new = c\_old + (damping * gradient)}
\DoxyCodeLine{339 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacesolvers_a38259c21a02a250a91f45d79e4165742}\label{namespacesolvers_a38259c21a02a250a91f45d79e4165742}} 
\index{solvers@{solvers}!h\_2\_cusp@{h\_2\_cusp}}
\index{h\_2\_cusp@{h\_2\_cusp}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_cusp()}{h\_2\_cusp()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+cusp (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{s }\end{DoxyParamCaption})}



Definition at line 349 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{350 }
\DoxyCodeLine{351         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{352 }
\DoxyCodeLine{353 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: s}
\DoxyCodeLine{354 \textcolor{keywordtype}{        real}(real64) :: a}
\DoxyCodeLine{355 }
\DoxyCodeLine{356 \textcolor{keywordtype}{        real}(real64) :: f, f\_dash, emsoa}
\DoxyCodeLine{357         \textcolor{keywordtype}{integer} :: maxiter = 1000}
\DoxyCodeLine{358 \textcolor{keywordtype}{        real}(real64) :: tol = 1e-\/5\_real64}
\DoxyCodeLine{359         \textcolor{keywordtype}{integer} :: k}
\DoxyCodeLine{360 }
\DoxyCodeLine{361         a = 0.5\_real64 \textcolor{comment}{! guess based on s=0 solution}}
\DoxyCodeLine{362 }
\DoxyCodeLine{363         \textcolor{keywordflow}{if} (write\_log) \textcolor{keywordflow}{then}}
\DoxyCodeLine{364             \textcolor{keyword}{write}(logid, \textcolor{stringliteral}{"{}('Starting Newton-\/Raphson search for parameter a...')"{}}\textcolor{comment}{)}}
\DoxyCodeLine{365 \textcolor{comment}{}            \textcolor{keyword}{write}(logid, *) \textcolor{stringliteral}{'a               abs(f)'}}
\DoxyCodeLine{366 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{367 }
\DoxyCodeLine{368         f = (1.0\_real64 / (1.0\_real64 + exp(-\/s/a))) -\/ a}
\DoxyCodeLine{369         \textcolor{keywordflow}{do} k = 1, maxiter}
\DoxyCodeLine{370 }
\DoxyCodeLine{371             \textcolor{keywordflow}{if} (abs(f) .lt. tol) \textcolor{keywordflow}{then}}
\DoxyCodeLine{372                 \textcolor{keywordflow}{if} (write\_log) \textcolor{keywordflow}{then}}
\DoxyCodeLine{373                     \textcolor{keyword}{write}(logid, \textcolor{stringliteral}{"{}('Value of parameter a converged.')"{}})}
\DoxyCodeLine{374                     \textcolor{keyword}{write}(logid, \textcolor{stringliteral}{"{}('')"{}})}
\DoxyCodeLine{375 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{376                 \textcolor{keywordflow}{exit}}
\DoxyCodeLine{377 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{378 }
\DoxyCodeLine{379             emsoa = exp(-\/s/a)}
\DoxyCodeLine{380             f = (1.0\_real64 / (1.0\_real64 + emsoa)) -\/ a}
\DoxyCodeLine{381             f\_dash = (-\/s * emsoa) / ((1.0\_real64 + emsoa*emsoa * a*a)) -\/\textcolor{comment}{ 1}}
\DoxyCodeLine{382 \textcolor{comment}{}}
\DoxyCodeLine{383             a = a -\/ (f / f\_dash)}
\DoxyCodeLine{384 }
\DoxyCodeLine{385             \textcolor{keywordflow}{if} (write\_log) \textcolor{keywordflow}{then}}
\DoxyCodeLine{386                 \textcolor{keyword}{write}(logid, \textcolor{stringliteral}{"{}(F12.8, '    ', F12.8)"{}}) a, abs(f)}
\DoxyCodeLine{387 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{388 }
\DoxyCodeLine{389 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{390 }
\DoxyCodeLine{391         \textcolor{comment}{! Crash out if not converged}}
\DoxyCodeLine{392         \textcolor{keywordflow}{if} (k .ge. maxiter) \textcolor{keywordflow}{then}}
\DoxyCodeLine{393             error stop \textcolor{stringliteral}{"{}Newton-\/Raphson search for parameter a has failed to converge."{}}}
\DoxyCodeLine{394 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{395 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{namespacesolvers_a38259c21a02a250a91f45d79e4165742_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_ac603f31a67286a6e89588cf4de29bd1b}\label{namespacesolvers_ac603f31a67286a6e89588cf4de29bd1b}} 
\index{solvers@{solvers}!h\_2\_wfn@{h\_2\_wfn}}
\index{h\_2\_wfn@{h\_2\_wfn}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_wfn()}{h\_2\_wfn()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+wfn (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{a,  }\item[{real(real64), intent(in)}]{beta,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+1,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+2,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b }\end{DoxyParamCaption})}



\{UPDATE ME\} Calculates trial wavefunction for the $ H_{2} $ problem. 

Function to calculate the wavefunction of two electrons at positions $ \mathbf{r}_{1} $ and $ \mathbf{r}_{2} $ in the hydrogen molecule $ H_{2} $. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+1} & Position of electron 1 \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+2} & Position of electron 2 \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em wfn} & Value of trial wavefunction \\
\hline
\end{DoxyRetVals}


Definition at line 417 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{418 }
\DoxyCodeLine{419         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{420 }
\DoxyCodeLine{421 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: a}
\DoxyCodeLine{422 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: beta}
\DoxyCodeLine{423 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_1, r\_2}
\DoxyCodeLine{424 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{425 }
\DoxyCodeLine{426 \textcolor{keywordtype}{        real}(real64) :: wfn}
\DoxyCodeLine{427 }
\DoxyCodeLine{428 \textcolor{keywordtype}{        real}(real64) :: s, alpha}
\DoxyCodeLine{429 \textcolor{keywordtype}{        real}(real64) :: phi\_r1, phi\_r2, jastrow}
\DoxyCodeLine{430 }
\DoxyCodeLine{431         s = norm2(r\_a -\/ r\_b)}
\DoxyCodeLine{432         alpha = 2.0\_real64}
\DoxyCodeLine{433 }
\DoxyCodeLine{434         phi\_r1 = exp(-\/norm2(r\_1 -\/ r\_a) / a) + exp(-\/norm2(r\_1 -\/ r\_b) / a)}
\DoxyCodeLine{435         phi\_r2 = exp(-\/norm2(r\_2 -\/ r\_a) / a) + exp(-\/norm2(r\_2 -\/ r\_b) / a)}
\DoxyCodeLine{436 }
\DoxyCodeLine{437         jastrow = exp(norm2(r\_1 -\/ r\_2) / (alpha * (1.0\_real64 + beta*norm2\textcolor{comment}{(r\_1 -\/ r\_2))))}}
\DoxyCodeLine{438 \textcolor{comment}{}}
\DoxyCodeLine{439         wfn = phi\_r1 * phi\_r2 * jastrow}
\DoxyCodeLine{440 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_ac603f31a67286a6e89588cf4de29bd1b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_ac30d1c7141f673647e837524ecb26b07}\label{namespacesolvers_ac30d1c7141f673647e837524ecb26b07}} 
\index{solvers@{solvers}!h\_2\_prob@{h\_2\_prob}}
\index{h\_2\_prob@{h\_2\_prob}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_prob()}{h\_2\_prob()}}
{\footnotesize\ttfamily real(real64) function solvers\+::h\+\_\+2\+\_\+prob (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{a,  }\item[{real(real64), intent(in)}]{beta,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+1\+\_\+current,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+2\+\_\+current,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+1\+\_\+next,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+2\+\_\+next,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b }\end{DoxyParamCaption})}



Calculates transition probability for the $ H_{2} $ problem. 

Function to calculate transition probability for walkers in the $ H_{2} $ problem. Computes \[ \frac{P(x_{i+1})}{P(x)} = \frac{\psi^{c}_{T}(\mathbf{r}_{1}^{i+1}, \mathbf{r}_{2}^{i+1})} {\psi^{c}_{T}(\mathbf{r}_{1}^{i}, \mathbf{r}_{2}^{i})} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+1\+\_\+current} & Current position of walker 1 \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+2\+\_\+current} & Current position of walker 2 \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+1\+\_\+next} & Proposed position of walker 1 \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+2\+\_\+next} & Proposed position of walker 2 \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em Prob} & Transition probability \\
\hline
\end{DoxyRetVals}


Definition at line 466 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{468 }
\DoxyCodeLine{469         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{470 }
\DoxyCodeLine{471 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: a}
\DoxyCodeLine{472 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: beta}
\DoxyCodeLine{473 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_1\_current, r\_2\_current}
\DoxyCodeLine{474 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_1\_next, r\_2\_next}
\DoxyCodeLine{475 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{476 }
\DoxyCodeLine{477 \textcolor{keywordtype}{        real}(real64) :: Prob}
\DoxyCodeLine{478 }
\DoxyCodeLine{479         prob = abs(h\_2\_wfn(a, beta, r\_1\_next, r\_2\_next, r\_a, r\_b) / \&}
\DoxyCodeLine{480                h\_2\_wfn(a, beta, r\_1\_current, r\_2\_current, r\_a, r\_b))**2}
\DoxyCodeLine{481 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=297pt]{namespacesolvers_ac30d1c7141f673647e837524ecb26b07_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_ac30d1c7141f673647e837524ecb26b07_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a9afbcdcc0405d544d4441e9786f440a2}\label{namespacesolvers_a9afbcdcc0405d544d4441e9786f440a2}} 
\index{solvers@{solvers}!h\_2\_energy@{h\_2\_energy}}
\index{h\_2\_energy@{h\_2\_energy}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_energy()}{h\_2\_energy()}}
{\footnotesize\ttfamily subroutine solvers\+::h\+\_\+2\+\_\+energy (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{a,  }\item[{real(real64), intent(in)}]{beta,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+1,  }\item[{real(real64), dimension(3), intent(in)}]{r\+\_\+2,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+a,  }\item[{real(real64), dimension(3), intent(in)}]{R\+\_\+b,  }\item[{real(real64), intent(out)}]{E\+\_\+loc,  }\item[{real(real64), intent(out)}]{Dphi\+Dbeta }\end{DoxyParamCaption})}



Calculates local energy for the $ H_{2} $ problem. 

Function to calculate the local energy of two walkers in the $ H_{2} $ problem. Computes \[ E^{c}_{L}(\mathbf{r}_{1}, \mathbf{r}_{2}) = \frac{\hat{H}\psi^{c}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2})} {\psi^{c}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2})} \] where \[ \hat{H} = -\frac{1}{2}\nabla^{2} - \frac{1}{\left | \mathbf{r}_{1}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}_{1}-\mathbf{R}_{B} \right |} - \frac{1}{\left | \mathbf{r}_{2}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}_{2}-\mathbf{R}_{B} \right |} + \frac{1}{\left | \mathbf{r}_{1}-\mathbf{r}_{2} \right |} \] 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Parameter(s) of trial wavefunction \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+1} & Position of walker 1 \\
\hline
\mbox{\texttt{ in}}  & {\em r\+\_\+2} & Position of walker 2 \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+a} & Position of hydrogen atom A \\
\hline
\mbox{\texttt{ in}}  & {\em R\+\_\+b} & Position of hydrogen atom B \\
\hline
\mbox{\texttt{ in}}  & {\em fdstep} & Finite difference step size (optional, default = 1e-\/3 Bohr) \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em E\+\_\+loc} & Local energy \\
\hline
\end{DoxyRetVals}


Definition at line 513 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{514 }
\DoxyCodeLine{515         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{516 }
\DoxyCodeLine{517 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: a}
\DoxyCodeLine{518 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: beta}
\DoxyCodeLine{519 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: r\_1, r\_2}
\DoxyCodeLine{520 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{intent(in)} :: R\_a, R\_b}
\DoxyCodeLine{521 }
\DoxyCodeLine{522 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: E\_loc}
\DoxyCodeLine{523 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: DphiDbeta}
\DoxyCodeLine{524 }
\DoxyCodeLine{525 \textcolor{keywordtype}{        real}(real64) :: E1, E2, E3, E4, E5, E6, E7, E8}
\DoxyCodeLine{526 \textcolor{keywordtype}{        real}(real64) :: phi\_1a, phi\_1b, phi\_1}
\DoxyCodeLine{527 \textcolor{keywordtype}{        real}(real64) :: phi\_2a, phi\_2b, phi\_2}
\DoxyCodeLine{528 \textcolor{keywordtype}{        real}(real64) :: r\_1a, r\_1b, r\_2a, r\_2b, r\_12}
\DoxyCodeLine{529 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)} :: r\_1a\_hat, r\_1b\_hat, r\_2a\_hat, r\_2b\_hat\textcolor{comment}{, r\_12\_hat}}
\DoxyCodeLine{530 \textcolor{comment}{}}
\DoxyCodeLine{531 \textcolor{comment}{        r\_1a = norm2(r\_1 -\/ r\_a)}}
\DoxyCodeLine{532 \textcolor{comment}{}        r\_1b = norm2(r\_1 -\/ r\_b)}
\DoxyCodeLine{533         r\_2a = norm2(r\_2 -\/ r\_a)}
\DoxyCodeLine{534         r\_2b = norm2(r\_2 -\/ r\_b)}
\DoxyCodeLine{535         r\_12 = norm2(r\_1 -\/ r\_2)}
\DoxyCodeLine{536 }
\DoxyCodeLine{537         r\_1a\_hat = (r\_1 -\/ r\_a) / spread(r\_1a, 1, 3)}
\DoxyCodeLine{538         r\_1b\_hat = (r\_1 -\/ r\_b) / spread(r\_1b, 1, 3)}
\DoxyCodeLine{539         r\_2a\_hat = (r\_2 -\/ r\_a) / spread(r\_2a, 1, 3)}
\DoxyCodeLine{540         r\_2b\_hat = (r\_2 -\/ r\_b) / spread(r\_2b, 1, 3)}
\DoxyCodeLine{541         r\_12\_hat = (r\_1 -\/ r\_2) / spread(r\_12, 1, 3)}
\DoxyCodeLine{542 }
\DoxyCodeLine{543         phi\_1a = exp(-\/r\_1a / a)}
\DoxyCodeLine{544         phi\_1b = exp(-\/r\_1b / a)}
\DoxyCodeLine{545         phi\_2a = exp(-\/r\_2a / a)}
\DoxyCodeLine{546         phi\_2b = exp(-\/r\_2b / a)}
\DoxyCodeLine{547 }
\DoxyCodeLine{548         phi\_1 = phi\_1a + phi\_1b}
\DoxyCodeLine{549         phi\_2 = phi\_2a + phi\_2b}
\DoxyCodeLine{550 }
\DoxyCodeLine{551         e1 = 1.0\_real64 / (a*a)}
\DoxyCodeLine{552         e2 = ((phi\_1a / r\_1a) + (phi\_1b / r\_1b)) / (a * phi\_1)}
\DoxyCodeLine{553         e3 = ((phi\_2a / r\_2a) + (phi\_2b / r\_2b)) / (a * phi\_2)}
\DoxyCodeLine{554         e4 = (1.0\_real64 / r\_1a) + (1.0\_real64 / r\_1b) + (1.0\_real64 / r\_2a\textcolor{comment}{) + (1.0\_real64 / r\_2b)}}
\DoxyCodeLine{555 \textcolor{comment}{}        e5 = 1.0\_real64 / r\_12}
\DoxyCodeLine{556         e6 = ((((phi\_1a * sum(r\_1a\_hat * r\_12\_hat, dim=1)) + (phi\_1b * sum\textcolor{comment}{(r\_1b\_hat * r\_12\_hat, dim=1))) / phi\_1) \&}}
\DoxyCodeLine{557 \textcolor{comment}{}            -\/ (((phi\_2a * sum(r\_2a\_hat * r\_12\_hat, dim=1)) + (phi\_2b * sum\textcolor{comment}{(r\_2b\_hat * r\_12\_hat, dim=1))) / phi\_2)) \&}}
\DoxyCodeLine{558 \textcolor{comment}{}            / (2.0\_real64 * a * (1.0\_real64 + beta*r\_12)**2)}
\DoxyCodeLine{559         e7 = (((4.0\_real64*beta + 1.0\_real64) * r\_12) + 4.0\_real64) \&}
\DoxyCodeLine{560             / (4.0\_real64 * r\_12 * (1.0\_real64 + beta*r\_12)**4)}
\DoxyCodeLine{561         e8 = (1.0\_real64 / norm2(r\_a -\/ r\_b))}
\DoxyCodeLine{562         }
\DoxyCodeLine{563         \textcolor{comment}{! E\_loc = -\/E1 + E2 + E3 -\/ E4 + E5 + E6 -\/ E7 + (1.0\_real64 / norm2(R\_a -\/ R\_b))}}
\DoxyCodeLine{564         \textcolor{comment}{! E\_loc = -\/E1 + E2 + E3 -\/ E4 + E5 + E6 -\/ E7}}
\DoxyCodeLine{565         e\_loc = -\/e1 + e2 + e3 -\/ e4 + e5 + e6 -\/ e7 + e8}
\DoxyCodeLine{566 }
\DoxyCodeLine{567         dphidbeta = -\/(r\_12*r\_12) / (2.0\_real64*(1.0\_real64 + beta*r\_12)*\textcolor{comment}{*2)}}
\DoxyCodeLine{568 \textcolor{comment}{}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacesolvers_a9afbcdcc0405d544d4441e9786f440a2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacesolvers_a4b4d370a4ee50b231f53058ab62e4084}\label{namespacesolvers_a4b4d370a4ee50b231f53058ab62e4084}} 
\index{solvers@{solvers}!h\_2\_update\_beta@{h\_2\_update\_beta}}
\index{h\_2\_update\_beta@{h\_2\_update\_beta}!solvers@{solvers}}
\doxysubsubsection{\texorpdfstring{h\_2\_update\_beta()}{h\_2\_update\_beta()}}
{\footnotesize\ttfamily subroutine solvers\+::h\+\_\+2\+\_\+update\+\_\+beta (\begin{DoxyParamCaption}\item[{real(real64), intent(in)}]{beta\+\_\+old,  }\item[{real(real64), intent(in)}]{gradient,  }\item[{real(real64), intent(out)}]{beta\+\_\+new }\end{DoxyParamCaption})}



Definition at line 573 of file quantum\+\_\+solvers.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{574 }
\DoxyCodeLine{575         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{576 }
\DoxyCodeLine{577 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: beta\_old}
\DoxyCodeLine{578 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: gradient}
\DoxyCodeLine{579 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: beta\_new}
\DoxyCodeLine{580 }
\DoxyCodeLine{581 \textcolor{keywordtype}{        real}(real64) :: damping = 1.0\_real64}
\DoxyCodeLine{582 }
\DoxyCodeLine{583         beta\_new = beta\_old -\/ (damping * gradient)}
\DoxyCodeLine{584 }

\end{DoxyCode}
