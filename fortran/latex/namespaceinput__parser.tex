\hypertarget{namespaceinput__parser}{}\doxysection{input\+\_\+parser Module Reference}
\label{namespaceinput__parser}\index{input\_parser@{input\_parser}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}{read\+\_\+control}} (p\+\_\+system, run\+\_\+equil, run\+\_\+restart, write\+\_\+restart, restart\+\_\+step, write\+\_\+chains, write\+\_\+log)
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}{read\+\_\+qho}} (QHO)
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}{read\+\_\+h2plus}} (H2plus)
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}{read\+\_\+h2}} (H2)
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a6ab6b03879dd4cad7ace90b37bdf39a4}{read\+\_\+restart}} (res)
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}{read\+\_\+inputs}} ()
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}\label{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}} 
\index{input\_parser@{input\_parser}!read\_control@{read\_control}}
\index{read\_control@{read\_control}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_control()}{read\_control()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+control (\begin{DoxyParamCaption}\item[{character(len=10), intent(out)}]{p\+\_\+system,  }\item[{logical, intent(out)}]{run\+\_\+equil,  }\item[{logical, intent(out)}]{run\+\_\+restart,  }\item[{logical, intent(out)}]{write\+\_\+restart,  }\item[{integer(int32), intent(out)}]{restart\+\_\+step,  }\item[{logical, intent(out)}]{write\+\_\+chains,  }\item[{logical, intent(out)}]{write\+\_\+log }\end{DoxyParamCaption})}



Definition at line 14 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{15 }
\DoxyCodeLine{16     \textcolor{comment}{! Local variables}}
\DoxyCodeLine{17     \textcolor{keywordtype}{character(len=10)}, \textcolor{keywordtype}{intent(out)} :: p\_system}
\DoxyCodeLine{18     \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(out)} :: run\_equil, run\_restart, write\_restart, write\_chains, write\_log}
\DoxyCodeLine{19     \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{intent(out)} :: restart\_step    }
\DoxyCodeLine{20 }
\DoxyCodeLine{21     \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{22     namelist /control/ p\_system, run\_equil, run\_restart, write\_restart, restart\_step, write\_chains, write\_log}
\DoxyCodeLine{23 }
\DoxyCodeLine{24     \textcolor{comment}{! Open the file}}
\DoxyCodeLine{25     \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{26 }
\DoxyCodeLine{27     \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{28     \textcolor{keyword}{read}(nml=control, iostat=rc, unit=fu)}
\DoxyCodeLine{29     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{30         print*, \textcolor{stringliteral}{'Error: Invalid CONTROL namelist format in file "{}params.txt"{}.'}}
\DoxyCodeLine{31 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{32     }
\DoxyCodeLine{33     \textcolor{comment}{! Close the file}}
\DoxyCodeLine{34     \textcolor{keyword}{close}(fu)}
\DoxyCodeLine{35 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}\label{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}} 
\index{input\_parser@{input\_parser}!read\_qho@{read\_qho}}
\index{read\_qho@{read\_qho}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_qho()}{read\_qho()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+qho (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1qho__type}{qho\+\_\+type}}), intent(out)}]{QHO }\end{DoxyParamCaption})}



Definition at line 39 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     \textcolor{comment}{! Local variables}}
\DoxyCodeLine{42     \textcolor{keywordtype}{type}(QHO\_type), \textcolor{keywordtype}{intent(out)} :: QHO}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{45     namelist /parameters/ qho}
\DoxyCodeLine{46 }
\DoxyCodeLine{47     \textcolor{comment}{! Open the file}}
\DoxyCodeLine{48     \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{51     \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{52     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{53         print*, \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for QHO p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{54 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{55     }
\DoxyCodeLine{56     \textcolor{comment}{! Close the file}}
\DoxyCodeLine{57     \textcolor{keyword}{close}(fu)}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}\label{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}} 
\index{input\_parser@{input\_parser}!read\_h2plus@{read\_h2plus}}
\index{read\_h2plus@{read\_h2plus}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_h2plus()}{read\_h2plus()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+h2plus (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1h2plus__type}{h2plus\+\_\+type}}), intent(out)}]{H2plus }\end{DoxyParamCaption})}



Definition at line 61 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{62 }
\DoxyCodeLine{63     \textcolor{comment}{! Local variables}}
\DoxyCodeLine{64     \textcolor{keywordtype}{type}(H2plus\_type), \textcolor{keywordtype}{intent(out)} :: H2plus}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{67     namelist /parameters/ h2plus}
\DoxyCodeLine{68 }
\DoxyCodeLine{69     \textcolor{comment}{! Open the file}}
\DoxyCodeLine{70     \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{73     \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{74     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{75         print*, \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for H2plus p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{76 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{77     }
\DoxyCodeLine{78     \textcolor{comment}{! Close the file}}
\DoxyCodeLine{79     \textcolor{keyword}{close}(fu)}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}\label{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}} 
\index{input\_parser@{input\_parser}!read\_h2@{read\_h2}}
\index{read\_h2@{read\_h2}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_h2()}{read\_h2()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+h2 (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1h2__type}{h2\+\_\+type}}), intent(out)}]{H2 }\end{DoxyParamCaption})}



Definition at line 83 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{84 }
\DoxyCodeLine{85     \textcolor{comment}{! Local variables}}
\DoxyCodeLine{86     \textcolor{keywordtype}{type}(H2\_type), \textcolor{keywordtype}{intent(out)} :: H2}
\DoxyCodeLine{87 }
\DoxyCodeLine{88     \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{89     namelist /parameters/ h2}
\DoxyCodeLine{90 }
\DoxyCodeLine{91     \textcolor{comment}{! Open the file}}
\DoxyCodeLine{92     \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{93 }
\DoxyCodeLine{94     \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{95     \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{96     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{97         print*, \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for H2 p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{98 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{99     }
\DoxyCodeLine{100     \textcolor{comment}{! Close the file}}
\DoxyCodeLine{101     \textcolor{keyword}{close}(fu)}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a6ab6b03879dd4cad7ace90b37bdf39a4}\label{namespaceinput__parser_a6ab6b03879dd4cad7ace90b37bdf39a4}} 
\index{input\_parser@{input\_parser}!read\_restart@{read\_restart}}
\index{read\_restart@{read\_restart}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_restart()}{read\_restart()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+restart (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1restart__type}{restart\+\_\+type}}), intent(out)}]{res }\end{DoxyParamCaption})}



Definition at line 105 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{106 }
\DoxyCodeLine{107     \textcolor{comment}{! Local variables}}
\DoxyCodeLine{108     \textcolor{keywordtype}{type}(restart\_type), \textcolor{keywordtype}{intent(out)} :: res}
\DoxyCodeLine{109 }
\DoxyCodeLine{110     \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{111     namelist /restart/ res}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \textcolor{comment}{! Open the file}}
\DoxyCodeLine{114     \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{115 }
\DoxyCodeLine{116     \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{117     \textcolor{keyword}{read}(nml=restart, iostat=rc, unit=fu)}
\DoxyCodeLine{118     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{119         print*, \textcolor{stringliteral}{'Error: Invalid RESTART namelist in "{}params.txt"{}.'}}
\DoxyCodeLine{120 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{121     }
\DoxyCodeLine{122     \textcolor{comment}{! Close the file}}
\DoxyCodeLine{123     \textcolor{keyword}{close}(fu)}

\end{DoxyCode}
\mbox{\Hypertarget{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}\label{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}} 
\index{input\_parser@{input\_parser}!read\_inputs@{read\_inputs}}
\index{read\_inputs@{read\_inputs}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_inputs()}{read\_inputs()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+inputs}



Definition at line 127 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     \textcolor{comment}{! Check if file 'params.txt' exists}}
\DoxyCodeLine{130     \textcolor{keyword}{inquire}(file=\textcolor{stringliteral}{'params.txt'}, iostat=rc)}
\DoxyCodeLine{131     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{132         print*, \textcolor{stringliteral}{'Error: Input file "{}params.txt"{} does not exist.'}}
\DoxyCodeLine{133         \textcolor{keywordflow}{return}}
\DoxyCodeLine{134 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136     \textcolor{comment}{! Read CONTROL namelist}}
\DoxyCodeLine{137     \textcolor{keyword}{call }read\_control(p\_system, run\_equil, run\_restart, write\_restart, restart\_step, write\_chains, write\_log)}
\DoxyCodeLine{138     \textcolor{keyword}{write}(*, *) \textcolor{stringliteral}{'System: '}, p\_system}
\DoxyCodeLine{139 }
\DoxyCodeLine{140     \textcolor{comment}{! If p\_system='test', return to main}}
\DoxyCodeLine{141     \textcolor{keywordflow}{if} (trim(p\_system)==\textcolor{stringliteral}{'test'}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{142         \textcolor{keywordflow}{return}}
\DoxyCodeLine{143 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{144     }
\DoxyCodeLine{145     \textcolor{comment}{! For equilibration runs, modify the defaults}}
\DoxyCodeLine{146     \textcolor{keywordflow}{if} (run\_equil .eqv. .true.) \textcolor{keywordflow}{then}}
\DoxyCodeLine{147         \textcolor{keywordflow}{select case} (trim(p\_system))}
\DoxyCodeLine{148         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'QHO'})}
\DoxyCodeLine{149             qho\%steps = 20000}
\DoxyCodeLine{150             qho\%burn\_step = 0}
\DoxyCodeLine{151             qho\%thin\_step = 1}
\DoxyCodeLine{152         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2plus'})}
\DoxyCodeLine{153             h2plus\%steps = 20000}
\DoxyCodeLine{154             h2plus\%burn\_step = 0}
\DoxyCodeLine{155             h2plus\%thin\_step = 1}
\DoxyCodeLine{156         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2'})}
\DoxyCodeLine{157             h2\%steps = 20000}
\DoxyCodeLine{158             h2\%burn\_step = 0}
\DoxyCodeLine{159             h2\%thin\_step = 1}
\DoxyCodeLine{160 \textcolor{keywordflow}{        case default}}
\DoxyCodeLine{161             error stop \textcolor{stringliteral}{'Error: Invalid system definition.'}}
\DoxyCodeLine{162 \textcolor{keywordflow}{        end select}}
\DoxyCodeLine{163 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{164 }
\DoxyCodeLine{165     \textcolor{comment}{! Read PARAMETERS of the defined problem}}
\DoxyCodeLine{166     \textcolor{keywordflow}{select case} (trim(p\_system))}
\DoxyCodeLine{167     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'QHO'})}
\DoxyCodeLine{168         \textcolor{keyword}{call }read\_qho(qho)}
\DoxyCodeLine{169     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2plus'})}
\DoxyCodeLine{170         \textcolor{keyword}{call }read\_h2plus(h2plus)}
\DoxyCodeLine{171     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2'})}
\DoxyCodeLine{172         \textcolor{keyword}{call }read\_h2(h2)}
\DoxyCodeLine{173 \textcolor{keywordflow}{    case default}}
\DoxyCodeLine{174         error stop \textcolor{stringliteral}{'Error: Invalid system definition.'}}
\DoxyCodeLine{175 \textcolor{keywordflow}{    end select}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177     \textcolor{comment}{! For restart runs}}
\DoxyCodeLine{178     \textcolor{keywordflow}{if} (run\_restart .eqv. .true.) \textcolor{keywordflow}{then}}
\DoxyCodeLine{179 }
\DoxyCodeLine{180         \textcolor{comment}{! Read RESTART namelist }}
\DoxyCodeLine{181         \textcolor{keyword}{call }read\_res\_params(res)}
\DoxyCodeLine{182 }
\DoxyCodeLine{183         \textcolor{comment}{! Update parameter grid values}}
\DoxyCodeLine{184         \textcolor{keywordflow}{select case} (trim(p\_system))}
\DoxyCodeLine{185         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'QHO'})}
\DoxyCodeLine{186             \textcolor{comment}{! check alpha value}}
\DoxyCodeLine{187         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2plus'})}
\DoxyCodeLine{188             \textcolor{comment}{! check if c1, c2 or bond}}
\DoxyCodeLine{189         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2'})}
\DoxyCodeLine{190             \textcolor{comment}{! check if c1, c2 or bond}}
\DoxyCodeLine{191 \textcolor{keywordflow}{        case default}}
\DoxyCodeLine{192             error stop \textcolor{stringliteral}{'Error: Invalid system definition.'}}
\DoxyCodeLine{193 \textcolor{keywordflow}{        end select}}
\DoxyCodeLine{194 \textcolor{keywordflow}{    end if} }
\DoxyCodeLine{195 }
\DoxyCodeLine{196 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=323pt]{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea_icgraph}
\end{center}
\end{figure}
