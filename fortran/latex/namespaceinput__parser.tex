\hypertarget{namespaceinput__parser}{}\doxysection{input\+\_\+parser Module Reference}
\label{namespaceinput__parser}\index{input\_parser@{input\_parser}}


Contains routines that read the input file params.\+txt.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}{read\+\_\+control}} (p\+\_\+system, run\+\_\+equil, run\+\_\+restart, write\+\_\+restart, restart\+\_\+step, write\+\_\+chains, write\+\_\+log)
\begin{DoxyCompactList}\small\item\em Reads the CONTROL namelist in params.\+txt and assigns its data to the corresponding global variables defined in the \mbox{\hyperlink{namespaceshared__data}{shared\+\_\+data}} module. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}{read\+\_\+qho}} (QHO)
\begin{DoxyCompactList}\small\item\em Reads the PARAMETER namelist in params.\+txt for the QHO system. Assigns the input data to the corresponding variables in the QHO derived type. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}{read\+\_\+h2plus}} (H2plus)
\begin{DoxyCompactList}\small\item\em Reads the PARAMETER namelist in params.\+txt for the H2 ion system. Assigns the input data to the corresponding variables in the QHO derived type. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}{read\+\_\+h2}} (H2)
\begin{DoxyCompactList}\small\item\em Reads the PARAMETER namelist in params.\+txt for the H2 molecule system. Assigns the input data to the corresponding variables in the QHO derived type. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}{read\+\_\+inputs}} ()
\begin{DoxyCompactList}\small\item\em Main input parser function that reads the input file params.\+txt and calls the required namelist parser subroutines, depending on the system. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains routines that read the input file params.\+txt. 

Contains subroutines to read the CONTROL namelist and the PARAMETERS namelist for each system respectively. Includes a driver function that handles the input file params.\+txt. For restart runs, the driver function also ensures that the RESTART namelist from, restart file res\+\_\+nml.\+txt, is read into the program. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}\label{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}} 
\index{input\_parser@{input\_parser}!read\_control@{read\_control}}
\index{read\_control@{read\_control}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_control()}{read\_control()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+control (\begin{DoxyParamCaption}\item[{character(len=10), intent(out)}]{p\+\_\+system,  }\item[{logical, intent(out)}]{run\+\_\+equil,  }\item[{logical, intent(out)}]{run\+\_\+restart,  }\item[{logical, intent(out)}]{write\+\_\+restart,  }\item[{integer(int32), intent(out)}]{restart\+\_\+step,  }\item[{logical, intent(out)}]{write\+\_\+chains,  }\item[{logical, intent(out)}]{write\+\_\+log }\end{DoxyParamCaption})}



Reads the CONTROL namelist in params.\+txt and assigns its data to the corresponding global variables defined in the \mbox{\hyperlink{namespaceshared__data}{shared\+\_\+data}} module. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p\+\_\+system} & System of interest\+: QHO, H2plus, H2 \\
\hline
\mbox{\texttt{ in}}  & {\em run\+\_\+equil} & Tag for equilibration runs \\
\hline
\mbox{\texttt{ in}}  & {\em run\+\_\+restart} & Tag for restart runs \\
\hline
\mbox{\texttt{ in}}  & {\em write\+\_\+restart} & Tag for writing restart files \\
\hline
\mbox{\texttt{ in}}  & {\em restart\+\_\+step} & Frequency of writing restart files, within MMC loop \\
\hline
\mbox{\texttt{ in}}  & {\em write\+\_\+chains} & Tag to write final MMC chains \\
\hline
\mbox{\texttt{ in}}  & {\em write\+\_\+log} & Tag to write logfile \\
\hline
\end{DoxyParams}


Definition at line 51 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{52 }
\DoxyCodeLine{53         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{54         \textcolor{keywordtype}{character(len=10)}, \textcolor{keywordtype}{intent(out)} :: p\_system}
\DoxyCodeLine{55         \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(out)} :: run\_equil, run\_restart, write\_restart, write\_chains, write\_log}
\DoxyCodeLine{56         \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{intent(out)} :: restart\_step    }
\DoxyCodeLine{57 }
\DoxyCodeLine{58         \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{59         namelist /control/ p\_system, run\_equil, run\_restart, write\_restart, restart\_step, write\_chains, write\_log}
\DoxyCodeLine{60 }
\DoxyCodeLine{61         \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{62         \textcolor{keyword}{read}(nml=control, iostat=rc, unit=fu)}
\DoxyCodeLine{63         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{64             error stop \textcolor{stringliteral}{'Error: Invalid CONTROL namelist format in file "{}params.txt"{}.'}}
\DoxyCodeLine{65 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{66         }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}\label{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}} 
\index{input\_parser@{input\_parser}!read\_qho@{read\_qho}}
\index{read\_qho@{read\_qho}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_qho()}{read\_qho()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+qho (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1qho__type}{qho\+\_\+type}}), intent(out)}]{QHO }\end{DoxyParamCaption})}



Reads the PARAMETER namelist in params.\+txt for the QHO system. Assigns the input data to the corresponding variables in the QHO derived type. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em QHO} & Instance of QHO\+\_\+type, to store input parameter values \\
\hline
\end{DoxyParams}


Definition at line 80 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{81 }
\DoxyCodeLine{82         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{83         \textcolor{keywordtype}{type}(QHO\_type), \textcolor{keywordtype}{intent(out)} :: QHO}
\DoxyCodeLine{84 }
\DoxyCodeLine{85         \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{86         namelist /parameters/ qho}
\DoxyCodeLine{87 }
\DoxyCodeLine{88         \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{89         \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{90         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{91             error stop \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for QHO p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{92 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{93         }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}\label{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}} 
\index{input\_parser@{input\_parser}!read\_h2plus@{read\_h2plus}}
\index{read\_h2plus@{read\_h2plus}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_h2plus()}{read\_h2plus()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+h2plus (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1h2plus__type}{h2plus\+\_\+type}}), intent(out)}]{H2plus }\end{DoxyParamCaption})}



Reads the PARAMETER namelist in params.\+txt for the H2 ion system. Assigns the input data to the corresponding variables in the QHO derived type. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em QHO} & Instance of QHO\+\_\+type, to store input parameter values \\
\hline
\end{DoxyParams}


Definition at line 107 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{108 }
\DoxyCodeLine{109         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{110         \textcolor{keywordtype}{type}(H2plus\_type), \textcolor{keywordtype}{intent(out)} :: H2plus}
\DoxyCodeLine{111 }
\DoxyCodeLine{112         \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{113         namelist /parameters/ h2plus}
\DoxyCodeLine{114 }
\DoxyCodeLine{115         \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{116         \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{117         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{118             error stop \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for H2plus p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{119 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{120         }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}\label{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}} 
\index{input\_parser@{input\_parser}!read\_h2@{read\_h2}}
\index{read\_h2@{read\_h2}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_h2()}{read\_h2()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+h2 (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1h2__type}{h2\+\_\+type}}), intent(out)}]{H2 }\end{DoxyParamCaption})}



Reads the PARAMETER namelist in params.\+txt for the H2 molecule system. Assigns the input data to the corresponding variables in the QHO derived type. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em QHO} & Instance of QHO\+\_\+type, to store input parameter values \\
\hline
\end{DoxyParams}


Definition at line 134 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{135 }
\DoxyCodeLine{136         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{137         \textcolor{keywordtype}{type}(H2\_type), \textcolor{keywordtype}{intent(out)} :: H2}
\DoxyCodeLine{138 }
\DoxyCodeLine{139         \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{140         namelist /parameters/ h2}
\DoxyCodeLine{141 }
\DoxyCodeLine{142         \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{143         \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{144         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{145             error stop \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for H2 p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{146 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{147         }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}\label{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}} 
\index{input\_parser@{input\_parser}!read\_inputs@{read\_inputs}}
\index{read\_inputs@{read\_inputs}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_inputs()}{read\_inputs()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+inputs}



Main input parser function that reads the input file params.\+txt and calls the required namelist parser subroutines, depending on the system. 

This sunroutine also sets the default parameters for equilibration runs, and calls the restart namelist reader when required. 

Definition at line 167 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{168 }
\DoxyCodeLine{169         \textcolor{comment}{! Check if file 'params.txt' exists}}
\DoxyCodeLine{170         \textcolor{keyword}{inquire}(file=\textcolor{stringliteral}{'params.txt'}, iostat=rc)}
\DoxyCodeLine{171         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{172             error stop \textcolor{stringliteral}{'Error: Input file "{}params.txt"{} does not exist.'}}
\DoxyCodeLine{173 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{174 }
\DoxyCodeLine{175         \textcolor{comment}{! Open the params.txt file}}
\DoxyCodeLine{176         \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{177 }
\DoxyCodeLine{178         \textcolor{comment}{! Read CONTROL namelist}}
\DoxyCodeLine{179         \textcolor{keyword}{call }read\_control(p\_system, run\_equil, run\_restart, write\_restart\textcolor{comment}{, restart\_step, write\_chains, write\_log)}}
\DoxyCodeLine{180 \textcolor{comment}{}}
\DoxyCodeLine{181         \textcolor{comment}{! If p\_system='test', return to main}}
\DoxyCodeLine{182         \textcolor{keywordflow}{if} (trim(p\_system)==\textcolor{stringliteral}{'test'}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{183             \textcolor{keywordflow}{return}}
\DoxyCodeLine{184 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{185         }
\DoxyCodeLine{186         \textcolor{comment}{! For equilibration runs, modify the defaults}}
\DoxyCodeLine{187         \textcolor{keywordflow}{if} (run\_equil) \textcolor{keywordflow}{then}}
\DoxyCodeLine{188             \textcolor{keywordflow}{select case} (trim(p\_system))}
\DoxyCodeLine{189             \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'QHO'})}
\DoxyCodeLine{190                 qho\%steps = 20000}
\DoxyCodeLine{191                 qho\%burn\_step = 0}
\DoxyCodeLine{192                 qho\%thin\_step = 1}
\DoxyCodeLine{193             \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2plus'})}
\DoxyCodeLine{194                 h2plus\%steps = 20000}
\DoxyCodeLine{195                 h2plus\%burn\_step = 0}
\DoxyCodeLine{196                 h2plus\%thin\_step = 1}
\DoxyCodeLine{197             \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2'})}
\DoxyCodeLine{198                 h2\%steps = 20000}
\DoxyCodeLine{199                 h2\%burn\_step = 0}
\DoxyCodeLine{200                 h2\%thin\_step = 1}
\DoxyCodeLine{201 \textcolor{keywordflow}{            case default}}
\DoxyCodeLine{202                 error stop \textcolor{stringliteral}{'Error: Invalid system definition.'}}
\DoxyCodeLine{203 \textcolor{keywordflow}{            end select}}
\DoxyCodeLine{204 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{205 }
\DoxyCodeLine{206         \textcolor{comment}{! Read PARAMETERS namelist of the defined problem}}
\DoxyCodeLine{207         \textcolor{keywordflow}{select case} (trim(p\_system))}
\DoxyCodeLine{208         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'QHO'})}
\DoxyCodeLine{209             \textcolor{keyword}{call }read\_qho(qho)}
\DoxyCodeLine{210         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2plus'})}
\DoxyCodeLine{211             \textcolor{keyword}{call }read\_h2plus(h2plus)}
\DoxyCodeLine{212         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2'})}
\DoxyCodeLine{213             \textcolor{keyword}{call }read\_h2(h2)}
\DoxyCodeLine{214 \textcolor{keywordflow}{        case default}}
\DoxyCodeLine{215             error stop \textcolor{stringliteral}{'Error: Invalid system definition.'}}
\DoxyCodeLine{216 \textcolor{keywordflow}{        end select}}
\DoxyCodeLine{217 }
\DoxyCodeLine{218         \textcolor{comment}{! Close the params.txt file}}
\DoxyCodeLine{219         \textcolor{keyword}{close}(fu)}
\DoxyCodeLine{220 }
\DoxyCodeLine{221         \textcolor{comment}{! For restart runs}}
\DoxyCodeLine{222         \textcolor{keywordflow}{if} (run\_restart) \textcolor{keywordflow}{then}}
\DoxyCodeLine{223 }
\DoxyCodeLine{224             \textcolor{comment}{! Read RESTART namelist}}
\DoxyCodeLine{225             \textcolor{keyword}{call }read\_res\_nml(res)}
\DoxyCodeLine{226 }
\DoxyCodeLine{227             \textcolor{comment}{! Update grid-\/loop start values}}
\DoxyCodeLine{228             \textcolor{comment}{! TO DO: Remove res\%step if James confirms that chain-\/restarts are not required.}}
\DoxyCodeLine{229             \textcolor{keywordflow}{if} (trim(p\_system) == \textcolor{stringliteral}{'QHO'}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{230                 \textcolor{keywordflow}{if} (res\%step == 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{231                     alpha\_start = res\%i\_alpha}
\DoxyCodeLine{232                 \textcolor{keywordflow}{else} }
\DoxyCodeLine{233                     alpha\_start = res\%i\_alpha+1}
\DoxyCodeLine{234 \textcolor{keywordflow}{                endif} }
\DoxyCodeLine{235             \textcolor{keywordflow}{else} }
\DoxyCodeLine{236                 \textcolor{keywordflow}{if} (res\%step == 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{237                     bond\_start = res\%i\_bond}
\DoxyCodeLine{238                 \textcolor{keywordflow}{else} }
\DoxyCodeLine{239                     bond\_start = res\%i\_bond+1}
\DoxyCodeLine{240 \textcolor{keywordflow}{                endif} }
\DoxyCodeLine{241 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{242 }
\DoxyCodeLine{243             \textcolor{comment}{! Print restarts header.}}
\DoxyCodeLine{244             \textcolor{keyword}{write}(*, \textcolor{stringliteral}{"{}('-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Restarted Program -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/')"{}}\textcolor{comment}{)}}
\DoxyCodeLine{245 \textcolor{comment}{}            \textcolor{keyword}{write}(*, \textcolor{stringliteral}{"{}('')"{}})}
\DoxyCodeLine{246 }
\DoxyCodeLine{247 \textcolor{keywordflow}{        end if} }
\DoxyCodeLine{248 }
\DoxyCodeLine{249 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea_icgraph}
\end{center}
\end{figure}
