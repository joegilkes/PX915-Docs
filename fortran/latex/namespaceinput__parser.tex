\hypertarget{namespaceinput__parser}{}\doxysection{input\+\_\+parser Module Reference}
\label{namespaceinput__parser}\index{input\_parser@{input\_parser}}


Contains routines that read the input file params.\+txt.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}{read\+\_\+control}} (p\+\_\+system, run\+\_\+equil, run\+\_\+restart, write\+\_\+restart, restart\+\_\+step, write\+\_\+chains, write\+\_\+log)
\begin{DoxyCompactList}\small\item\em Reads the CONTROL namelist in params.\+txt and assigns its data to the corresponding global variables defined in the \mbox{\hyperlink{namespaceshared__data}{shared\+\_\+data}} module. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}{read\+\_\+qho}} (QHO)
\begin{DoxyCompactList}\small\item\em Reads the PARAMETER namelist in params.\+txt for the QHO system. Assigns the input data to the corresponding variables in the QHO derived type. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}{read\+\_\+h2plus}} (H2plus)
\begin{DoxyCompactList}\small\item\em Reads the PARAMETER namelist in params.\+txt for the H2 ion system. Assigns the input data to the corresponding variables in the QHO derived type. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}{read\+\_\+h2}} (H2)
\begin{DoxyCompactList}\small\item\em Reads the PARAMETER namelist in params.\+txt for the H2 molecule system. Assigns the input data to the corresponding variables in the QHO derived type. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}{read\+\_\+inputs}} ()
\begin{DoxyCompactList}\small\item\em Main input parser function that reads the input file params.\+txt and calls the required namelist parser subroutines, depending on the system. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains routines that read the input file params.\+txt. 

Contains subroutines to read the CONTROL namelist and the PARAMETERS namelist for each system respectively. Includes a driver function that handles the input file params.\+txt. For restart runs, the driver function also ensures that the RESTART namelist from, restart file res\+\_\+nml.\+txt, is read into the program. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}\label{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}} 
\index{input\_parser@{input\_parser}!read\_control@{read\_control}}
\index{read\_control@{read\_control}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_control()}{read\_control()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+control (\begin{DoxyParamCaption}\item[{character(len=10), intent(out)}]{p\+\_\+system,  }\item[{logical, intent(out)}]{run\+\_\+equil,  }\item[{logical, intent(out)}]{run\+\_\+restart,  }\item[{logical, intent(out)}]{write\+\_\+restart,  }\item[{integer(int32), intent(out)}]{restart\+\_\+step,  }\item[{logical, intent(out)}]{write\+\_\+chains,  }\item[{logical, intent(out)}]{write\+\_\+log }\end{DoxyParamCaption})}



Reads the CONTROL namelist in params.\+txt and assigns its data to the corresponding global variables defined in the \mbox{\hyperlink{namespaceshared__data}{shared\+\_\+data}} module. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p\+\_\+system} & System of interest\+: QHO, H2plus, H2 \\
\hline
\mbox{\texttt{ in}}  & {\em run\+\_\+equil} & Tag for equilibration runs \\
\hline
\mbox{\texttt{ in}}  & {\em run\+\_\+restart} & Tag for restart runs \\
\hline
\mbox{\texttt{ in}}  & {\em write\+\_\+restart} & Tag for writing restart files \\
\hline
\mbox{\texttt{ in}}  & {\em restart\+\_\+step} & Frequency of writing restart files, within MMC loop \\
\hline
\mbox{\texttt{ in}}  & {\em write\+\_\+chains} & Tag to write final MMC chains \\
\hline
\mbox{\texttt{ in}}  & {\em write\+\_\+log} & Tag to write logfile \\
\hline
\end{DoxyParams}


Definition at line 48 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{49 }
\DoxyCodeLine{50         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{51         \textcolor{keywordtype}{character(len=10)}, \textcolor{keywordtype}{intent(out)} :: p\_system}
\DoxyCodeLine{52         \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(out)} :: run\_equil, run\_restart, write\_restart, write\_chains, write\_log}
\DoxyCodeLine{53         \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{intent(out)} :: restart\_step    }
\DoxyCodeLine{54 }
\DoxyCodeLine{55         \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{56         namelist /control/ p\_system, run\_equil, run\_restart, write\_restart, restart\_step, write\_chains, write\_log}
\DoxyCodeLine{57 }
\DoxyCodeLine{58         \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{59         \textcolor{keyword}{read}(nml=control, iostat=rc, unit=fu)}
\DoxyCodeLine{60         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{61             error stop \textcolor{stringliteral}{'Error: Invalid CONTROL namelist format in file "{}params.txt"{}.'}}
\DoxyCodeLine{62 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{63         }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}\label{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}} 
\index{input\_parser@{input\_parser}!read\_qho@{read\_qho}}
\index{read\_qho@{read\_qho}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_qho()}{read\_qho()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+qho (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1qho__type}{qho\+\_\+type}}), intent(out)}]{QHO }\end{DoxyParamCaption})}



Reads the PARAMETER namelist in params.\+txt for the QHO system. Assigns the input data to the corresponding variables in the QHO derived type. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em QHO} & Instance of QHO\+\_\+type, to store input parameter values \\
\hline
\end{DoxyParams}


Definition at line 77 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{78 }
\DoxyCodeLine{79         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{80         \textcolor{keywordtype}{type}(QHO\_type), \textcolor{keywordtype}{intent(out)} :: QHO}
\DoxyCodeLine{81 }
\DoxyCodeLine{82         \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{83         namelist /parameters/ qho}
\DoxyCodeLine{84 }
\DoxyCodeLine{85         \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{86         \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{87         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{88             error stop \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for QHO p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{89 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{90         }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}\label{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}} 
\index{input\_parser@{input\_parser}!read\_h2plus@{read\_h2plus}}
\index{read\_h2plus@{read\_h2plus}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_h2plus()}{read\_h2plus()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+h2plus (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1h2plus__type}{h2plus\+\_\+type}}), intent(out)}]{H2plus }\end{DoxyParamCaption})}



Reads the PARAMETER namelist in params.\+txt for the H2 ion system. Assigns the input data to the corresponding variables in the QHO derived type. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em QHO} & Instance of QHO\+\_\+type, to store input parameter values \\
\hline
\end{DoxyParams}


Definition at line 104 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{105 }
\DoxyCodeLine{106         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{107         \textcolor{keywordtype}{type}(H2plus\_type), \textcolor{keywordtype}{intent(out)} :: H2plus}
\DoxyCodeLine{108 }
\DoxyCodeLine{109         \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{110         namelist /parameters/ h2plus}
\DoxyCodeLine{111 }
\DoxyCodeLine{112         \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{113         \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{114         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{115             error stop \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for H2plus p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{116 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{117         }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}\label{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}} 
\index{input\_parser@{input\_parser}!read\_h2@{read\_h2}}
\index{read\_h2@{read\_h2}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_h2()}{read\_h2()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+h2 (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1h2__type}{h2\+\_\+type}}), intent(out)}]{H2 }\end{DoxyParamCaption})}



Reads the PARAMETER namelist in params.\+txt for the H2 molecule system. Assigns the input data to the corresponding variables in the QHO derived type. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em QHO} & Instance of QHO\+\_\+type, to store input parameter values \\
\hline
\end{DoxyParams}


Definition at line 131 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{132 }
\DoxyCodeLine{133         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{134         \textcolor{keywordtype}{type}(H2\_type), \textcolor{keywordtype}{intent(out)} :: H2}
\DoxyCodeLine{135 }
\DoxyCodeLine{136         \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{137         namelist /parameters/ h2}
\DoxyCodeLine{138 }
\DoxyCodeLine{139         \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{140         \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{141         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{142             error stop \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for H2 p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{143 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{144         }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}\label{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}} 
\index{input\_parser@{input\_parser}!read\_inputs@{read\_inputs}}
\index{read\_inputs@{read\_inputs}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_inputs()}{read\_inputs()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+inputs}



Main input parser function that reads the input file params.\+txt and calls the required namelist parser subroutines, depending on the system. 

This sunroutine also sets the default parameters for equilibration runs, and calls the restart namelist reader when required. 

Definition at line 164 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{165 }
\DoxyCodeLine{166         \textcolor{comment}{! Check if file 'params.txt' exists}}
\DoxyCodeLine{167         \textcolor{keyword}{inquire}(file=\textcolor{stringliteral}{'params.txt'}, iostat=rc)}
\DoxyCodeLine{168         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{169             error stop \textcolor{stringliteral}{'Error: Input file "{}params.txt"{} does not exist.'}}
\DoxyCodeLine{170 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{171 }
\DoxyCodeLine{172         \textcolor{comment}{! Open the params.txt file}}
\DoxyCodeLine{173         \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{174 }
\DoxyCodeLine{175         \textcolor{comment}{! Read CONTROL namelist}}
\DoxyCodeLine{176         \textcolor{keyword}{call }read\_control(p\_system, run\_equil, run\_restart, write\_restart\textcolor{comment}{, restart\_step, write\_chains, write\_log)}}
\DoxyCodeLine{177 \textcolor{comment}{}}
\DoxyCodeLine{178         \textcolor{comment}{! If p\_system='test', return to main}}
\DoxyCodeLine{179         \textcolor{keywordflow}{if} (trim(p\_system)==\textcolor{stringliteral}{'test'}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{180             \textcolor{keywordflow}{return}}
\DoxyCodeLine{181 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{182         }
\DoxyCodeLine{183         \textcolor{comment}{! For equilibration runs, modify the defaults}}
\DoxyCodeLine{184         \textcolor{keywordflow}{if} (run\_equil) \textcolor{keywordflow}{then}}
\DoxyCodeLine{185             \textcolor{keywordflow}{select case} (trim(p\_system))}
\DoxyCodeLine{186             \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'QHO'})}
\DoxyCodeLine{187                 qho\%steps = 20000}
\DoxyCodeLine{188                 qho\%burn\_step = 0}
\DoxyCodeLine{189                 qho\%thin\_step = 1}
\DoxyCodeLine{190             \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2plus'})}
\DoxyCodeLine{191                 h2plus\%steps = 20000}
\DoxyCodeLine{192                 h2plus\%burn\_step = 0}
\DoxyCodeLine{193                 h2plus\%thin\_step = 1}
\DoxyCodeLine{194             \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2'})}
\DoxyCodeLine{195                 h2\%steps = 20000}
\DoxyCodeLine{196                 h2\%burn\_step = 0}
\DoxyCodeLine{197                 h2\%thin\_step = 1}
\DoxyCodeLine{198 \textcolor{keywordflow}{            case default}}
\DoxyCodeLine{199                 error stop \textcolor{stringliteral}{'Error: Invalid system definition.'}}
\DoxyCodeLine{200 \textcolor{keywordflow}{            end select}}
\DoxyCodeLine{201 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{202 }
\DoxyCodeLine{203         \textcolor{comment}{! Read PARAMETERS namelist of the defined problem}}
\DoxyCodeLine{204         \textcolor{keywordflow}{select case} (trim(p\_system))}
\DoxyCodeLine{205         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'QHO'})}
\DoxyCodeLine{206             \textcolor{keyword}{call }read\_qho(qho)}
\DoxyCodeLine{207         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2plus'})}
\DoxyCodeLine{208             \textcolor{keyword}{call }read\_h2plus(h2plus)}
\DoxyCodeLine{209         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2'})}
\DoxyCodeLine{210             \textcolor{keyword}{call }read\_h2(h2)}
\DoxyCodeLine{211 \textcolor{keywordflow}{        case default}}
\DoxyCodeLine{212             error stop \textcolor{stringliteral}{'Error: Invalid system definition.'}}
\DoxyCodeLine{213 \textcolor{keywordflow}{        end select}}
\DoxyCodeLine{214 }
\DoxyCodeLine{215         \textcolor{comment}{! Close the params.txt file}}
\DoxyCodeLine{216         \textcolor{keyword}{close}(fu)}
\DoxyCodeLine{217 }
\DoxyCodeLine{218         \textcolor{comment}{! For restart runs}}
\DoxyCodeLine{219         \textcolor{keywordflow}{if} (run\_restart) \textcolor{keywordflow}{then}}
\DoxyCodeLine{220 }
\DoxyCodeLine{221             \textcolor{comment}{! Read RESTART namelist}}
\DoxyCodeLine{222             \textcolor{keyword}{call }read\_res\_nml(res)}
\DoxyCodeLine{223 }
\DoxyCodeLine{224             \textcolor{comment}{! Update grid-\/loop start values}}
\DoxyCodeLine{225             \textcolor{comment}{! TO DO: Remove res\%step if James confirms that chain-\/restarts are not required.}}
\DoxyCodeLine{226             \textcolor{keywordflow}{if} (trim(p\_system) == \textcolor{stringliteral}{'QHO'}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{227                 \textcolor{keywordflow}{if} (res\%step == 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{228                     alpha\_start = res\%i\_alpha}
\DoxyCodeLine{229                 \textcolor{keywordflow}{else} }
\DoxyCodeLine{230                     alpha\_start = res\%i\_alpha+1}
\DoxyCodeLine{231 \textcolor{keywordflow}{                endif} }
\DoxyCodeLine{232             \textcolor{keywordflow}{else} }
\DoxyCodeLine{233                 \textcolor{keywordflow}{if} (res\%step == 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{234                     bond\_start = res\%i\_bond}
\DoxyCodeLine{235                 \textcolor{keywordflow}{else} }
\DoxyCodeLine{236                     bond\_start = res\%i\_bond+1}
\DoxyCodeLine{237 \textcolor{keywordflow}{                endif} }
\DoxyCodeLine{238 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{239 }
\DoxyCodeLine{240             \textcolor{comment}{! Print restarts header.}}
\DoxyCodeLine{241             \textcolor{keyword}{write}(*, \textcolor{stringliteral}{"{}('-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Restarted Program -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/')"{}}\textcolor{comment}{)}}
\DoxyCodeLine{242 \textcolor{comment}{}            \textcolor{keyword}{write}(*, \textcolor{stringliteral}{"{}('')"{}})}
\DoxyCodeLine{243 }
\DoxyCodeLine{244 \textcolor{keywordflow}{        end if} }
\DoxyCodeLine{245 }
\DoxyCodeLine{246 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea_icgraph}
\end{center}
\end{figure}
