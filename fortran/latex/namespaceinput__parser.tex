\hypertarget{namespaceinput__parser}{}\doxysection{input\+\_\+parser Module Reference}
\label{namespaceinput__parser}\index{input\_parser@{input\_parser}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}{read\+\_\+control}} (p\+\_\+system, run\+\_\+equil, run\+\_\+restart, write\+\_\+restart, restart\+\_\+step, write\+\_\+chains, write\+\_\+log)
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}{read\+\_\+qho}} (QHO)
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}{read\+\_\+h2plus}} (H2plus)
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}{read\+\_\+h2}} (H2)
\item 
subroutine \mbox{\hyperlink{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}{read\+\_\+inputs}} ()
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}\label{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1}} 
\index{input\_parser@{input\_parser}!read\_control@{read\_control}}
\index{read\_control@{read\_control}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_control()}{read\_control()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+control (\begin{DoxyParamCaption}\item[{character(len=10), intent(out)}]{p\+\_\+system,  }\item[{logical, intent(out)}]{run\+\_\+equil,  }\item[{logical, intent(out)}]{run\+\_\+restart,  }\item[{logical, intent(out)}]{write\+\_\+restart,  }\item[{integer(int32), intent(out)}]{restart\+\_\+step,  }\item[{logical, intent(out)}]{write\+\_\+chains,  }\item[{logical, intent(out)}]{write\+\_\+log }\end{DoxyParamCaption})}



Definition at line 14 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{15 }
\DoxyCodeLine{16     \textcolor{comment}{! Local variables}}
\DoxyCodeLine{17     \textcolor{keywordtype}{character(len=10)}, \textcolor{keywordtype}{intent(out)} :: p\_system}
\DoxyCodeLine{18     \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{intent(out)} :: run\_equil, run\_restart, write\_restart, write\_chains, write\_log}
\DoxyCodeLine{19     \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{intent(out)} :: restart\_step    }
\DoxyCodeLine{20 }
\DoxyCodeLine{21     \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{22     namelist /control/ p\_system, run\_equil, run\_restart, write\_restart, restart\_step, write\_chains, write\_log}
\DoxyCodeLine{23 }
\DoxyCodeLine{24     \textcolor{comment}{! Open the file}}
\DoxyCodeLine{25     \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{26 }
\DoxyCodeLine{27     \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{28     \textcolor{keyword}{read}(nml=control, iostat=rc, unit=fu)}
\DoxyCodeLine{29     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{30         error stop \textcolor{stringliteral}{'Error: Invalid CONTROL namelist format in file "{}params.txt"{}.'}}
\DoxyCodeLine{31 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{32     }
\DoxyCodeLine{33     \textcolor{comment}{! Close the file}}
\DoxyCodeLine{34     \textcolor{keyword}{close}(fu)}
\DoxyCodeLine{35 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_ace5694fecca99b0223f02140c750e5f1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}\label{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f}} 
\index{input\_parser@{input\_parser}!read\_qho@{read\_qho}}
\index{read\_qho@{read\_qho}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_qho()}{read\_qho()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+qho (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1qho__type}{qho\+\_\+type}}), intent(out)}]{QHO }\end{DoxyParamCaption})}



Definition at line 39 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     \textcolor{comment}{! Local variables}}
\DoxyCodeLine{42     \textcolor{keywordtype}{type}(QHO\_type), \textcolor{keywordtype}{intent(out)} :: QHO}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{45     namelist /parameters/ qho}
\DoxyCodeLine{46 }
\DoxyCodeLine{47     \textcolor{comment}{! Open the file}}
\DoxyCodeLine{48     \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{51     \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{52     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{53         error stop \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for QHO p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{54 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{55     }
\DoxyCodeLine{56     \textcolor{comment}{! Close the file}}
\DoxyCodeLine{57     \textcolor{keyword}{close}(fu)}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_aa9a77c1395d69d54ce38420acdb3f87f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}\label{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74}} 
\index{input\_parser@{input\_parser}!read\_h2plus@{read\_h2plus}}
\index{read\_h2plus@{read\_h2plus}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_h2plus()}{read\_h2plus()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+h2plus (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1h2plus__type}{h2plus\+\_\+type}}), intent(out)}]{H2plus }\end{DoxyParamCaption})}



Definition at line 61 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{62 }
\DoxyCodeLine{63     \textcolor{comment}{! Local variables}}
\DoxyCodeLine{64     \textcolor{keywordtype}{type}(H2plus\_type), \textcolor{keywordtype}{intent(out)} :: H2plus}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{67     namelist /parameters/ h2plus}
\DoxyCodeLine{68 }
\DoxyCodeLine{69     \textcolor{comment}{! Open the file}}
\DoxyCodeLine{70     \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{73     \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{74     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{75         error stop \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for H2plus p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{76 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{77     }
\DoxyCodeLine{78     \textcolor{comment}{! Close the file}}
\DoxyCodeLine{79     \textcolor{keyword}{close}(fu)}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_a3ebe204fa7f63e19fbf29c36f580ee74_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}\label{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148}} 
\index{input\_parser@{input\_parser}!read\_h2@{read\_h2}}
\index{read\_h2@{read\_h2}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_h2()}{read\_h2()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+h2 (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1h2__type}{h2\+\_\+type}}), intent(out)}]{H2 }\end{DoxyParamCaption})}



Definition at line 83 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{84 }
\DoxyCodeLine{85     \textcolor{comment}{! Local variables}}
\DoxyCodeLine{86     \textcolor{keywordtype}{type}(H2\_type), \textcolor{keywordtype}{intent(out)} :: H2}
\DoxyCodeLine{87 }
\DoxyCodeLine{88     \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{89     namelist /parameters/ h2}
\DoxyCodeLine{90 }
\DoxyCodeLine{91     \textcolor{comment}{! Open the file}}
\DoxyCodeLine{92     \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=\textcolor{stringliteral}{'params.txt'}, iostat=rc, newunit=fu)}
\DoxyCodeLine{93 }
\DoxyCodeLine{94     \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{95     \textcolor{keyword}{read}(nml=parameters, iostat=rc, unit=fu)}
\DoxyCodeLine{96     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{97         error stop \textcolor{stringliteral}{'Error: Invalid PARAMETERS namelist for H2 p\_system in file "{}params.txt"{}.'}}
\DoxyCodeLine{98 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{99     }
\DoxyCodeLine{100     \textcolor{comment}{! Close the file}}
\DoxyCodeLine{101     \textcolor{keyword}{close}(fu)}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceinput__parser_a163a65b1b9201a421da32ba2a7c92148_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}\label{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea}} 
\index{input\_parser@{input\_parser}!read\_inputs@{read\_inputs}}
\index{read\_inputs@{read\_inputs}!input\_parser@{input\_parser}}
\doxysubsubsection{\texorpdfstring{read\_inputs()}{read\_inputs()}}
{\footnotesize\ttfamily subroutine input\+\_\+parser\+::read\+\_\+inputs}



Definition at line 105 of file input\+\_\+parser.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{106 }
\DoxyCodeLine{107     \textcolor{comment}{! Check if file 'params.txt' exists}}
\DoxyCodeLine{108     \textcolor{keyword}{inquire}(file=\textcolor{stringliteral}{'params.txt'}, iostat=rc)}
\DoxyCodeLine{109     \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{110         error stop \textcolor{stringliteral}{'Error: Input file "{}params.txt"{} does not exist.'}}
\DoxyCodeLine{111 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \textcolor{comment}{! Read CONTROL namelist}}
\DoxyCodeLine{114     \textcolor{keyword}{call }read\_control(p\_system, run\_equil, run\_restart, write\_restart, restart\_step, write\_chains, write\_log)}
\DoxyCodeLine{115 }
\DoxyCodeLine{116     \textcolor{comment}{! If p\_system='test', return to main}}
\DoxyCodeLine{117     \textcolor{keywordflow}{if} (trim(p\_system)==\textcolor{stringliteral}{'test'}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{118         \textcolor{keywordflow}{return}}
\DoxyCodeLine{119 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{120     }
\DoxyCodeLine{121     \textcolor{comment}{! For equilibration runs, modify the defaults}}
\DoxyCodeLine{122     \textcolor{keywordflow}{if} (run\_equil) \textcolor{keywordflow}{then}}
\DoxyCodeLine{123         \textcolor{keywordflow}{select case} (trim(p\_system))}
\DoxyCodeLine{124         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'QHO'})}
\DoxyCodeLine{125             qho\%steps = 20000}
\DoxyCodeLine{126             qho\%burn\_step = 0}
\DoxyCodeLine{127             qho\%thin\_step = 1}
\DoxyCodeLine{128         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2plus'})}
\DoxyCodeLine{129             h2plus\%steps = 20000}
\DoxyCodeLine{130             h2plus\%burn\_step = 0}
\DoxyCodeLine{131             h2plus\%thin\_step = 1}
\DoxyCodeLine{132         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2'})}
\DoxyCodeLine{133             h2\%steps = 20000}
\DoxyCodeLine{134             h2\%burn\_step = 0}
\DoxyCodeLine{135             h2\%thin\_step = 1}
\DoxyCodeLine{136 \textcolor{keywordflow}{        case default}}
\DoxyCodeLine{137             error stop \textcolor{stringliteral}{'Error: Invalid system definition.'}}
\DoxyCodeLine{138 \textcolor{keywordflow}{        end select}}
\DoxyCodeLine{139 \textcolor{keywordflow}{    endif}}
\DoxyCodeLine{140 }
\DoxyCodeLine{141     \textcolor{comment}{! Read PARAMETERS namelist of the defined problem}}
\DoxyCodeLine{142     \textcolor{keywordflow}{select case} (trim(p\_system))}
\DoxyCodeLine{143     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'QHO'})}
\DoxyCodeLine{144         \textcolor{keyword}{call }read\_qho(qho)}
\DoxyCodeLine{145     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2plus'})}
\DoxyCodeLine{146         \textcolor{keyword}{call }read\_h2plus(h2plus)}
\DoxyCodeLine{147     \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2'})}
\DoxyCodeLine{148         \textcolor{keyword}{call }read\_h2(h2)}
\DoxyCodeLine{149 \textcolor{keywordflow}{    case default}}
\DoxyCodeLine{150         error stop \textcolor{stringliteral}{'Error: Invalid system definition.'}}
\DoxyCodeLine{151 \textcolor{keywordflow}{    end select}}
\DoxyCodeLine{152 }
\DoxyCodeLine{153     \textcolor{comment}{! For restart runs}}
\DoxyCodeLine{154     \textcolor{keywordflow}{if} (run\_restart) \textcolor{keywordflow}{then}}
\DoxyCodeLine{155 }
\DoxyCodeLine{156         \textcolor{comment}{! Read RESTART namelist}}
\DoxyCodeLine{157         \textcolor{keyword}{call }read\_res\_nml(res)}
\DoxyCodeLine{158 }
\DoxyCodeLine{159         \textcolor{comment}{! Update grid-\/loop start values}}
\DoxyCodeLine{160         \textcolor{comment}{! TO DO: Remove res\%step if James confirms that chain-\/restarts are not required.}}
\DoxyCodeLine{161         \textcolor{keywordflow}{if} (trim(p\_system) == \textcolor{stringliteral}{'QHO'}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{162             \textcolor{keywordflow}{if} (res\%step == 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{163                 alpha\_start = res\%i\_alpha}
\DoxyCodeLine{164             \textcolor{keywordflow}{else} }
\DoxyCodeLine{165                 alpha\_start = res\%i\_alpha+1}
\DoxyCodeLine{166 \textcolor{keywordflow}{            endif} }
\DoxyCodeLine{167         \textcolor{keywordflow}{else} }
\DoxyCodeLine{168             \textcolor{keywordflow}{if} (res\%step == 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{169                 bond\_start = res\%i\_bond}
\DoxyCodeLine{170             \textcolor{keywordflow}{else} }
\DoxyCodeLine{171                 bond\_start = res\%i\_bond+1}
\DoxyCodeLine{172 \textcolor{keywordflow}{            endif} }
\DoxyCodeLine{173 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{174 }
\DoxyCodeLine{175         \textcolor{comment}{! Print restarts header.}}
\DoxyCodeLine{176         \textcolor{keyword}{write}(*, \textcolor{stringliteral}{"{}('-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Restarted Program -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/')"{}})}
\DoxyCodeLine{177         \textcolor{keyword}{write}(*, \textcolor{stringliteral}{"{}('')"{}})}
\DoxyCodeLine{178 }
\DoxyCodeLine{179 \textcolor{keywordflow}{    end if} }
\DoxyCodeLine{180 }
\DoxyCodeLine{181 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{namespaceinput__parser_a3c35b8a909f420e7aa4f19d1392d74ea_icgraph}
\end{center}
\end{figure}
