\hypertarget{namespacerestart__fns}{}\doxysection{restart\+\_\+fns Module Reference}
\label{namespacerestart__fns}\index{restart\_fns@{restart\_fns}}


Contains routines to read and write restart files.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_a08fcc6eaab415d68620bccc8048b610e}{write\+\_\+res\+\_\+nml}} (i\+\_\+qoi, i\+\_\+par, auto, guess)
\begin{DoxyCompactList}\small\item\em Writes the restart file res\+\_\+nml.\+txt, using the current states of simulation variables. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_a34c01a8b391a8c3a4ba40e9f5ec644d3}{read\+\_\+res\+\_\+nml}} (res)
\begin{DoxyCompactList}\small\item\em Reads the RESTART namelist in res\+\_\+nml.\+txt. Assigns the input data to the corresponding variables in the restart derived type instance \textquotesingle{}res\textquotesingle{}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_a23054262d0eeb017dee69fd5f9ca1250}{error\+\_\+check}} (ierr)
\begin{DoxyCompactList}\small\item\em Checks error status at each point of the Net\+CDF read. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_a828b3e20a4454d53f3e9f89cb80ba310}{read\+\_\+energies}} (filename, energies, variances, accept\+\_\+rates)
\begin{DoxyCompactList}\small\item\em Reads restart files with energies, variances and acceptence arrays. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_a22e2a14111f6a4ff686f7f7b2b47f206}{read\+\_\+energies\+\_\+h2plus}} (filename, energies, variances, accept\+\_\+rates, c\+\_\+array)
\begin{DoxyCompactList}\small\item\em Reads restart files with energies, variances and acceptence arrays. Also reads one extra array of optimized \textquotesingle{}c\textquotesingle{} parameters for H2plus problem. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_aa562723430cab2682d10733e3a48bb7d}{read\+\_\+energies\+\_\+h2}} (filename, energies, variances, accept\+\_\+rates, a\+\_\+array, b\+\_\+array)
\begin{DoxyCompactList}\small\item\em Reads restart files with energies, variances and acceptence arrays. Also reads two extra arrays of optimized parameters (\textquotesingle{}a\textquotesingle{} and \textquotesingle{}beta\textquotesingle{}) for H2 problem. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer \mbox{\hyperlink{namespacerestart__fns_abae4eaf545561c534bc832e303c47b4b}{fu}}
\begin{DoxyCompactList}\small\item\em To store LUN of files during i/o. \end{DoxyCompactList}\item 
integer \mbox{\hyperlink{namespacerestart__fns_ab386c6b0f14be0090063a054256f5923}{rc}}
\begin{DoxyCompactList}\small\item\em To capture error states during file i/o. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains routines to read and write restart files. 

Contains subroutines to read and write the RESTART namelist in the res\+\_\+nml.\+txt restart file. Also contains subroutines that read the Net\+CDF files storing the restart history of either total energies or parameter energies. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacerestart__fns_a08fcc6eaab415d68620bccc8048b610e}\label{namespacerestart__fns_a08fcc6eaab415d68620bccc8048b610e}} 
\index{restart\_fns@{restart\_fns}!write\_res\_nml@{write\_res\_nml}}
\index{write\_res\_nml@{write\_res\_nml}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{write\_res\_nml()}{write\_res\_nml()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::write\+\_\+res\+\_\+nml (\begin{DoxyParamCaption}\item[{integer(int32), intent(in)}]{i\+\_\+qoi,  }\item[{integer(int32), intent(in), optional}]{i\+\_\+par,  }\item[{logical, intent(in), optional}]{auto,  }\item[{real(real64), intent(in), optional}]{guess }\end{DoxyParamCaption})}



Writes the restart file res\+\_\+nml.\+txt, using the current states of simulation variables. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em iqoi} & Index of last grid point of alpha (for QHO)or bond (for H2plus or H2) \\
\hline
\mbox{\texttt{ in}}  & {\em auto} & Boolean indicating if auto\+\_\+params is turned on or not (for H2plus or H2) \\
\hline
\mbox{\texttt{ in}}  & {\em i\+\_\+par} & Index of last grid-\/point or auto-\/search iteration of c or beta (for H2plus or H2) \\
\hline
\mbox{\texttt{ in}}  & {\em guess} & For auto-\/search, last guess value for c or beta (for H2plus or H2) \\
\hline
\end{DoxyParams}


Definition at line 47 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{48 }
\DoxyCodeLine{49         \textcolor{comment}{! Uses the following global variables: p\_system, p}}
\DoxyCodeLine{50         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{51         \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{intent(in)}           :: i\_qoi     \textcolor{comment}{! current index on alpha (for QHO) or bond (for Hyd) grid}}
\DoxyCodeLine{52         \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{optional}, \textcolor{keywordtype}{intent(in)} :: i\_par     \textcolor{comment}{! current index of c (for H2plus) or beta (for H2)}}
\DoxyCodeLine{53         \textcolor{keywordtype}{logical}, \textcolor{keywordtype}{optional},\textcolor{keywordtype}{intent(in)}         :: auto      \textcolor{comment}{! indicates if auto\_params is turned on, for H2plus or H2}}
\DoxyCodeLine{54 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{optional}, \textcolor{keywordtype}{intent(in)}   :: guess     \textcolor{comment}{! for auto-\/search, current guess value for c (for H2plus) or beta (for H2)}}
\DoxyCodeLine{55         \textcolor{keywordtype}{type}(restart\_type) :: res}
\DoxyCodeLine{56         }
\DoxyCodeLine{57         \textcolor{comment}{! Define the namelists}}
\DoxyCodeLine{58         namelist /restart/ res}
\DoxyCodeLine{59 }
\DoxyCodeLine{60         \textcolor{comment}{! Store grid point of quantity of interest (qoi)}}
\DoxyCodeLine{61         res\%i\_qoi = i\_qoi}
\DoxyCodeLine{62 }
\DoxyCodeLine{63         \textcolor{comment}{! Check if the required optional parameters are present, and store them in res}}
\DoxyCodeLine{64         \textcolor{keywordflow}{if} (p\_system==\textcolor{stringliteral}{'H2plus'} .or. p\_system==\textcolor{stringliteral}{'H2'}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66             \textcolor{keywordflow}{if} (.not.(\textcolor{keyword}{present}(i\_par))) error stop \textcolor{stringliteral}{'Error: Missing "{}i\_par"{} input to function write\_res\_nml().'}}
\DoxyCodeLine{67             res\%i\_par = i\_par}
\DoxyCodeLine{68 }
\DoxyCodeLine{69             \textcolor{keywordflow}{if} (.not.(\textcolor{keyword}{present}(auto))) error stop \textcolor{stringliteral}{'Error: Missing "{}auto"{} input to function write\_res\_nml().'}}
\DoxyCodeLine{70             res\%auto = auto}
\DoxyCodeLine{71         }
\DoxyCodeLine{72             \textcolor{keywordflow}{if} (auto) \textcolor{keywordflow}{then}}
\DoxyCodeLine{73                 \textcolor{keywordflow}{if} (.not.(\textcolor{keyword}{present}(guess))) error stop \textcolor{stringliteral}{'Error: Missing "{}guess"{} input to function write\_res\_nml().'}}
\DoxyCodeLine{74                 res\%guess = guess}
\DoxyCodeLine{75 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79         \textcolor{comment}{! Open the res\_nml.txt file}}
\DoxyCodeLine{80         \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'write'}, file=resfile\_nml, iostat=rc, newunit=fu)}
\DoxyCodeLine{81 }
\DoxyCodeLine{82         \textcolor{comment}{! Write the RESTART namelist}}
\DoxyCodeLine{83         \textcolor{keyword}{write}(nml=restart, iostat=rc, unit=fu)}
\DoxyCodeLine{84         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{85             error stop \textcolor{stringliteral}{'Error: Invalid RESTART namelist defined in function write\_res\_nml().'}}
\DoxyCodeLine{86 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{87         }
\DoxyCodeLine{88         \textcolor{comment}{! Close the res\_nml.txt file}}
\DoxyCodeLine{89         \textcolor{keyword}{close}(fu)}
\DoxyCodeLine{90 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=320pt]{namespacerestart__fns_a08fcc6eaab415d68620bccc8048b610e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacerestart__fns_a34c01a8b391a8c3a4ba40e9f5ec644d3}\label{namespacerestart__fns_a34c01a8b391a8c3a4ba40e9f5ec644d3}} 
\index{restart\_fns@{restart\_fns}!read\_res\_nml@{read\_res\_nml}}
\index{read\_res\_nml@{read\_res\_nml}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{read\_res\_nml()}{read\_res\_nml()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::read\+\_\+res\+\_\+nml (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1restart__type}{restart\+\_\+type}}), intent(out)}]{res }\end{DoxyParamCaption})}



Reads the RESTART namelist in res\+\_\+nml.\+txt. Assigns the input data to the corresponding variables in the restart derived type instance \textquotesingle{}res\textquotesingle{}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em resvals} & Instance of restart\+\_\+type, to store restart parameter values \\
\hline
\end{DoxyParams}


Definition at line 110 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{111 }
\DoxyCodeLine{112         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{113         \textcolor{keywordtype}{type}(restart\_type), \textcolor{keywordtype}{intent(out)} :: res}
\DoxyCodeLine{114 }
\DoxyCodeLine{115         \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{116         namelist /restart/ res}
\DoxyCodeLine{117 }
\DoxyCodeLine{118         \textcolor{comment}{! Check if file exists}}
\DoxyCodeLine{119         \textcolor{keyword}{inquire}(file=resfile\_nml, iostat=rc)}
\DoxyCodeLine{120         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{121             print*, \textcolor{stringliteral}{'Searched for file '}, resfile\_nml, \textcolor{stringliteral}{' .'}}
\DoxyCodeLine{122             error stop \textcolor{stringliteral}{'Error: This restart file is not present in the current directory.'}}
\DoxyCodeLine{123 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125         \textcolor{comment}{! Open the file}}
\DoxyCodeLine{126         \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=resfile\_nml, iostat=rc, newunit=fu)}
\DoxyCodeLine{127 }
\DoxyCodeLine{128         \textcolor{comment}{! Read the RESTART namelist}}
\DoxyCodeLine{129         \textcolor{keyword}{read}(nml=restart, iostat=rc, unit=fu)}
\DoxyCodeLine{130         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{131             error stop \textcolor{stringliteral}{'Error: Invalid RESTART namelist in "{}res\_nml.txt"{}.'}}
\DoxyCodeLine{132 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{133         }
\DoxyCodeLine{134         \textcolor{comment}{! Close the file}}
\DoxyCodeLine{135         \textcolor{keyword}{close}(fu)}
\DoxyCodeLine{136 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacerestart__fns_a34c01a8b391a8c3a4ba40e9f5ec644d3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacerestart__fns_a23054262d0eeb017dee69fd5f9ca1250}\label{namespacerestart__fns_a23054262d0eeb017dee69fd5f9ca1250}} 
\index{restart\_fns@{restart\_fns}!error\_check@{error\_check}}
\index{error\_check@{error\_check}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{error\_check()}{error\_check()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::error\+\_\+check (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ierr }\end{DoxyParamCaption})}



Checks error status at each point of the Net\+CDF read. 

Will print error message/code corresponding to ierr input. Copied from module write\+\_\+net\+CDF.\+f90. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ierr} & Internal error value \\
\hline
\end{DoxyParams}


Definition at line 152 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{153         \textcolor{keywordtype}{integer},\textcolor{keywordtype}{intent(in)} :: ierr}
\DoxyCodeLine{154         \textcolor{keywordflow}{if} (ierr /= nf90\_noerr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{155             print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{156             \textcolor{keywordflow}{return}}
\DoxyCodeLine{157 \textcolor{keywordflow}{        endif}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacerestart__fns_a23054262d0eeb017dee69fd5f9ca1250_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacerestart__fns_a828b3e20a4454d53f3e9f89cb80ba310}\label{namespacerestart__fns_a828b3e20a4454d53f3e9f89cb80ba310}} 
\index{restart\_fns@{restart\_fns}!read\_energies@{read\_energies}}
\index{read\_energies@{read\_energies}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{read\_energies()}{read\_energies()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::read\+\_\+energies (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{energies,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{variances,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{accept\+\_\+rates }\end{DoxyParamCaption})}



Reads restart files with energies, variances and acceptence arrays. 

Assigns the data arrays it reads to the corresponding array variables passed to it. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em filename} & Name of the Net\+CDF restart file with required energies \\
\hline
\mbox{\texttt{ in}}  & {\em energies} & Array to store restart energies \\
\hline
\mbox{\texttt{ in}}  & {\em variances} & Array to store restart variances \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rates} & Array to store restart acceptence rates \\
\hline
\end{DoxyParams}


Definition at line 176 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{177 }
\DoxyCodeLine{178         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{179         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{180 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{intent(out)} :: energies, variances, accept\_rates}
\DoxyCodeLine{181         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id}
\DoxyCodeLine{182 }
\DoxyCodeLine{183         \textcolor{comment}{! Check if file exists}}
\DoxyCodeLine{184         \textcolor{keyword}{inquire}(file=filename, iostat=rc)}
\DoxyCodeLine{185         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{186             print*, \textcolor{stringliteral}{'Searched for file '}, filename, \textcolor{stringliteral}{' .'}}
\DoxyCodeLine{187             error stop \textcolor{stringliteral}{'Error: This restart file is not present in the current directory.'}}
\DoxyCodeLine{188 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{189 }
\DoxyCodeLine{190         \textcolor{comment}{! Open restart netCDF file}}
\DoxyCodeLine{191         ierr = nf90\_open(filename, nf90\_nowrite, file\_id)}
\DoxyCodeLine{192         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{193 }
\DoxyCodeLine{194         \textcolor{comment}{! Get var\_id for energies}}
\DoxyCodeLine{195         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}total\_energies"{}}, var\_id)}
\DoxyCodeLine{196         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{197 }
\DoxyCodeLine{198         \textcolor{comment}{! Read the energies}}
\DoxyCodeLine{199         ierr = nf90\_get\_var(file\_id, var\_id, energies)}
\DoxyCodeLine{200         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{201 }
\DoxyCodeLine{202         \textcolor{comment}{! Get var\_id for variances}}
\DoxyCodeLine{203         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}Uncertainties"{}}, var\_id)}
\DoxyCodeLine{204         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{205 }
\DoxyCodeLine{206         \textcolor{comment}{! Read the variances}}
\DoxyCodeLine{207         ierr = nf90\_get\_var(file\_id, var\_id, variances)}
\DoxyCodeLine{208         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{209 }
\DoxyCodeLine{210         \textcolor{comment}{! Get attribute accept\_rate}}
\DoxyCodeLine{211         ierr = nf90\_get\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rates)}
\DoxyCodeLine{212         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{213         }
\DoxyCodeLine{214         \textcolor{comment}{! Close the file}}
\DoxyCodeLine{215         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{216         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{217 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{namespacerestart__fns_a828b3e20a4454d53f3e9f89cb80ba310_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacerestart__fns_a828b3e20a4454d53f3e9f89cb80ba310_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacerestart__fns_a22e2a14111f6a4ff686f7f7b2b47f206}\label{namespacerestart__fns_a22e2a14111f6a4ff686f7f7b2b47f206}} 
\index{restart\_fns@{restart\_fns}!read\_energies\_h2plus@{read\_energies\_h2plus}}
\index{read\_energies\_h2plus@{read\_energies\_h2plus}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{read\_energies\_h2plus()}{read\_energies\_h2plus()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::read\+\_\+energies\+\_\+h2plus (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{energies,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{variances,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{accept\+\_\+rates,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{c\+\_\+array }\end{DoxyParamCaption})}



Reads restart files with energies, variances and acceptence arrays. Also reads one extra array of optimized \textquotesingle{}c\textquotesingle{} parameters for H2plus problem. 

Assigns the data arrays it reads to the corresponding array variables passed to it. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em filename} & Name of the Net\+CDF restart file with required energies \\
\hline
\mbox{\texttt{ in}}  & {\em energies} & Array to store restart energies \\
\hline
\mbox{\texttt{ in}}  & {\em variances} & Array to store restart variances \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rates} & Array to store restart acceptence rates \\
\hline
\mbox{\texttt{ in}}  & {\em c\+\_\+array} & Array to store optimized c-\/values for each bondlength \\
\hline
\end{DoxyParams}


Definition at line 238 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{239 }
\DoxyCodeLine{240         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{241         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{242 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{intent(out)} :: energies, variances, accept\_rates, c\_array}
\DoxyCodeLine{243         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id}
\DoxyCodeLine{244 }
\DoxyCodeLine{245         \textcolor{comment}{! Check if file exists}}
\DoxyCodeLine{246         \textcolor{keyword}{inquire}(file=filename, iostat=rc)}
\DoxyCodeLine{247         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{248             print*, \textcolor{stringliteral}{'Searched for file '}, filename, \textcolor{stringliteral}{' .'}}
\DoxyCodeLine{249             error stop \textcolor{stringliteral}{'Error: This restart file is not present in the current directory.'}}
\DoxyCodeLine{250 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{251 }
\DoxyCodeLine{252         \textcolor{comment}{! Open restart netCDF file}}
\DoxyCodeLine{253         ierr = nf90\_open(filename, nf90\_nowrite, file\_id)}
\DoxyCodeLine{254         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{255 }
\DoxyCodeLine{256         \textcolor{comment}{! Get var\_id for energies}}
\DoxyCodeLine{257         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}total\_energies"{}}, var\_id)}
\DoxyCodeLine{258         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{259 }
\DoxyCodeLine{260         \textcolor{comment}{! Read the energies}}
\DoxyCodeLine{261         ierr = nf90\_get\_var(file\_id, var\_id, energies)}
\DoxyCodeLine{262         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{263 }
\DoxyCodeLine{264         \textcolor{comment}{! Get var\_id for variances}}
\DoxyCodeLine{265         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}Uncertainties"{}}, var\_id)}
\DoxyCodeLine{266         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{267 }
\DoxyCodeLine{268         \textcolor{comment}{! Read the variances}}
\DoxyCodeLine{269         ierr = nf90\_get\_var(file\_id, var\_id, variances)}
\DoxyCodeLine{270         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{271 }
\DoxyCodeLine{272         \textcolor{comment}{! Get var\_id for c\_array}}
\DoxyCodeLine{273         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}Parameter\_array"{}}, var\_id)}
\DoxyCodeLine{274         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{275 }
\DoxyCodeLine{276         \textcolor{comment}{! Read the c\_array}}
\DoxyCodeLine{277         ierr = nf90\_get\_var(file\_id, var\_id, c\_array)}
\DoxyCodeLine{278         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{279 }
\DoxyCodeLine{280         \textcolor{comment}{! Get attribute accept\_rate}}
\DoxyCodeLine{281         ierr = nf90\_get\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rates)}
\DoxyCodeLine{282         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{283         }
\DoxyCodeLine{284         \textcolor{comment}{! Close the file}}
\DoxyCodeLine{285         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{286         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{287 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{namespacerestart__fns_a22e2a14111f6a4ff686f7f7b2b47f206_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacerestart__fns_a22e2a14111f6a4ff686f7f7b2b47f206_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacerestart__fns_aa562723430cab2682d10733e3a48bb7d}\label{namespacerestart__fns_aa562723430cab2682d10733e3a48bb7d}} 
\index{restart\_fns@{restart\_fns}!read\_energies\_h2@{read\_energies\_h2}}
\index{read\_energies\_h2@{read\_energies\_h2}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{read\_energies\_h2()}{read\_energies\_h2()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::read\+\_\+energies\+\_\+h2 (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{energies,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{variances,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{accept\+\_\+rates,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{a\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{b\+\_\+array }\end{DoxyParamCaption})}



Reads restart files with energies, variances and acceptence arrays. Also reads two extra arrays of optimized parameters (\textquotesingle{}a\textquotesingle{} and \textquotesingle{}beta\textquotesingle{}) for H2 problem. 

Assigns the data arrays it reads to the corresponding array variables passed to it. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em filename} & Name of the Net\+CDF restart file with required energies \\
\hline
\mbox{\texttt{ in}}  & {\em energies} & Array to store restart energies \\
\hline
\mbox{\texttt{ in}}  & {\em variances} & Array to store restart variances \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rates} & Array to store restart acceptence rates \\
\hline
\mbox{\texttt{ in}}  & {\em a\+\_\+array} & Array to store optimized a-\/values for each bondlength \\
\hline
\mbox{\texttt{ in}}  & {\em b\+\_\+array} & Array to store optimized beta-\/values for each bondlength \\
\hline
\end{DoxyParams}


Definition at line 309 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{310 }
\DoxyCodeLine{311         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{312         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{313 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{intent(out)} :: energies, variances, accept\_rates, a\_array, b\_array}
\DoxyCodeLine{314         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id}
\DoxyCodeLine{315 }
\DoxyCodeLine{316         \textcolor{comment}{! Check if file exists}}
\DoxyCodeLine{317         \textcolor{keyword}{inquire}(file=filename, iostat=rc)}
\DoxyCodeLine{318         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{319             print*, \textcolor{stringliteral}{'Searched for file '}, filename, \textcolor{stringliteral}{' .'}}
\DoxyCodeLine{320             error stop \textcolor{stringliteral}{'Error: This restart file is not present in the current directory.'}}
\DoxyCodeLine{321 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{322 }
\DoxyCodeLine{323         \textcolor{comment}{! Open restart netCDF file}}
\DoxyCodeLine{324         ierr = nf90\_open(filename, nf90\_nowrite, file\_id)}
\DoxyCodeLine{325         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{326 }
\DoxyCodeLine{327         \textcolor{comment}{! Get var\_id for energies}}
\DoxyCodeLine{328         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}total\_energies"{}}, var\_id)}
\DoxyCodeLine{329         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{330 }
\DoxyCodeLine{331         \textcolor{comment}{! Read the energies}}
\DoxyCodeLine{332         ierr = nf90\_get\_var(file\_id, var\_id, energies)}
\DoxyCodeLine{333         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{334 }
\DoxyCodeLine{335         \textcolor{comment}{! Get var\_id for variances}}
\DoxyCodeLine{336         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}Uncertainties"{}}, var\_id)}
\DoxyCodeLine{337         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{338 }
\DoxyCodeLine{339         \textcolor{comment}{! Read the variances}}
\DoxyCodeLine{340         ierr = nf90\_get\_var(file\_id, var\_id, variances)}
\DoxyCodeLine{341         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{342 }
\DoxyCodeLine{343         \textcolor{comment}{! Get var\_id for a\_array}}
\DoxyCodeLine{344         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}Parameter\_a\_array"{}}, var\_id)}
\DoxyCodeLine{345         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{346 }
\DoxyCodeLine{347         \textcolor{comment}{! Read the a\_array}}
\DoxyCodeLine{348         ierr = nf90\_get\_var(file\_id, var\_id, a\_array)}
\DoxyCodeLine{349         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{350 }
\DoxyCodeLine{351         \textcolor{comment}{! Get var\_id for b\_array}}
\DoxyCodeLine{352         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}Parameter\_beta\_array"{}}, var\_id)}
\DoxyCodeLine{353         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{354 }
\DoxyCodeLine{355         \textcolor{comment}{! Read the b\_array}}
\DoxyCodeLine{356         ierr = nf90\_get\_var(file\_id, var\_id, b\_array)}
\DoxyCodeLine{357         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{358 }
\DoxyCodeLine{359         \textcolor{comment}{! Get attribute accept\_rate}}
\DoxyCodeLine{360         ierr = nf90\_get\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rates)}
\DoxyCodeLine{361         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{362         }
\DoxyCodeLine{363         \textcolor{comment}{! Close the file}}
\DoxyCodeLine{364         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{365         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{366 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=347pt]{namespacerestart__fns_aa562723430cab2682d10733e3a48bb7d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacerestart__fns_aa562723430cab2682d10733e3a48bb7d_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacerestart__fns_abae4eaf545561c534bc832e303c47b4b}\label{namespacerestart__fns_abae4eaf545561c534bc832e303c47b4b}} 
\index{restart\_fns@{restart\_fns}!fu@{fu}}
\index{fu@{fu}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{fu}{fu}}
{\footnotesize\ttfamily integer restart\+\_\+fns\+::fu}



To store LUN of files during i/o. 



Definition at line 23 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{23     \textcolor{keywordtype}{integer} :: fu}

\end{DoxyCode}
\mbox{\Hypertarget{namespacerestart__fns_ab386c6b0f14be0090063a054256f5923}\label{namespacerestart__fns_ab386c6b0f14be0090063a054256f5923}} 
\index{restart\_fns@{restart\_fns}!rc@{rc}}
\index{rc@{rc}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{rc}{rc}}
{\footnotesize\ttfamily integer restart\+\_\+fns\+::rc}



To capture error states during file i/o. 



Definition at line 24 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{24     \textcolor{keywordtype}{integer} :: rc}

\end{DoxyCode}
