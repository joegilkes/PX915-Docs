\hypertarget{namespacerestart__fns}{}\doxysection{restart\+\_\+fns Module Reference}
\label{namespacerestart__fns}\index{restart\_fns@{restart\_fns}}


Contains routines to read and write restart files.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_a11f18611058f7af2ac8e21df6f02afa7}{write\+\_\+res\+\_\+nml}} (p\+\_\+system, i1, i2, i3, step, seed, pos1, pos2)
\begin{DoxyCompactList}\small\item\em Writes the restart file res\+\_\+nml.\+txt, using the current states of simulation variables. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_a34c01a8b391a8c3a4ba40e9f5ec644d3}{read\+\_\+res\+\_\+nml}} (res)
\begin{DoxyCompactList}\small\item\em Reads the RESTART namelist in res\+\_\+nml.\+txt. Assigns the input data to the corresponding variables in the restart derived type instance \textquotesingle{}res\textquotesingle{}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_a23054262d0eeb017dee69fd5f9ca1250}{error\+\_\+check}} (ierr)
\begin{DoxyCompactList}\small\item\em Checks error status at each point of the Net\+CDF read. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_a673ea568ef91fc50ac00e24822742301}{read\+\_\+energies}} (filename, energies, accept\+\_\+rates)
\begin{DoxyCompactList}\small\item\em Reads restart files with energies (res\+\_\+ene\+\_\+tot.\+nc or res\+\_\+ene\+\_\+par.\+nc) \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacerestart__fns_a2bfef0bcec6193f109b558f89e9cd90d}{read\+\_\+chains}} (energy\+\_\+chain, accept\+\_\+rate)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
integer \mbox{\hyperlink{namespacerestart__fns_abae4eaf545561c534bc832e303c47b4b}{fu}}
\begin{DoxyCompactList}\small\item\em To store LUN of files during i/o. \end{DoxyCompactList}\item 
integer \mbox{\hyperlink{namespacerestart__fns_ab386c6b0f14be0090063a054256f5923}{rc}}
\begin{DoxyCompactList}\small\item\em To capture error states during file i/o. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains routines to read and write restart files. 

Contains subroutines to read and write the RESTART namelist in the res\+\_\+nml.\+txt restart file. Also contains subroutines that read the Net\+CDF files storing the restart history of either total energies or parameter energies. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacerestart__fns_a11f18611058f7af2ac8e21df6f02afa7}\label{namespacerestart__fns_a11f18611058f7af2ac8e21df6f02afa7}} 
\index{restart\_fns@{restart\_fns}!write\_res\_nml@{write\_res\_nml}}
\index{write\_res\_nml@{write\_res\_nml}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{write\_res\_nml()}{write\_res\_nml()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::write\+\_\+res\+\_\+nml (\begin{DoxyParamCaption}\item[{character(len=10), intent(in)}]{p\+\_\+system,  }\item[{integer(int32), intent(in)}]{i1,  }\item[{integer(int32), intent(in), optional}]{i2,  }\item[{integer(int32), intent(in), optional}]{i3,  }\item[{integer(int32), intent(in)}]{step,  }\item[{integer(int32), intent(in)}]{seed,  }\item[{real(real64), dimension(3), intent(in), optional}]{pos1,  }\item[{real(real64), dimension(3), intent(in), optional}]{pos2 }\end{DoxyParamCaption})}



Writes the restart file res\+\_\+nml.\+txt, using the current states of simulation variables. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p\+\_\+system} & System \\
\hline
\mbox{\texttt{ in}}  & {\em i1} & Current index on alpha (for QHO) or bond (for Hyd) grid \\
\hline
\mbox{\texttt{ in}}  & {\em i2} & Current index of c1 grid (for Hyd) \\
\hline
\mbox{\texttt{ in}}  & {\em i3} & Current index of c2 grid (for Hyd) \\
\hline
\mbox{\texttt{ in}}  & {\em step} & Current step number \\
\hline
\mbox{\texttt{ in}}  & {\em seed} & Current random seed \\
\hline
\mbox{\texttt{ in}}  & {\em pos1} & Current position of electron \\
\hline
\mbox{\texttt{ in}}  & {\em pos2} & Current position of second electron for H2 system \\
\hline
\end{DoxyParams}


Definition at line 51 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{52     \textcolor{comment}{! TO DO: Remove pos1 and pos2 if James confirms that chain-\/restarts are not required.}}
\DoxyCodeLine{53         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{54         \textcolor{keywordtype}{character(len=10)}, \textcolor{keywordtype}{intent(in)} :: p\_system \textcolor{comment}{! system being simulated}}
\DoxyCodeLine{55         \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{intent(in)} :: i1  \textcolor{comment}{! current index on alpha (for QHO) or bond (for Hyd) grid}}
\DoxyCodeLine{56         \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{optional}, \textcolor{keywordtype}{intent(in)} :: i2, i3  \textcolor{comment}{! current index of c1 and c2 (for Hyd)}}
\DoxyCodeLine{57         \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{intent(in)} :: step \textcolor{comment}{! current step number}}
\DoxyCodeLine{58         \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{intent(in)}  :: seed \textcolor{comment}{! current seed used}}
\DoxyCodeLine{59 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{optional}, \textcolor{keywordtype}{intent(in)}  :: pos1 \textcolor{comment}{! current position of electron}}
\DoxyCodeLine{60 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(3)}, \textcolor{keywordtype}{optional}, \textcolor{keywordtype}{intent(in)}  :: pos2 \textcolor{comment}{! current position of second electron for H2}}
\DoxyCodeLine{61         \textcolor{keywordtype}{type}(restart\_type) :: res}
\DoxyCodeLine{62 }
\DoxyCodeLine{63         \textcolor{comment}{! Define the RESTART namelist}}
\DoxyCodeLine{64         namelist /restart/ res}
\DoxyCodeLine{65 }
\DoxyCodeLine{66         \textcolor{comment}{! Store the step number and seed}}
\DoxyCodeLine{67         res\%step = step}
\DoxyCodeLine{68         res\%seed = seed}
\DoxyCodeLine{69 }
\DoxyCodeLine{70         \textcolor{comment}{! If the simulation was midst an MMC run}}
\DoxyCodeLine{71         \textcolor{keywordflow}{if} (step /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73             \textcolor{comment}{! Store position of first electron}}
\DoxyCodeLine{74             \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(pos1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{75                 res\%pos1 = pos1}
\DoxyCodeLine{76             \textcolor{keywordflow}{else}}
\DoxyCodeLine{77                 error stop \textcolor{stringliteral}{'Error: Electron position ("{}pos1"{}) missing in inputs to write\_res\_params().'}}
\DoxyCodeLine{78 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80             \textcolor{comment}{! For H2, store position of second electron as well}}
\DoxyCodeLine{81             \textcolor{keywordflow}{if} (trim(p\_system)==\textcolor{stringliteral}{'H2'}) \textcolor{keywordflow}{then}}
\DoxyCodeLine{82                 \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(pos2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{83                     res\%pos2 = pos2}
\DoxyCodeLine{84                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{85                     error stop \textcolor{stringliteral}{'Error: Electron position ("{}pos2"{}) missing in inputs to write\_res\_params().'}}
\DoxyCodeLine{86 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{87 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \textcolor{keywordflow}{        endif}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91         \textcolor{comment}{! Store the parameter values}}
\DoxyCodeLine{92         \textcolor{keywordflow}{select case} (trim(p\_system))}
\DoxyCodeLine{93         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'QHO'})}
\DoxyCodeLine{94             res\%i\_alpha = i1}
\DoxyCodeLine{95         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2plus'})}
\DoxyCodeLine{96             res\%i\_bond = i1}
\DoxyCodeLine{97             res\%i\_c1 = i2}
\DoxyCodeLine{98             \textcolor{keywordflow}{if} (h2plus\%include\_pqn==2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{99                 \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(i3)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{100                     res\%i\_c2 = i3}
\DoxyCodeLine{101                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{102                     error stop \textcolor{stringliteral}{'Error: Value of c2 ("{}val3"{}) missing in inputs to write\_res\_params().'}}
\DoxyCodeLine{103 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{104 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{105         \textcolor{keywordflow}{case} (\textcolor{stringliteral}{'H2'})}
\DoxyCodeLine{106             res\%i\_bond = i1}
\DoxyCodeLine{107             res\%i\_c1 = i2}
\DoxyCodeLine{108             \textcolor{keywordflow}{if} (h2\%include\_pqn==2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{109                 \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(i3)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{110                     res\%i\_c2 = i3}
\DoxyCodeLine{111                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{112                     error stop \textcolor{stringliteral}{'Error: Value of c2 ("{}val3"{}) missing in inputs to write\_res\_params().'}}
\DoxyCodeLine{113 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{114 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{115 \textcolor{keywordflow}{        case default}}
\DoxyCodeLine{116             error stop \textcolor{stringliteral}{'Error: Invalid "{}p\_system"{} passed to function write\_res\_params().'}}
\DoxyCodeLine{117 \textcolor{keywordflow}{        end select}}
\DoxyCodeLine{118 }
\DoxyCodeLine{119         \textcolor{comment}{! Open the res\_paramts.txt file}}
\DoxyCodeLine{120         \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'write'}, file=resfile\_nml, iostat=rc, newunit=fu)}
\DoxyCodeLine{121 }
\DoxyCodeLine{122         \textcolor{comment}{! Write the RESTART namelist}}
\DoxyCodeLine{123         \textcolor{keyword}{write}(nml=restart, iostat=rc, unit=fu)}
\DoxyCodeLine{124         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{125             error stop \textcolor{stringliteral}{'Error: Invalid RESTART namelist defined in function write\_res\_params().'}}
\DoxyCodeLine{126 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{127         }
\DoxyCodeLine{128         \textcolor{comment}{! Close the res\_paramts.txt file}}
\DoxyCodeLine{129         \textcolor{keyword}{close}(fu)}
\DoxyCodeLine{130 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacerestart__fns_a34c01a8b391a8c3a4ba40e9f5ec644d3}\label{namespacerestart__fns_a34c01a8b391a8c3a4ba40e9f5ec644d3}} 
\index{restart\_fns@{restart\_fns}!read\_res\_nml@{read\_res\_nml}}
\index{read\_res\_nml@{read\_res\_nml}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{read\_res\_nml()}{read\_res\_nml()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::read\+\_\+res\+\_\+nml (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structshared__data_1_1restart__type}{restart\+\_\+type}}), intent(out)}]{res }\end{DoxyParamCaption})}



Reads the RESTART namelist in res\+\_\+nml.\+txt. Assigns the input data to the corresponding variables in the restart derived type instance \textquotesingle{}res\textquotesingle{}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em res} & Instance of restart\+\_\+type, to store restart parameter values \\
\hline
\end{DoxyParams}


Definition at line 150 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{151 }
\DoxyCodeLine{152         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{153         \textcolor{keywordtype}{type}(restart\_type), \textcolor{keywordtype}{intent(out)} :: res}
\DoxyCodeLine{154 }
\DoxyCodeLine{155         \textcolor{comment}{! Define the namelist}}
\DoxyCodeLine{156         namelist /restart/ res}
\DoxyCodeLine{157 }
\DoxyCodeLine{158         \textcolor{comment}{! Check if file exists}}
\DoxyCodeLine{159         \textcolor{keyword}{inquire}(file=resfile\_nml, iostat=rc)}
\DoxyCodeLine{160         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{161             print*, \textcolor{stringliteral}{'Searched for file '}, resfile\_nml, \textcolor{stringliteral}{' .'}}
\DoxyCodeLine{162             error stop \textcolor{stringliteral}{'Error: This restart file is not present in the current directory.'}}
\DoxyCodeLine{163 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{164 }
\DoxyCodeLine{165         \textcolor{comment}{! Open the file}}
\DoxyCodeLine{166         \textcolor{keyword}{open}(action=\textcolor{stringliteral}{'read'}, file=resfile\_nml, iostat=rc, newunit=fu)}
\DoxyCodeLine{167 }
\DoxyCodeLine{168         \textcolor{comment}{! Read the namelist}}
\DoxyCodeLine{169         \textcolor{keyword}{read}(nml=restart, iostat=rc, unit=fu)}
\DoxyCodeLine{170         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{171             error stop \textcolor{stringliteral}{'Error: Invalid RESTART namelist in "{}res\_nml.txt"{}.'}}
\DoxyCodeLine{172 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{173         }
\DoxyCodeLine{174         \textcolor{comment}{! Close the file}}
\DoxyCodeLine{175         \textcolor{keyword}{close}(fu)}
\DoxyCodeLine{176 }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacerestart__fns_a34c01a8b391a8c3a4ba40e9f5ec644d3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacerestart__fns_a23054262d0eeb017dee69fd5f9ca1250}\label{namespacerestart__fns_a23054262d0eeb017dee69fd5f9ca1250}} 
\index{restart\_fns@{restart\_fns}!error\_check@{error\_check}}
\index{error\_check@{error\_check}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{error\_check()}{error\_check()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::error\+\_\+check (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ierr }\end{DoxyParamCaption})}



Checks error status at each point of the Net\+CDF read. 

Will print error message/code corresponding to ierr input. Copied from module net\+CDF.\+f90. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ierr} & Internal error value \\
\hline
\end{DoxyParams}


Definition at line 192 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{193         \textcolor{keywordtype}{integer},\textcolor{keywordtype}{intent(in)} :: ierr}
\DoxyCodeLine{194         \textcolor{keywordflow}{if} (ierr /= nf90\_noerr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{195             print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{196             \textcolor{keywordflow}{return}}
\DoxyCodeLine{197 \textcolor{keywordflow}{        endif}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacerestart__fns_a23054262d0eeb017dee69fd5f9ca1250_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacerestart__fns_a673ea568ef91fc50ac00e24822742301}\label{namespacerestart__fns_a673ea568ef91fc50ac00e24822742301}} 
\index{restart\_fns@{restart\_fns}!read\_energies@{read\_energies}}
\index{read\_energies@{read\_energies}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{read\_energies()}{read\_energies()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::read\+\_\+energies (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{energies,  }\item[{real(real64), dimension(\+:), intent(out), allocatable}]{accept\+\_\+rates }\end{DoxyParamCaption})}



Reads restart files with energies (res\+\_\+ene\+\_\+tot.\+nc or res\+\_\+ene\+\_\+par.\+nc) 

Assigns the data arrays it reads to the corresponding array variables passed to it. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em filename} & Name of the Net\+CDF restart file with required energies \\
\hline
\mbox{\texttt{ in}}  & {\em energies} & Array to store restart energies \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rates} & Array to store restart acceptence rates \\
\hline
\end{DoxyParams}


Definition at line 215 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{216 }
\DoxyCodeLine{217         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{218         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{219 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{intent(out)} :: energies, accept\_rates}
\DoxyCodeLine{220         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id}
\DoxyCodeLine{221 }
\DoxyCodeLine{222         \textcolor{comment}{! Check if file exists}}
\DoxyCodeLine{223         \textcolor{keyword}{inquire}(file=filename, iostat=rc)}
\DoxyCodeLine{224         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{225             print*, \textcolor{stringliteral}{'Searched for file '}, filename, \textcolor{stringliteral}{' .'}}
\DoxyCodeLine{226             error stop \textcolor{stringliteral}{'Error: This restart file is not present in the current directory.'}}
\DoxyCodeLine{227 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{228 }
\DoxyCodeLine{229         \textcolor{comment}{! Open restart netCDF file with energies}}
\DoxyCodeLine{230         ierr = nf90\_open(filename, nf90\_nowrite, file\_id)}
\DoxyCodeLine{231         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{232 }
\DoxyCodeLine{233         \textcolor{comment}{! Get var\_id for total\_energies}}
\DoxyCodeLine{234         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}total\_energies"{}}, var\_id)}
\DoxyCodeLine{235         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{236 }
\DoxyCodeLine{237         \textcolor{comment}{! Read the total\_energies}}
\DoxyCodeLine{238         ierr = nf90\_get\_var(file\_id, var\_id, energies)}
\DoxyCodeLine{239         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{240 }
\DoxyCodeLine{241         \textcolor{comment}{! Get attribute accept\_rate}}
\DoxyCodeLine{242         ierr = nf90\_get\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rates)}
\DoxyCodeLine{243         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{244         }
\DoxyCodeLine{245         \textcolor{comment}{! Close the file}}
\DoxyCodeLine{246         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{247         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{248 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=331pt]{namespacerestart__fns_a673ea568ef91fc50ac00e24822742301_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{namespacerestart__fns_a673ea568ef91fc50ac00e24822742301_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacerestart__fns_a2bfef0bcec6193f109b558f89e9cd90d}\label{namespacerestart__fns_a2bfef0bcec6193f109b558f89e9cd90d}} 
\index{restart\_fns@{restart\_fns}!read\_chains@{read\_chains}}
\index{read\_chains@{read\_chains}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{read\_chains()}{read\_chains()}}
{\footnotesize\ttfamily subroutine restart\+\_\+fns\+::read\+\_\+chains (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(out), allocatable}]{energy\+\_\+chain,  }\item[{real(real64), intent(out)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Definition at line 253 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{254 }
\DoxyCodeLine{255         \textcolor{comment}{! Local variables}}
\DoxyCodeLine{256 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable}, \textcolor{keywordtype}{intent(out)} :: energy\_chain}
\DoxyCodeLine{257 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(out)} :: accept\_rate}
\DoxyCodeLine{258         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id}
\DoxyCodeLine{259 }
\DoxyCodeLine{260         \textcolor{comment}{! Check if file exists}}
\DoxyCodeLine{261         \textcolor{keyword}{inquire}(file=resfile\_chn, iostat=rc)}
\DoxyCodeLine{262         \textcolor{keywordflow}{if} (rc /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{263             print*, \textcolor{stringliteral}{'Searched for file '}, resfile\_chn, \textcolor{stringliteral}{' .'}}
\DoxyCodeLine{264             error stop \textcolor{stringliteral}{'Error: This restart file is not present in the current directory.'}}
\DoxyCodeLine{265 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{266 }
\DoxyCodeLine{267         \textcolor{comment}{! Open restart netCDF file with chains}}
\DoxyCodeLine{268         ierr = nf90\_open(resfile\_chn, nf90\_nowrite, file\_id)}
\DoxyCodeLine{269         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{270 }
\DoxyCodeLine{271         \textcolor{comment}{!! Get var\_id for energy\_chain -\/ called 'Trace' in the netcdf file}}
\DoxyCodeLine{272         ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}Trace"{}}, var\_id)}
\DoxyCodeLine{273         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{274 }
\DoxyCodeLine{275         \textcolor{comment}{! Read the energy\_chain}}
\DoxyCodeLine{276         ierr = nf90\_get\_var(file\_id, var\_id, energy\_chain)}
\DoxyCodeLine{277         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{278 }
\DoxyCodeLine{279         \textcolor{comment}{! Get attribute accept\_rate}}
\DoxyCodeLine{280         ierr = nf90\_get\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{281 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{282         }
\DoxyCodeLine{283         \textcolor{comment}{! Close the file}}
\DoxyCodeLine{284         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{285         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{286 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=323pt]{namespacerestart__fns_a2bfef0bcec6193f109b558f89e9cd90d_cgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacerestart__fns_abae4eaf545561c534bc832e303c47b4b}\label{namespacerestart__fns_abae4eaf545561c534bc832e303c47b4b}} 
\index{restart\_fns@{restart\_fns}!fu@{fu}}
\index{fu@{fu}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{fu}{fu}}
{\footnotesize\ttfamily integer restart\+\_\+fns\+::fu}



To store LUN of files during i/o. 



Definition at line 23 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{23     \textcolor{keywordtype}{integer} :: fu}

\end{DoxyCode}
\mbox{\Hypertarget{namespacerestart__fns_ab386c6b0f14be0090063a054256f5923}\label{namespacerestart__fns_ab386c6b0f14be0090063a054256f5923}} 
\index{restart\_fns@{restart\_fns}!rc@{rc}}
\index{rc@{rc}!restart\_fns@{restart\_fns}}
\doxysubsubsection{\texorpdfstring{rc}{rc}}
{\footnotesize\ttfamily integer restart\+\_\+fns\+::rc}



To capture error states during file i/o. 



Definition at line 24 of file restart\+\_\+fns.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{24     \textcolor{keywordtype}{integer} :: rc}

\end{DoxyCode}
