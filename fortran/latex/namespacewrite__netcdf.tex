\hypertarget{namespacewrite__netcdf}{}\doxysection{write\+\_\+netcdf Module Reference}
\label{namespacewrite__netcdf}\index{write\_netcdf@{write\_netcdf}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0}{error\+\_\+check}} (ierr)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_ae2722e18129ba78f02541fa0ae49f886}{write\+\_\+qho\+\_\+main}} (alpha\+\_\+array, energy\+\_\+array, filename, ierr, QHO, accept\+\_\+rate)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a4b9b251a06719d1b0470cfc1f03883ab}{write\+\_\+qho\+\_\+equilibration}} (trace, filename, ierr, QHO, accept\+\_\+rate, alpha)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a818c3a109a649bbf802adaa2a937a458}{write\+\_\+h2plus\+\_\+main}} (bondlength\+\_\+array, energy\+\_\+array, filename, ierr, H2plus, accept\+\_\+rate)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a45c5f8affdc7b8d275bc35f8b70337f4}{write\+\_\+h2plus\+\_\+equilibration}} (trace, filename, ierr, H2plus, accept\+\_\+rate)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a8b125766a34e4cc2d72228a5bd109ce0}{write\+\_\+h2\+\_\+main}} (bondlength\+\_\+array, energy\+\_\+array, filename, ierr, H2, accept\+\_\+rate)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_adc83694755df0f3d9228fb9aa0874452}{write\+\_\+h2\+\_\+equilibration}} (trace, filename, ierr, H2, accept\+\_\+rate)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d}{append\+\_\+to\+\_\+array}} (array, filename, ierr)
\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0}\label{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0}} 
\index{write\_netcdf@{write\_netcdf}!error\_check@{error\_check}}
\index{error\_check@{error\_check}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{error\_check()}{error\_check()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::error\+\_\+check (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ierr }\end{DoxyParamCaption})}



Definition at line 15 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{16     \textcolor{keywordtype}{integer},\textcolor{keywordtype}{intent(in)} :: ierr}
\DoxyCodeLine{17     \textcolor{keywordflow}{if} (ierr /= nf90\_noerr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{18         print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{19         \textcolor{keywordflow}{return}}
\DoxyCodeLine{20 \textcolor{keywordflow}{    endif}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_ae2722e18129ba78f02541fa0ae49f886}\label{namespacewrite__netcdf_ae2722e18129ba78f02541fa0ae49f886}} 
\index{write\_netcdf@{write\_netcdf}!write\_qho\_main@{write\_qho\_main}}
\index{write\_qho\_main@{write\_qho\_main}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_qho\_main()}{write\_qho\_main()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+qho\+\_\+main (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{alpha\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1qho__type}{qho\+\_\+type}}), intent(in)}]{QHO,  }\item[{real(real64), intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Definition at line 24 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{25     \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{26 \textcolor{keywordtype}{    real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: alpha\_array, energy\_array}
\DoxyCodeLine{27     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{28     \textcolor{keywordtype}{type}(QHO\_type), \textcolor{keywordtype}{intent(in)} :: QHO}
\DoxyCodeLine{29 \textcolor{keywordtype}{    real}(real64), \textcolor{keywordtype}{intent(in)} :: accept\_rate}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 }
\DoxyCodeLine{32     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{33     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{34     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{35     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{36     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, var\_id\_, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{37     }
\DoxyCodeLine{38 }
\DoxyCodeLine{39     \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{40     \textcolor{comment}{! Check this! May need care if splitting write into sections}}
\DoxyCodeLine{41     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{42     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{45     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{46         ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id(i))}
\DoxyCodeLine{47         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{48 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}burn\_step"{}}, qho\%burn\_step)}
\DoxyCodeLine{53     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{54     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}thin\_step"{}}, qho\%thin\_step)}
\DoxyCodeLine{55     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{56     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, qho\%rcut)}
\DoxyCodeLine{57     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{58     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, qho\%sigma)}
\DoxyCodeLine{59     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{60     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate)}
\DoxyCodeLine{61     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 }
\DoxyCodeLine{64     \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{65     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Alpha\_array"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{66     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}energy\_at\_alphas\_array"{}}, nf90\_real, dim\_id, var\_id\_)}
\DoxyCodeLine{69     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{70 }
\DoxyCodeLine{71     \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{72     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{73     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{74 }
\DoxyCodeLine{75     \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{76     ierr = nf90\_put\_var(file\_id, var\_id, alpha\_array) }
\DoxyCodeLine{77     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{78 }
\DoxyCodeLine{79     ierr = nf90\_put\_var(file\_id, var\_id\_, energy\_array)}
\DoxyCodeLine{80     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     \textcolor{comment}{! Close file}}
\DoxyCodeLine{83     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{84     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{85 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_ae2722e18129ba78f02541fa0ae49f886_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{namespacewrite__netcdf_ae2722e18129ba78f02541fa0ae49f886_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a4b9b251a06719d1b0470cfc1f03883ab}\label{namespacewrite__netcdf_a4b9b251a06719d1b0470cfc1f03883ab}} 
\index{write\_netcdf@{write\_netcdf}!write\_qho\_equilibration@{write\_qho\_equilibration}}
\index{write\_qho\_equilibration@{write\_qho\_equilibration}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_qho\_equilibration()}{write\_qho\_equilibration()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+qho\+\_\+equilibration (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{trace,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1qho__type}{qho\+\_\+type}}), intent(in)}]{QHO,  }\item[{real(real64), intent(in)}]{accept\+\_\+rate,  }\item[{real(real64), intent(in)}]{alpha }\end{DoxyParamCaption})}



Definition at line 90 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{91     \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{92 \textcolor{keywordtype}{    real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: trace}
\DoxyCodeLine{93     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{94     \textcolor{keywordtype}{type}(QHO\_type), \textcolor{keywordtype}{intent(in)} :: QHO}
\DoxyCodeLine{95 \textcolor{keywordtype}{    real}(real64), \textcolor{keywordtype}{intent(in)} :: accept\_rate, alpha}
\DoxyCodeLine{96 }
\DoxyCodeLine{97 }
\DoxyCodeLine{98     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{99     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{100     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{101     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{102     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{103     }
\DoxyCodeLine{104 }
\DoxyCodeLine{105     \textcolor{comment}{! Create file, overwrite if existing}}
\DoxyCodeLine{106     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{107     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{110     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{111         ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id(i))}
\DoxyCodeLine{112         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{113 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{116 }
\DoxyCodeLine{117     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, qho\%rcut)}
\DoxyCodeLine{118     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{119     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, qho\%sigma)}
\DoxyCodeLine{120     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{121     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate)}
\DoxyCodeLine{122     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{123     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}alpha"{}}, alpha)}
\DoxyCodeLine{124     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{125 }
\DoxyCodeLine{126 }
\DoxyCodeLine{127     \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{128     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Trace"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{129     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{130 }
\DoxyCodeLine{131     \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{132     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{133     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{134 }
\DoxyCodeLine{135     \textcolor{comment}{! Actually write 1D array}}
\DoxyCodeLine{136     ierr = nf90\_put\_var(file\_id, var\_id, trace) }
\DoxyCodeLine{137     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{138 }
\DoxyCodeLine{139     \textcolor{comment}{! Close file}}
\DoxyCodeLine{140     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{141     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{142 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_a4b9b251a06719d1b0470cfc1f03883ab_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{namespacewrite__netcdf_a4b9b251a06719d1b0470cfc1f03883ab_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a818c3a109a649bbf802adaa2a937a458}\label{namespacewrite__netcdf_a818c3a109a649bbf802adaa2a937a458}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2plus\_main@{write\_h2plus\_main}}
\index{write\_h2plus\_main@{write\_h2plus\_main}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2plus\_main()}{write\_h2plus\_main()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2plus\+\_\+main (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(in)}]{bondlength\+\_\+array,  }\item[{real, dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2plus__type}{h2plus\+\_\+type}}), intent(in)}]{H2plus,  }\item[{real, intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Definition at line 147 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{148     \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{149 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: bondlength\_array, energy\_array}
\DoxyCodeLine{150     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{151     \textcolor{keywordtype}{type}(H2plus\_type), \textcolor{keywordtype}{intent(in)} :: H2plus}
\DoxyCodeLine{152 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)} :: accept\_rate}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 }
\DoxyCodeLine{155     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{156     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{157     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{158     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{159     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, var\_id\_, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{160     }
\DoxyCodeLine{161 }
\DoxyCodeLine{162     \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{163     \textcolor{comment}{! Check this! May need care if splitting write into sections}}
\DoxyCodeLine{164     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{165     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{166 }
\DoxyCodeLine{167     \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{168     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{169         ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id(i))}
\DoxyCodeLine{170         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{171 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{172 }
\DoxyCodeLine{173     \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{174 }
\DoxyCodeLine{175     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}burn\_step"{}}, h2plus\%burn\_step)}
\DoxyCodeLine{176     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{177     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}thin\_step"{}}, h2plus\%thin\_step)}
\DoxyCodeLine{178     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{179     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2plus\%rcut)}
\DoxyCodeLine{180     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{181     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2plus\%sigma)}
\DoxyCodeLine{182     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{183     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}include\_pqn"{}}, h2plus\%include\_pqn)}
\DoxyCodeLine{184     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{185     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c1"{}}, h2plus\%c1)}
\DoxyCodeLine{186     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{187     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c2"{}}, h2plus\%c2)}
\DoxyCodeLine{188     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{189     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate)}
\DoxyCodeLine{190     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{191 }
\DoxyCodeLine{192 }
\DoxyCodeLine{193     \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{194     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Bondlength\_array"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{195     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{196 }
\DoxyCodeLine{197     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}energy\_at\_bondlengths\_array"{}}, nf90\_real, dim\_id, var\_id\_)}
\DoxyCodeLine{198     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{199 }
\DoxyCodeLine{200     \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{201     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{202     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{203 }
\DoxyCodeLine{204     \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{205     ierr = nf90\_put\_var(file\_id, var\_id, bondlength\_array) }
\DoxyCodeLine{206     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{207 }
\DoxyCodeLine{208     ierr = nf90\_put\_var(file\_id, var\_id\_, energy\_array)}
\DoxyCodeLine{209     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{210 }
\DoxyCodeLine{211     \textcolor{comment}{! Close file}}
\DoxyCodeLine{212     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{213     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{214 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_a818c3a109a649bbf802adaa2a937a458_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a45c5f8affdc7b8d275bc35f8b70337f4}\label{namespacewrite__netcdf_a45c5f8affdc7b8d275bc35f8b70337f4}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2plus\_equilibration@{write\_h2plus\_equilibration}}
\index{write\_h2plus\_equilibration@{write\_h2plus\_equilibration}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2plus\_equilibration()}{write\_h2plus\_equilibration()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2plus\+\_\+equilibration (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(in)}]{trace,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2plus__type}{h2plus\+\_\+type}}), intent(in)}]{H2plus,  }\item[{real, intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Definition at line 220 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{221     \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{222 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: trace}
\DoxyCodeLine{223     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{224     \textcolor{keywordtype}{type}(H2plus\_type), \textcolor{keywordtype}{intent(in)} :: H2plus}
\DoxyCodeLine{225 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)} :: accept\_rate}
\DoxyCodeLine{226 }
\DoxyCodeLine{227 }
\DoxyCodeLine{228     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{229     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{230     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{231     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{232     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{233     }
\DoxyCodeLine{234 }
\DoxyCodeLine{235     \textcolor{comment}{! Create file, overwrite if existing}}
\DoxyCodeLine{236     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{237     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{238 }
\DoxyCodeLine{239     \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{240     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{241         ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id(i))}
\DoxyCodeLine{242         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{243 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{244 }
\DoxyCodeLine{245     \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{246 }
\DoxyCodeLine{247     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2plus\%rcut)}
\DoxyCodeLine{248     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{249     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2plus\%sigma)}
\DoxyCodeLine{250     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{251     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}include\_pqn"{}}, h2plus\%include\_pqn)}
\DoxyCodeLine{252     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{253     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate)}
\DoxyCodeLine{254     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{255     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c1"{}}, h2plus\%c1)}
\DoxyCodeLine{256     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{257     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c2"{}}, h2plus\%c2)}
\DoxyCodeLine{258     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{259 }
\DoxyCodeLine{260 }
\DoxyCodeLine{261     \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{262     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Trace"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{263     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{264 }
\DoxyCodeLine{265     \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{266     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{267     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{268 }
\DoxyCodeLine{269     \textcolor{comment}{! Actually write 1D array}}
\DoxyCodeLine{270     ierr = nf90\_put\_var(file\_id, var\_id, trace) }
\DoxyCodeLine{271     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{272 }
\DoxyCodeLine{273     \textcolor{comment}{! Close file}}
\DoxyCodeLine{274     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{275     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{276 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=317pt]{namespacewrite__netcdf_a45c5f8affdc7b8d275bc35f8b70337f4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a8b125766a34e4cc2d72228a5bd109ce0}\label{namespacewrite__netcdf_a8b125766a34e4cc2d72228a5bd109ce0}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2\_main@{write\_h2\_main}}
\index{write\_h2\_main@{write\_h2\_main}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2\_main()}{write\_h2\_main()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2\+\_\+main (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(in)}]{bondlength\+\_\+array,  }\item[{real, dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2__type}{h2\+\_\+type}}), intent(in)}]{H2,  }\item[{real, intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Definition at line 282 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{283     \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{284 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: bondlength\_array, energy\_array}
\DoxyCodeLine{285     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{286     \textcolor{keywordtype}{type}(H2\_type), \textcolor{keywordtype}{intent(in)} :: H2}
\DoxyCodeLine{287 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)} :: accept\_rate}
\DoxyCodeLine{288 }
\DoxyCodeLine{289 }
\DoxyCodeLine{290     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{291     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{292     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{293     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{294     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, var\_id\_, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{295     }
\DoxyCodeLine{296 }
\DoxyCodeLine{297     \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{298     \textcolor{comment}{! Check this! May need care if splitting write into sections}}
\DoxyCodeLine{299     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{300     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{301 }
\DoxyCodeLine{302     \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{303     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{304         ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id(i))}
\DoxyCodeLine{305         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{306 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{307 }
\DoxyCodeLine{308     \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{309 }
\DoxyCodeLine{310     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}burn\_step"{}}, h2\%burn\_step)}
\DoxyCodeLine{311     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{312     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}thin\_step"{}}, h2\%thin\_step)}
\DoxyCodeLine{313     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{314     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2\%rcut)}
\DoxyCodeLine{315     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{316     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2\%sigma)}
\DoxyCodeLine{317     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{318     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}include\_pqn"{}}, h2\%include\_pqn)}
\DoxyCodeLine{319     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{320     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c1"{}}, h2\%c1)}
\DoxyCodeLine{321     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{322     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c2"{}}, h2\%c2)}
\DoxyCodeLine{323     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{324     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate)}
\DoxyCodeLine{325     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{326 }
\DoxyCodeLine{327 }
\DoxyCodeLine{328     \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{329     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Bondlength\_array"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{330     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{331 }
\DoxyCodeLine{332     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}energy\_at\_bondlengths\_array"{}}, nf90\_real, dim\_id, var\_id\_)}
\DoxyCodeLine{333     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{334 }
\DoxyCodeLine{335     \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{336     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{337     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{338 }
\DoxyCodeLine{339     \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{340     ierr = nf90\_put\_var(file\_id, var\_id, bondlength\_array) }
\DoxyCodeLine{341     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{342 }
\DoxyCodeLine{343     ierr = nf90\_put\_var(file\_id, var\_id\_, energy\_array)}
\DoxyCodeLine{344     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{345 }
\DoxyCodeLine{346     \textcolor{comment}{! Close file}}
\DoxyCodeLine{347     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{348     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{349 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_a8b125766a34e4cc2d72228a5bd109ce0_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_adc83694755df0f3d9228fb9aa0874452}\label{namespacewrite__netcdf_adc83694755df0f3d9228fb9aa0874452}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2\_equilibration@{write\_h2\_equilibration}}
\index{write\_h2\_equilibration@{write\_h2\_equilibration}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2\_equilibration()}{write\_h2\_equilibration()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2\+\_\+equilibration (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(in)}]{trace,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2__type}{h2\+\_\+type}}), intent(in)}]{H2,  }\item[{real, intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Definition at line 354 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{355     \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{356 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: trace}
\DoxyCodeLine{357     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{358     \textcolor{keywordtype}{type}(H2\_type), \textcolor{keywordtype}{intent(in)} :: H2}
\DoxyCodeLine{359 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)} :: accept\_rate}
\DoxyCodeLine{360 }
\DoxyCodeLine{361 }
\DoxyCodeLine{362     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{363     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{364     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{365     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{366     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{367     }
\DoxyCodeLine{368 }
\DoxyCodeLine{369     \textcolor{comment}{! Create file, overwrite if existing}}
\DoxyCodeLine{370     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{371     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{372 }
\DoxyCodeLine{373     \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{374     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{375         ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id(i))}
\DoxyCodeLine{376         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{377 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{378 }
\DoxyCodeLine{379     \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{380 }
\DoxyCodeLine{381     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2\%rcut)}
\DoxyCodeLine{382     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{383     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2\%sigma)}
\DoxyCodeLine{384     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{385     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}include\_pqn"{}}, h2\%include\_pqn)}
\DoxyCodeLine{386     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{387     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate)}
\DoxyCodeLine{388     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{389     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c1"{}}, h2\%c1)}
\DoxyCodeLine{390     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{391     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c2"{}}, h2\%c2)}
\DoxyCodeLine{392     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{393 }
\DoxyCodeLine{394 }
\DoxyCodeLine{395     \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{396     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Trace"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{397     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{398 }
\DoxyCodeLine{399     \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{400     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{401     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{402 }
\DoxyCodeLine{403     \textcolor{comment}{! Actually write 1D array}}
\DoxyCodeLine{404     ierr = nf90\_put\_var(file\_id, var\_id, trace) }
\DoxyCodeLine{405     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{406 }
\DoxyCodeLine{407     \textcolor{comment}{! Close file}}
\DoxyCodeLine{408     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{409     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{410 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_adc83694755df0f3d9228fb9aa0874452_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d}\label{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d}} 
\index{write\_netcdf@{write\_netcdf}!append\_to\_array@{append\_to\_array}}
\index{append\_to\_array@{append\_to\_array}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{append\_to\_array()}{append\_to\_array()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::append\+\_\+to\+\_\+array (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(in)}]{array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr }\end{DoxyParamCaption})}



Definition at line 420 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{421     \textcolor{comment}{! Declaring inpit variables}}
\DoxyCodeLine{422 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: array}
\DoxyCodeLine{423     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{424 }
\DoxyCodeLine{425     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{426     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{427     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{428     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{429     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i, array\_length  \textcolor{comment}{! Error check status, file and variable ID, iterator}}
\DoxyCodeLine{430     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(1)} :: start\_array}
\DoxyCodeLine{431 }
\DoxyCodeLine{432 }
\DoxyCodeLine{433     \textcolor{comment}{! Open existing NetCDF file in read / write mode}}
\DoxyCodeLine{434     ierr = nf90\_open(filename, nf90\_write, file\_id)}
\DoxyCodeLine{435     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{436 }
\DoxyCodeLine{437     \textcolor{comment}{! Grab variable ID of Trace / 1D array}}
\DoxyCodeLine{438     ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}Trace"{}}, var\_id)}
\DoxyCodeLine{439     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{440 }
\DoxyCodeLine{441     \textcolor{comment}{! Grab dimension ID of Trace / 1D array ("{}t"{})}}
\DoxyCodeLine{442     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{443         ierr = nf90\_inq\_dimid(file\_id, dims(i), dim\_id(i))}
\DoxyCodeLine{444         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{445 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{446 }
\DoxyCodeLine{447     \textcolor{comment}{! Grab length of dimension / 1D array}}
\DoxyCodeLine{448     ierr = nf90\_inquire\_dimension(file\_id, dim\_id(1), dims(1), array\_length)}
\DoxyCodeLine{449     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{450 }
\DoxyCodeLine{451     start\_array(1) = array\_length}
\DoxyCodeLine{452 }
\DoxyCodeLine{453     \textcolor{comment}{! Write new data to end of 1D array }}
\DoxyCodeLine{454     ierr = nf90\_put\_var(file\_id, var\_id, array, start=start\_array)}
\DoxyCodeLine{455     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{456 }
\DoxyCodeLine{457     \textcolor{comment}{! Close file}}
\DoxyCodeLine{458     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{459     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{460 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=316pt]{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d_cgraph}
\end{center}
\end{figure}
