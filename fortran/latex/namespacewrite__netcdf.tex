\hypertarget{namespacewrite__netcdf}{}\doxysection{write\+\_\+netcdf Module Reference}
\label{namespacewrite__netcdf}\index{write\_netcdf@{write\_netcdf}}


Contains Net\+CDF output functions for different problem main \& equilibration runs.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0}{error\+\_\+check}} (ierr)
\begin{DoxyCompactList}\small\item\em Checks error status at each point of Net\+CDF file build. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a8230e1f3b4a2c48c4b11f41141f6bb59}{write\+\_\+qho\+\_\+equilibration}} (position\+\_\+array, energy\+\_\+array, filename, ierr, QHO, accept\+\_\+rate, alpha)
\begin{DoxyCompactList}\small\item\em Output QHO system traces for equilibration. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_ae854a939c7da16a59b54d548a1b9a1ac}{write\+\_\+h2plus\+\_\+equilibration}} (position\+\_\+array, energy\+\_\+array, filename, ierr, H2plus, accept\+\_\+rate, c, bond\+\_\+length)
\begin{DoxyCompactList}\small\item\em Output H2\+\_\+plus system trace for equilibration. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a898caac40635ac6866326f0111b217c3}{write\+\_\+h2\+\_\+equilibration}} (position\+\_\+array, energy\+\_\+array, filename, ierr, H2, accept\+\_\+rate, beta, bond\+\_\+length)
\begin{DoxyCompactList}\small\item\em Output H2 system trace for equilibration. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a52defafffa63a95ffa92b26d2cb73b63}{write\+\_\+qho\+\_\+main}} (alpha\+\_\+array, energy\+\_\+array, uncertainty\+\_\+array, filename, ierr, QHO, accept\+\_\+rate)
\begin{DoxyCompactList}\small\item\em Output results of QHO MCMC run. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a4bf61fdf7f8ca9add5bb9b1663906542}{write\+\_\+h2plus\+\_\+main}} (param\+\_\+array, bondlength\+\_\+array, energy\+\_\+array, uncertainty\+\_\+array, filename, ierr, H2plus, accept\+\_\+rate)
\begin{DoxyCompactList}\small\item\em Output results of H2plus MCMC run. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a8d49ffe8b78e85c17f3127d8dc89a83b}{write\+\_\+h2\+\_\+main}} (param\+\_\+a\+\_\+array, param\+\_\+beta\+\_\+array, bondlength\+\_\+array, energy\+\_\+array, uncertainty\+\_\+array, filename, ierr, H2, accept\+\_\+rate)
\begin{DoxyCompactList}\small\item\em Output results of H2 MCMC run. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_adbc78c0b592ef703a9e83b22b0fff0ae}{chain\+\_\+output\+\_\+1d}} (position\+\_\+array, energy\+\_\+array, filename, ierr)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a5db206d7abf62895d858d29209f0109f}{chain\+\_\+output\+\_\+3d}} (position\+\_\+array\+\_\+3d, energy\+\_\+array, filename, ierr)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d}{append\+\_\+to\+\_\+array}} (array, filename, ierr)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains Net\+CDF output functions for different problem main \& equilibration runs. 

Module containing output functions for quantum harmonic oscillator (QHO), hydrogen ion (H\+\_\+2\+\_\+plus) and hydrogen molecule (H\+\_\+2), for both main output MCMC runs and equilibration runs to determine burning / thinning parameters. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0}\label{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0}} 
\index{write\_netcdf@{write\_netcdf}!error\_check@{error\_check}}
\index{error\_check@{error\_check}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{error\_check()}{error\_check()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::error\+\_\+check (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ierr }\end{DoxyParamCaption})}



Checks error status at each point of Net\+CDF file build. 

Will print error message/code corresponding to ierr input. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ierr} & Internal error value \\
\hline
\end{DoxyParams}


Definition at line 42 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{43         \textcolor{keywordtype}{integer},\textcolor{keywordtype}{intent(in)} :: ierr}
\DoxyCodeLine{44         \textcolor{keywordflow}{if} (ierr /= nf90\_noerr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{45             print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{46             \textcolor{keywordflow}{return}}
\DoxyCodeLine{47 \textcolor{keywordflow}{        endif}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a8230e1f3b4a2c48c4b11f41141f6bb59}\label{namespacewrite__netcdf_a8230e1f3b4a2c48c4b11f41141f6bb59}} 
\index{write\_netcdf@{write\_netcdf}!write\_qho\_equilibration@{write\_qho\_equilibration}}
\index{write\_qho\_equilibration@{write\_qho\_equilibration}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_qho\_equilibration()}{write\_qho\_equilibration()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+qho\+\_\+equilibration (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{position\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1qho__type}{qho\+\_\+type}}), intent(in)}]{QHO,  }\item[{real(real64), intent(in)}]{accept\+\_\+rate,  }\item[{real(real64), intent(in)}]{alpha }\end{DoxyParamCaption})}



Output QHO system traces for equilibration. 

Takes problem specification for QHO system and writes the position and energy MCMC traces for use in equilibration runs. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em position\+\_\+array} & 1D position trace \\
\hline
\mbox{\texttt{ in}}  & {\em energy\+\_\+array} & 1D energy trace \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em QHO} & QHO type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & QHO wavefunction parameter \\
\hline
\end{DoxyParams}


Definition at line 73 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{75         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{76 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: position\_array, energy\_array}
\DoxyCodeLine{77         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{78         \textcolor{keywordtype}{type}(QHO\_type), \textcolor{keywordtype}{intent(in)} :: QHO}
\DoxyCodeLine{79 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: accept\_rate, alpha}
\DoxyCodeLine{80     }
\DoxyCodeLine{81     }
\DoxyCodeLine{82         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{83         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{84         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: n\_arrays = 2  \textcolor{comment}{! Number of arrays to output}}
\DoxyCodeLine{85         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{86         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{87         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(n\_arrays)} :: var\_id  \textcolor{comment}{! Variable IDs}}
\DoxyCodeLine{88         \textcolor{keywordtype}{integer} :: ierr, file\_id, i  \textcolor{comment}{! Error check status, file ID, iterator}}
\DoxyCodeLine{89         }
\DoxyCodeLine{90     }
\DoxyCodeLine{91         \textcolor{comment}{! Create file, overwrite if existing}}
\DoxyCodeLine{92         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{93         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{94     }
\DoxyCodeLine{95         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{96         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{97             ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{98 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{99 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{100     }
\DoxyCodeLine{101         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{102     }
\DoxyCodeLine{103         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, qho\%rcut)}
\DoxyCodeLine{104         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{105         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, qho\%sigma)}
\DoxyCodeLine{106         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{107         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{108 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{109         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}alpha"{}}, alpha)}
\DoxyCodeLine{110         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{111         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}QHO"{}})}
\DoxyCodeLine{112         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{113     }
\DoxyCodeLine{114     }
\DoxyCodeLine{115         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{116         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}positions"{}}, nf90\_double, dim\_id, var\_id\textcolor{comment}{(1))}}
\DoxyCodeLine{117 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{118 }
\DoxyCodeLine{119         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}energies"{}}, nf90\_double, dim\_id, var\_id\textcolor{comment}{(2))}}
\DoxyCodeLine{120 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{121     }
\DoxyCodeLine{122         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{123         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{124         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{125     }
\DoxyCodeLine{126         \textcolor{comment}{! Actually write 1D array}}
\DoxyCodeLine{127         ierr = nf90\_put\_var(file\_id, var\_id(1), position\_array) }
\DoxyCodeLine{128         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{129 }
\DoxyCodeLine{130         ierr = nf90\_put\_var(file\_id, var\_id(2), energy\_array) }
\DoxyCodeLine{131         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{132     }
\DoxyCodeLine{133         \textcolor{comment}{! Close file}}
\DoxyCodeLine{134         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{135         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{136     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_a8230e1f3b4a2c48c4b11f41141f6bb59_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_ae854a939c7da16a59b54d548a1b9a1ac}\label{namespacewrite__netcdf_ae854a939c7da16a59b54d548a1b9a1ac}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2plus\_equilibration@{write\_h2plus\_equilibration}}
\index{write\_h2plus\_equilibration@{write\_h2plus\_equilibration}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2plus\_equilibration()}{write\_h2plus\_equilibration()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2plus\+\_\+equilibration (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:, \+:), intent(in)}]{position\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2plus__type}{h2plus\+\_\+type}}), intent(in)}]{H2plus,  }\item[{real(real64), intent(in)}]{accept\+\_\+rate,  }\item[{real(real64), intent(in)}]{c,  }\item[{real(real64), intent(in)}]{bond\+\_\+length }\end{DoxyParamCaption})}



Output H2\+\_\+plus system trace for equilibration. 

Takes problem specification for H2plus system and writes the MCMC trace for use in equilibration runs. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em position\+\_\+array} & 3D position traces \\
\hline
\mbox{\texttt{ in}}  & {\em energy\+\_\+array} & 1D energy trace \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em H2plus} & H2plus type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\mbox{\texttt{ in}}  & {\em c} & H2plus system parameter \\
\hline
\mbox{\texttt{ in}}  & {\em bond\+\_\+length} & H2plus bondlength \\
\hline
\end{DoxyParams}


Definition at line 158 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{160         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{161 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:, :)} :: position\_array}
\DoxyCodeLine{162 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: energy\_array}
\DoxyCodeLine{163         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{164         \textcolor{keywordtype}{type}(H2plus\_type), \textcolor{keywordtype}{intent(in)} :: H2plus}
\DoxyCodeLine{165 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: accept\_rate}
\DoxyCodeLine{166 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: c}
\DoxyCodeLine{167 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: bond\_length}
\DoxyCodeLine{168     }
\DoxyCodeLine{169     }
\DoxyCodeLine{170         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{171         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=2  \textcolor{comment}{! Dimension of position array (2D)}}
\DoxyCodeLine{172         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: n\_arrays = 2  \textcolor{comment}{! Number of arrays to output}}
\DoxyCodeLine{173         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{174         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}y"{}}, \textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t,y axes}}
\DoxyCodeLine{175         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_lengths=(/3, nf90\_unlimited/)}
\DoxyCodeLine{176         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(n\_arrays)} :: var\_id  \textcolor{comment}{! Variable IDs}}
\DoxyCodeLine{177         \textcolor{keywordtype}{integer} :: ierr, file\_id, i  \textcolor{comment}{! Error check status, file ID, iterator }}
\DoxyCodeLine{178            }
\DoxyCodeLine{179         }
\DoxyCodeLine{180     }
\DoxyCodeLine{181         \textcolor{comment}{! Create file, overwrite if existing}}
\DoxyCodeLine{182         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{183         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{184     }
\DoxyCodeLine{185         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{186         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{187             ierr = nf90\_def\_dim(file\_id, dims(i), dim\_lengths(i), dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{188 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{189 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{190     }
\DoxyCodeLine{191         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{192     }
\DoxyCodeLine{193         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2plus\%rcut)}
\DoxyCodeLine{194         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{195         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2plus\%sigma)}
\DoxyCodeLine{196         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{197         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{198 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{199         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}parameter\_c"{}}, c)}
\DoxyCodeLine{200         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{201         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}bond\_length"{}}, bond\_length\textcolor{comment}{)}}
\DoxyCodeLine{202 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{203         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}H2plus"{}})}
\DoxyCodeLine{204         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{205     }
\DoxyCodeLine{206     }
\DoxyCodeLine{207         \textcolor{comment}{! Define variable types from 2D array(s) (real)}}
\DoxyCodeLine{208         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}positions"{}}, nf90\_double, dim\_id, var\_id\textcolor{comment}{(1))}}
\DoxyCodeLine{209 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{210 }
\DoxyCodeLine{211         \textcolor{comment}{! Define variable types from 1D array (real)}}
\DoxyCodeLine{212         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}energies"{}}, nf90\_double, dim\_id(2),\textcolor{comment}{ var\_id(2))}}
\DoxyCodeLine{213 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{214     }
\DoxyCodeLine{215         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{216         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{217         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{218     }
\DoxyCodeLine{219         \textcolor{comment}{! Actually write 2D array}}
\DoxyCodeLine{220         ierr = nf90\_put\_var(file\_id, var\_id(1), position\_array) }
\DoxyCodeLine{221         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{222         \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{223         ierr = nf90\_put\_var(file\_id, var\_id(2), energy\_array) }
\DoxyCodeLine{224         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{225     }
\DoxyCodeLine{226         \textcolor{comment}{! Close file}}
\DoxyCodeLine{227         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{228         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{229     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=317pt]{namespacewrite__netcdf_ae854a939c7da16a59b54d548a1b9a1ac_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a898caac40635ac6866326f0111b217c3}\label{namespacewrite__netcdf_a898caac40635ac6866326f0111b217c3}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2\_equilibration@{write\_h2\_equilibration}}
\index{write\_h2\_equilibration@{write\_h2\_equilibration}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2\_equilibration()}{write\_h2\_equilibration()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2\+\_\+equilibration (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:, \+:), intent(in)}]{position\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2__type}{h2\+\_\+type}}), intent(in)}]{H2,  }\item[{real(real64), intent(in)}]{accept\+\_\+rate,  }\item[{real(real64), intent(in)}]{beta,  }\item[{real(real64), intent(in)}]{bond\+\_\+length }\end{DoxyParamCaption})}



Output H2 system trace for equilibration. 

Takes problem specification for H2 system and writes the MCMC trace for use in equilibration runs. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em position\+\_\+array} & 3D position traces \\
\hline
\mbox{\texttt{ in}}  & {\em energy\+\_\+array} & 1D energy trace \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em H2} & H2 type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & H2 system parameter \\
\hline
\mbox{\texttt{ in}}  & {\em bond\+\_\+length} & H2 bondlength \\
\hline
\end{DoxyParams}


Definition at line 251 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{253         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{254 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:, :)} :: position\_array}
\DoxyCodeLine{255 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: energy\_array}
\DoxyCodeLine{256         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{257         \textcolor{keywordtype}{type}(H2\_type), \textcolor{keywordtype}{intent(in)} :: H2}
\DoxyCodeLine{258 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: accept\_rate}
\DoxyCodeLine{259 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: beta}
\DoxyCodeLine{260 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: bond\_length}
\DoxyCodeLine{261     }
\DoxyCodeLine{262     }
\DoxyCodeLine{263         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{264         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=2  \textcolor{comment}{! Dimension of position array (2D)}}
\DoxyCodeLine{265         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: n\_arrays = 2  \textcolor{comment}{! Number of arrays to output}}
\DoxyCodeLine{266         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{267         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}y"{}}, \textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t,y axes}}
\DoxyCodeLine{268         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_lengths=(/3, nf90\_unlimited/)}
\DoxyCodeLine{269         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(n\_arrays)} :: var\_id  \textcolor{comment}{! Variable IDs}}
\DoxyCodeLine{270         \textcolor{keywordtype}{integer} :: ierr, file\_id, i  \textcolor{comment}{! Error check status, file ID, iterator }}
\DoxyCodeLine{271         }
\DoxyCodeLine{272     }
\DoxyCodeLine{273         \textcolor{comment}{! Create file, overwrite if existing}}
\DoxyCodeLine{274         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{275         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{276     }
\DoxyCodeLine{277         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{278         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{279             ierr = nf90\_def\_dim(file\_id, dims(i), dim\_lengths(i), dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{280 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{281 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{282     }
\DoxyCodeLine{283         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{284     }
\DoxyCodeLine{285         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2\%rcut)}
\DoxyCodeLine{286         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{287         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2\%sigma)}
\DoxyCodeLine{288         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{289         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{290 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{291         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}beta"{}}, beta)}
\DoxyCodeLine{292         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{293         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}bond\_length"{}}, bond\_length\textcolor{comment}{)}}
\DoxyCodeLine{294 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{295         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}H2"{}})}
\DoxyCodeLine{296         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{297     }
\DoxyCodeLine{298     }
\DoxyCodeLine{299         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{300         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}positions"{}}, nf90\_double, dim\_id, var\_id\textcolor{comment}{(1))}}
\DoxyCodeLine{301 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{302 }
\DoxyCodeLine{303         \textcolor{comment}{! Define variable types from 1D array (real)}}
\DoxyCodeLine{304         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}energies"{}}, nf90\_double, dim\_id(2),\textcolor{comment}{ var\_id(2))}}
\DoxyCodeLine{305 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{306     }
\DoxyCodeLine{307         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{308         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{309         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{310     }
\DoxyCodeLine{311         \textcolor{comment}{! Actually write 2D array}}
\DoxyCodeLine{312         ierr = nf90\_put\_var(file\_id, var\_id(1), position\_array) }
\DoxyCodeLine{313         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{314         \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{315         ierr = nf90\_put\_var(file\_id, var\_id(2), energy\_array) }
\DoxyCodeLine{316         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{317     }
\DoxyCodeLine{318         \textcolor{comment}{! Close file}}
\DoxyCodeLine{319         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{320         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{321     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_a898caac40635ac6866326f0111b217c3_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a52defafffa63a95ffa92b26d2cb73b63}\label{namespacewrite__netcdf_a52defafffa63a95ffa92b26d2cb73b63}} 
\index{write\_netcdf@{write\_netcdf}!write\_qho\_main@{write\_qho\_main}}
\index{write\_qho\_main@{write\_qho\_main}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_qho\_main()}{write\_qho\_main()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+qho\+\_\+main (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{alpha\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{uncertainty\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1qho__type}{qho\+\_\+type}}), intent(in)}]{QHO,  }\item[{real(real64), dimension(\+:), intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Output results of QHO MCMC run. 

Outputs arrays of parameter (alpha) and energies at those values to be visualised, as well as run information as metadata. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em alpha\+\_\+array} & Array of alpha values \\
\hline
\mbox{\texttt{ in}}  & {\em energy\+\_\+array} & Array of energy values \\
\hline
\mbox{\texttt{ in}}  & {\em uncertainty\+\_\+array} & Array of uncertainties in energy \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em QHO} & QHO type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\end{DoxyParams}


Definition at line 347 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{348         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{349 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: alpha\_array, energy\_array\textcolor{comment}{, uncertainty\_array}}
\DoxyCodeLine{350 \textcolor{comment}{        }\textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{351         \textcolor{keywordtype}{type}(QHO\_type), \textcolor{keywordtype}{intent(in)} :: QHO}
\DoxyCodeLine{352 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: accept\_rate}
\DoxyCodeLine{353     }
\DoxyCodeLine{354     }
\DoxyCodeLine{355         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{356         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{357         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{358         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{359         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, var\_id\_, var\_id\_\_, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{360         }
\DoxyCodeLine{361     }
\DoxyCodeLine{362         \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{363         \textcolor{comment}{! Check this! May need care if splitting write into sections}}
\DoxyCodeLine{364         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{365         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{366     }
\DoxyCodeLine{367         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{368         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{369             ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{370 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{371 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{372     }
\DoxyCodeLine{373         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{374     }
\DoxyCodeLine{375         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}burn\_step"{}}, qho\%burn\_step\textcolor{comment}{)}}
\DoxyCodeLine{376 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{377         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}thin\_step"{}}, qho\%thin\_step\textcolor{comment}{)}}
\DoxyCodeLine{378 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{379         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, qho\%rcut)}
\DoxyCodeLine{380         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{381         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, qho\%sigma)}
\DoxyCodeLine{382         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{383         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{384 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{385         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}QHO"{}})}
\DoxyCodeLine{386         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{387     }
\DoxyCodeLine{388         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{389         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Alpha\_array"{}}, nf90\_double, dim\_id,\textcolor{comment}{ var\_id)}}
\DoxyCodeLine{390 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{391     }
\DoxyCodeLine{392         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}total\_energies"{}}, nf90\_double, dim\_id\textcolor{comment}{, var\_id\_)}}
\DoxyCodeLine{393 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{394 }
\DoxyCodeLine{395         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Uncertainties"{}}, nf90\_double, dim\_id\textcolor{comment}{, var\_id\_\_)}}
\DoxyCodeLine{396 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{397     }
\DoxyCodeLine{398         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{399         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{400         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{401     }
\DoxyCodeLine{402         \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{403         ierr = nf90\_put\_var(file\_id, var\_id, alpha\_array) }
\DoxyCodeLine{404         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{405     }
\DoxyCodeLine{406         ierr = nf90\_put\_var(file\_id, var\_id\_, energy\_array)}
\DoxyCodeLine{407         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{408 }
\DoxyCodeLine{409         ierr = nf90\_put\_var(file\_id, var\_id\_\_, uncertainty\_array)}
\DoxyCodeLine{410         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{411     }
\DoxyCodeLine{412         \textcolor{comment}{! Close file}}
\DoxyCodeLine{413         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{414         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{415     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_a52defafffa63a95ffa92b26d2cb73b63_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a4bf61fdf7f8ca9add5bb9b1663906542}\label{namespacewrite__netcdf_a4bf61fdf7f8ca9add5bb9b1663906542}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2plus\_main@{write\_h2plus\_main}}
\index{write\_h2plus\_main@{write\_h2plus\_main}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2plus\_main()}{write\_h2plus\_main()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2plus\+\_\+main (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{param\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{bondlength\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{uncertainty\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2plus__type}{h2plus\+\_\+type}}), intent(in)}]{H2plus,  }\item[{real(real64), dimension(\+:), intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Output results of H2plus MCMC run. 

Outputs arrays of bondlength and energies to be visualised, as well as run information as metadata. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em param\+\_\+array} & Array of H2plus system parameters c \\
\hline
\mbox{\texttt{ in}}  & {\em bondlength\+\_\+array} & Array of bondlengths \\
\hline
\mbox{\texttt{ in}}  & {\em energy\+\_\+array} & Array of energy values \\
\hline
\mbox{\texttt{ in}}  & {\em uncertainty\+\_\+array} & Array of uncertainties in energy \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em H2plus} & H2plus type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\end{DoxyParams}


Definition at line 437 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{439 }
\DoxyCodeLine{440         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{441 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: param\_array, bondlength\_array}
\DoxyCodeLine{442 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: energy\_array, uncertainty\_array}
\DoxyCodeLine{443         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{444         \textcolor{keywordtype}{type}(H2plus\_type), \textcolor{keywordtype}{intent(in)} :: H2plus}
\DoxyCodeLine{445 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: accept\_rate}
\DoxyCodeLine{446     }
\DoxyCodeLine{447     }
\DoxyCodeLine{448         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{449         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{450         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: n\_arrays = 4  \textcolor{comment}{! Number of arrays to output}}
\DoxyCodeLine{451         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{452         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{453         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(n\_arrays)} :: var\_id  \textcolor{comment}{! Variable IDs}}
\DoxyCodeLine{454         \textcolor{keywordtype}{integer} :: ierr, file\_id, i  \textcolor{comment}{! Error check status, file ID, iterator}}
\DoxyCodeLine{455         }
\DoxyCodeLine{456     }
\DoxyCodeLine{457         \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{458         \textcolor{comment}{! Check this! May need care if splitting write into sections}}
\DoxyCodeLine{459         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{460         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{461     }
\DoxyCodeLine{462         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{463         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{464             ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{465 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{466 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{467     }
\DoxyCodeLine{468         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{469     }
\DoxyCodeLine{470         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}burn\_step"{}}, h2plus\%burn\_step\textcolor{comment}{)}}
\DoxyCodeLine{471 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{472         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}thin\_step"{}}, h2plus\%thin\_step\textcolor{comment}{)}}
\DoxyCodeLine{473 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{474         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2plus\%rcut)}
\DoxyCodeLine{475         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{476         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2plus\%sigma)}
\DoxyCodeLine{477         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{478         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c\_grid"{}}, h2plus\%c\_grid\textcolor{comment}{)}}
\DoxyCodeLine{479 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{480         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{481 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{482         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}H2plus"{}})}
\DoxyCodeLine{483         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{484     }
\DoxyCodeLine{485     }
\DoxyCodeLine{486         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{487         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Parameter\_array"{}}, nf90\_double, dim\_id\textcolor{comment}{, var\_id(1))}}
\DoxyCodeLine{488 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{489 }
\DoxyCodeLine{490         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Bondlength\_array"{}}, nf90\_double, dim\_id\textcolor{comment}{, var\_id(2))}}
\DoxyCodeLine{491 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{492     }
\DoxyCodeLine{493         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}total\_energies"{}}, nf90\_double, dim\_id\textcolor{comment}{, var\_id(3))}}
\DoxyCodeLine{494 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{495 }
\DoxyCodeLine{496         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Uncertainties"{}}, nf90\_double, dim\_id\textcolor{comment}{, var\_id(4))}}
\DoxyCodeLine{497 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{498     }
\DoxyCodeLine{499         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{500         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{501         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{502     }
\DoxyCodeLine{503         \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{504         ierr = nf90\_put\_var(file\_id, var\_id(1), param\_array) }
\DoxyCodeLine{505         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{506 }
\DoxyCodeLine{507         ierr = nf90\_put\_var(file\_id, var\_id(2), bondlength\_array) }
\DoxyCodeLine{508         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{509     }
\DoxyCodeLine{510         ierr = nf90\_put\_var(file\_id, var\_id(3), energy\_array)}
\DoxyCodeLine{511         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{512 }
\DoxyCodeLine{513         ierr = nf90\_put\_var(file\_id, var\_id(4), uncertainty\_array)}
\DoxyCodeLine{514         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{515     }
\DoxyCodeLine{516         \textcolor{comment}{! Close file}}
\DoxyCodeLine{517         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{518         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{519     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_a4bf61fdf7f8ca9add5bb9b1663906542_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=326pt]{namespacewrite__netcdf_a4bf61fdf7f8ca9add5bb9b1663906542_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a8d49ffe8b78e85c17f3127d8dc89a83b}\label{namespacewrite__netcdf_a8d49ffe8b78e85c17f3127d8dc89a83b}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2\_main@{write\_h2\_main}}
\index{write\_h2\_main@{write\_h2\_main}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2\_main()}{write\_h2\_main()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2\+\_\+main (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{param\+\_\+a\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{param\+\_\+beta\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{bondlength\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{uncertainty\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2__type}{h2\+\_\+type}}), intent(in)}]{H2,  }\item[{real(real64), dimension(\+:), intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Output results of H2 MCMC run. 

Outputs arrays of bondlength and energies to be visualised, as well as run information as metadata. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em param\+\_\+a\+\_\+array} & Array of H2 system a parameters \\
\hline
\mbox{\texttt{ in}}  & {\em param\+\_\+beta\+\_\+array} & Array of H2 system beta parameters \\
\hline
\mbox{\texttt{ in}}  & {\em bondlength\+\_\+array} & Array of bondlengths \\
\hline
\mbox{\texttt{ in}}  & {\em energy\+\_\+array} & Array of energy values \\
\hline
\mbox{\texttt{ in}}  & {\em uncertainty\+\_\+array} & Array of uncertainties in energy \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em H2} & H2 type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\end{DoxyParams}


Definition at line 542 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{544         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{545 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: param\_a\_array, param\_beta\_array}
\DoxyCodeLine{546 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: bondlength\_array, energy\_array}
\DoxyCodeLine{547 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: uncertainty\_array}
\DoxyCodeLine{548         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{549         \textcolor{keywordtype}{type}(H2\_type), \textcolor{keywordtype}{intent(in)} :: H2}
\DoxyCodeLine{550 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: accept\_rate}
\DoxyCodeLine{551     }
\DoxyCodeLine{552     }
\DoxyCodeLine{553         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{554         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{555         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: n\_arrays = 5  \textcolor{comment}{! Number of arrays to output}}
\DoxyCodeLine{556         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{557         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{558         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(n\_arrays)} :: var\_id  \textcolor{comment}{! Variable IDs}}
\DoxyCodeLine{559         \textcolor{keywordtype}{integer} :: ierr, file\_id, i  \textcolor{comment}{! Error check status, file ID, iterator}}
\DoxyCodeLine{560         }
\DoxyCodeLine{561     }
\DoxyCodeLine{562         \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{563         \textcolor{comment}{! Check this! May need care if splitting write into sections}}
\DoxyCodeLine{564         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{565         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{566     }
\DoxyCodeLine{567         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{568         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{569             ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{570 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{571 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{572     }
\DoxyCodeLine{573         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{574     }
\DoxyCodeLine{575         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}burn\_step"{}}, h2\%burn\_step\textcolor{comment}{)}}
\DoxyCodeLine{576 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{577         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}thin\_step"{}}, h2\%thin\_step\textcolor{comment}{)}}
\DoxyCodeLine{578 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{579         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2\%rcut)}
\DoxyCodeLine{580         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{581         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2\%sigma)}
\DoxyCodeLine{582         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{583         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}beta\_grid"{}}, h2\%beta\_grid\textcolor{comment}{)}}
\DoxyCodeLine{584 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{585         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{586 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{587         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}H2"{}})}
\DoxyCodeLine{588         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{589     }
\DoxyCodeLine{590     }
\DoxyCodeLine{591         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{592         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Parameter\_a\_array"{}}, nf90\_double, dim\_id\textcolor{comment}{, var\_id(1))}}
\DoxyCodeLine{593 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{594 }
\DoxyCodeLine{595         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Parameter\_beta\_array"{}}, nf90\_double\textcolor{comment}{, dim\_id, var\_id(2))}}
\DoxyCodeLine{596 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{597 }
\DoxyCodeLine{598         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Bondlength\_array"{}}, nf90\_double, dim\_id\textcolor{comment}{, var\_id(3))}}
\DoxyCodeLine{599 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{600     }
\DoxyCodeLine{601         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}total\_energies"{}}, nf90\_double, dim\_id\textcolor{comment}{, var\_id(4))}}
\DoxyCodeLine{602 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{603 }
\DoxyCodeLine{604         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Uncertainties"{}}, nf90\_double, dim\_id\textcolor{comment}{, var\_id(5))}}
\DoxyCodeLine{605 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{606     }
\DoxyCodeLine{607         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{608         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{609         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{610     }
\DoxyCodeLine{611         \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{612         ierr = nf90\_put\_var(file\_id, var\_id(1), param\_a\_array) }
\DoxyCodeLine{613         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{614 }
\DoxyCodeLine{615         ierr = nf90\_put\_var(file\_id, var\_id(2), param\_beta\_array) }
\DoxyCodeLine{616         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{617 }
\DoxyCodeLine{618         ierr = nf90\_put\_var(file\_id, var\_id(3), bondlength\_array) }
\DoxyCodeLine{619         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{620     }
\DoxyCodeLine{621         ierr = nf90\_put\_var(file\_id, var\_id(4), energy\_array)}
\DoxyCodeLine{622         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{623 }
\DoxyCodeLine{624         ierr = nf90\_put\_var(file\_id, var\_id(5), uncertainty\_array)}
\DoxyCodeLine{625         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{626     }
\DoxyCodeLine{627         \textcolor{comment}{! Close file}}
\DoxyCodeLine{628         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{629         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{630     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_a8d49ffe8b78e85c17f3127d8dc89a83b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=326pt]{namespacewrite__netcdf_a8d49ffe8b78e85c17f3127d8dc89a83b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_adbc78c0b592ef703a9e83b22b0fff0ae}\label{namespacewrite__netcdf_adbc78c0b592ef703a9e83b22b0fff0ae}} 
\index{write\_netcdf@{write\_netcdf}!chain\_output\_1d@{chain\_output\_1d}}
\index{chain\_output\_1d@{chain\_output\_1d}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{chain\_output\_1d()}{chain\_output\_1d()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::chain\+\_\+output\+\_\+1d (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{position\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr }\end{DoxyParamCaption})}



Definition at line 635 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{636     \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{637 \textcolor{keywordtype}{    real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: position\_array, energy\_array}
\DoxyCodeLine{638     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{639 }
\DoxyCodeLine{640     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{641     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{642     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: n\_arrays = 2  \textcolor{comment}{! Number of arrays to output}}
\DoxyCodeLine{643     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{644     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{645     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(n\_arrays)} :: var\_id  \textcolor{comment}{! Variable IDs}}
\DoxyCodeLine{646     \textcolor{keywordtype}{integer} :: ierr, file\_id, i  \textcolor{comment}{! Error check status, file ID, iterator}}
\DoxyCodeLine{647 }
\DoxyCodeLine{648     \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{649     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{650     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{651 }
\DoxyCodeLine{652     \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{653     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{654         ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id(i))}
\DoxyCodeLine{655         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{656 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{657 }
\DoxyCodeLine{658     \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{659     \textcolor{comment}{! TO DO}}
\DoxyCodeLine{660 }
\DoxyCodeLine{661     \textcolor{comment}{! Define variable types from 1D array (real)}}
\DoxyCodeLine{662     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Positions"{}}, nf90\_double, dim\_id, var\_id(1))}
\DoxyCodeLine{663     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{664 }
\DoxyCodeLine{665     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Energies"{}}, nf90\_double, dim\_id, var\_id(2))}
\DoxyCodeLine{666     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{667 }
\DoxyCodeLine{668     \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{669     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{670     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{671 }
\DoxyCodeLine{672     \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{673     ierr = nf90\_put\_var(file\_id, var\_id(1), position\_array) }
\DoxyCodeLine{674     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{675 }
\DoxyCodeLine{676     ierr = nf90\_put\_var(file\_id, var\_id(2), energy\_array) }
\DoxyCodeLine{677     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{678 }
\DoxyCodeLine{679     \textcolor{comment}{! Close file}}
\DoxyCodeLine{680     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{681     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{682 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=308pt]{namespacewrite__netcdf_adbc78c0b592ef703a9e83b22b0fff0ae_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a5db206d7abf62895d858d29209f0109f}\label{namespacewrite__netcdf_a5db206d7abf62895d858d29209f0109f}} 
\index{write\_netcdf@{write\_netcdf}!chain\_output\_3d@{chain\_output\_3d}}
\index{chain\_output\_3d@{chain\_output\_3d}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{chain\_output\_3d()}{chain\_output\_3d()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::chain\+\_\+output\+\_\+3d (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:,\+:), intent(in)}]{position\+\_\+array\+\_\+3d,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr }\end{DoxyParamCaption})}



Definition at line 686 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{687 }
\DoxyCodeLine{688     \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{689 \textcolor{keywordtype}{    real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:,:)} :: position\_array\_3d}
\DoxyCodeLine{690 \textcolor{keywordtype}{    real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: energy\_array}
\DoxyCodeLine{691     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{692 }
\DoxyCodeLine{693     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{694     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=2  \textcolor{comment}{! Dimension of position array (2D)}}
\DoxyCodeLine{695     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: n\_arrays = 2  \textcolor{comment}{! Number of arrays to output}}
\DoxyCodeLine{696     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{697     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}y"{}}, \textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t,y axes}}
\DoxyCodeLine{698     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_lengths=(/3, nf90\_unlimited/)}
\DoxyCodeLine{699     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(n\_arrays)} :: var\_id  \textcolor{comment}{! Variable IDs}}
\DoxyCodeLine{700     \textcolor{keywordtype}{integer} :: ierr, file\_id, i  \textcolor{comment}{! Error check status, file ID, iterator}}
\DoxyCodeLine{701 }
\DoxyCodeLine{702     \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{703     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{704     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{705 }
\DoxyCodeLine{706     \textcolor{comment}{! 2D array, define dimensions }}
\DoxyCodeLine{707     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{708         ierr = nf90\_def\_dim(file\_id, dims(i), dim\_lengths(i), dim\_id(i))}
\DoxyCodeLine{709         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{710 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{711 }
\DoxyCodeLine{712     \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{713     \textcolor{comment}{! TO DO}}
\DoxyCodeLine{714 }
\DoxyCodeLine{715     \textcolor{comment}{! Define variable types from 2D array (real)}}
\DoxyCodeLine{716     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}3D Positions"{}}, nf90\_double, dim\_id, var\_id(1))}
\DoxyCodeLine{717     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{718     \textcolor{comment}{! Define variable types from 1D array (real)}}
\DoxyCodeLine{719     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Energies"{}}, nf90\_double, dim\_id(2), var\_id(2))}
\DoxyCodeLine{720     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{721 }
\DoxyCodeLine{722     \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{723     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{724     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{725 }
\DoxyCodeLine{726     \textcolor{comment}{! Actually write 2D array(s)}}
\DoxyCodeLine{727     ierr = nf90\_put\_var(file\_id, var\_id(1), position\_array\_3d) }
\DoxyCodeLine{728     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{729     \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{730     ierr = nf90\_put\_var(file\_id, var\_id(2), energy\_array) }
\DoxyCodeLine{731     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{732 }
\DoxyCodeLine{733     \textcolor{comment}{! Close file}}
\DoxyCodeLine{734     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{735     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{736 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=308pt]{namespacewrite__netcdf_a5db206d7abf62895d858d29209f0109f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d}\label{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d}} 
\index{write\_netcdf@{write\_netcdf}!append\_to\_array@{append\_to\_array}}
\index{append\_to\_array@{append\_to\_array}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{append\_to\_array()}{append\_to\_array()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::append\+\_\+to\+\_\+array (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(in)}]{array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr }\end{DoxyParamCaption})}



Definition at line 743 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{744     \textcolor{comment}{! Declaring inpit variables}}
\DoxyCodeLine{745 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: array}
\DoxyCodeLine{746     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{747 }
\DoxyCodeLine{748     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{749     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{750     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{751     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{752     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i, array\_length  \textcolor{comment}{! Error check status, file and variable ID, iterator}}
\DoxyCodeLine{753     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(1)} :: start\_array}
\DoxyCodeLine{754 }
\DoxyCodeLine{755 }
\DoxyCodeLine{756     \textcolor{comment}{! Open existing NetCDF file in read / write mode}}
\DoxyCodeLine{757     ierr = nf90\_open(filename, nf90\_write, file\_id)}
\DoxyCodeLine{758     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{759 }
\DoxyCodeLine{760     \textcolor{comment}{! Grab variable ID of Trace / 1D array}}
\DoxyCodeLine{761     ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}Trace"{}}, var\_id)}
\DoxyCodeLine{762     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{763 }
\DoxyCodeLine{764     \textcolor{comment}{! Grab dimension ID of Trace / 1D array ("{}t"{})}}
\DoxyCodeLine{765     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{766         ierr = nf90\_inq\_dimid(file\_id, dims(i), dim\_id(i))}
\DoxyCodeLine{767         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{768 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{769 }
\DoxyCodeLine{770     \textcolor{comment}{! Grab length of dimension / 1D array}}
\DoxyCodeLine{771     ierr = nf90\_inquire\_dimension(file\_id, dim\_id(1), dims(1), array\_length)}
\DoxyCodeLine{772     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{773 }
\DoxyCodeLine{774     start\_array(1) = array\_length}
\DoxyCodeLine{775 }
\DoxyCodeLine{776     \textcolor{comment}{! Write new data to end of 1D array }}
\DoxyCodeLine{777     ierr = nf90\_put\_var(file\_id, var\_id, array, start=start\_array)}
\DoxyCodeLine{778     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{779 }
\DoxyCodeLine{780     \textcolor{comment}{! Close file}}
\DoxyCodeLine{781     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{782     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{783 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=316pt]{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d_cgraph}
\end{center}
\end{figure}
