\hypertarget{namespacewrite__netcdf}{}\doxysection{write\+\_\+netcdf Module Reference}
\label{namespacewrite__netcdf}\index{write\_netcdf@{write\_netcdf}}


Contains Net\+CDF output functions for different problem main \& equilibration runs.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0}{error\+\_\+check}} (ierr)
\begin{DoxyCompactList}\small\item\em Checks error status at each point of Net\+CDF file build. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a4b9b251a06719d1b0470cfc1f03883ab}{write\+\_\+qho\+\_\+equilibration}} (trace, filename, ierr, QHO, accept\+\_\+rate, alpha)
\begin{DoxyCompactList}\small\item\em Output QHO system trace for equilibration. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a45c5f8affdc7b8d275bc35f8b70337f4}{write\+\_\+h2plus\+\_\+equilibration}} (trace, filename, ierr, H2plus, accept\+\_\+rate)
\begin{DoxyCompactList}\small\item\em Output H2\+\_\+plus system trace for equilibration. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_adc83694755df0f3d9228fb9aa0874452}{write\+\_\+h2\+\_\+equilibration}} (trace, filename, ierr, H2, accept\+\_\+rate)
\begin{DoxyCompactList}\small\item\em Output H2 system trace for equilibration. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a52defafffa63a95ffa92b26d2cb73b63}{write\+\_\+qho\+\_\+main}} (alpha\+\_\+array, energy\+\_\+array, uncertainty\+\_\+array, filename, ierr, QHO, accept\+\_\+rate)
\begin{DoxyCompactList}\small\item\em Output results of QHO MCMC run. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_accb73605be2b95f9e6e7e2b39b62c0b6}{write\+\_\+h2plus\+\_\+main}} (bondlength\+\_\+array, energy\+\_\+array, uncertainty\+\_\+array, filename, ierr, H2plus, accept\+\_\+rate)
\begin{DoxyCompactList}\small\item\em Output results of H2plus MCMC run. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_adf301f52f20c062efd625273263426e0}{write\+\_\+h2\+\_\+main}} (bondlength\+\_\+array, energy\+\_\+array, uncertainty\+\_\+array, filename, ierr, H2, accept\+\_\+rate)
\begin{DoxyCompactList}\small\item\em Output results of H2 MCMC run. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a2bb2db22caee970631d3e9c8f1ee16cc}{position\+\_\+output\+\_\+1d}} (position\+\_\+array, filename, ierr)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_ad07f7eae9a3f4604743ca2d18addd413}{position\+\_\+output\+\_\+3d}} (position\+\_\+array\+\_\+3d, filename, ierr)
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d}{append\+\_\+to\+\_\+array}} (array, filename, ierr)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains Net\+CDF output functions for different problem main \& equilibration runs. 

Module containing output functions for quantum harmonic oscillator (QHO), hydrogen ion (H\+\_\+2\+\_\+plus) and hydrogen molecule (H\+\_\+2), for both main output MCMC runs and equilibration runs to determine burning / thinning parameters. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0}\label{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0}} 
\index{write\_netcdf@{write\_netcdf}!error\_check@{error\_check}}
\index{error\_check@{error\_check}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{error\_check()}{error\_check()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::error\+\_\+check (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ierr }\end{DoxyParamCaption})}



Checks error status at each point of Net\+CDF file build. 

Will print error message/code corresponding to ierr input. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ierr} & Internal error value \\
\hline
\end{DoxyParams}


Definition at line 42 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{43         \textcolor{keywordtype}{integer},\textcolor{keywordtype}{intent(in)} :: ierr}
\DoxyCodeLine{44         \textcolor{keywordflow}{if} (ierr /= nf90\_noerr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{45             print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{46             \textcolor{keywordflow}{return}}
\DoxyCodeLine{47 \textcolor{keywordflow}{        endif}}

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacewrite__netcdf_aca2bb13e88c9dbfc7d0027b1bd83d9d0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a4b9b251a06719d1b0470cfc1f03883ab}\label{namespacewrite__netcdf_a4b9b251a06719d1b0470cfc1f03883ab}} 
\index{write\_netcdf@{write\_netcdf}!write\_qho\_equilibration@{write\_qho\_equilibration}}
\index{write\_qho\_equilibration@{write\_qho\_equilibration}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_qho\_equilibration()}{write\_qho\_equilibration()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+qho\+\_\+equilibration (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{trace,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1qho__type}{qho\+\_\+type}}), intent(in)}]{QHO,  }\item[{real(real64), intent(in)}]{accept\+\_\+rate,  }\item[{real(real64), intent(in)}]{alpha }\end{DoxyParamCaption})}



Output QHO system trace for equilibration. 

Takes problem specification for QHO system and writes the MCMC trace for use in equilibration runs. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em trace} & MCMC trace \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em QHO} & QHO type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & QHO wavefunction parameter \\
\hline
\end{DoxyParams}


Definition at line 72 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{73         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{74 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: trace}
\DoxyCodeLine{75         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{76         \textcolor{keywordtype}{type}(QHO\_type), \textcolor{keywordtype}{intent(in)} :: QHO}
\DoxyCodeLine{77 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: accept\_rate, alpha}
\DoxyCodeLine{78     }
\DoxyCodeLine{79     }
\DoxyCodeLine{80         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{81         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{82         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{83         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{84         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{85         }
\DoxyCodeLine{86     }
\DoxyCodeLine{87         \textcolor{comment}{! Create file, overwrite if existing}}
\DoxyCodeLine{88         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{89         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{90     }
\DoxyCodeLine{91         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{92         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{93             ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{94 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{95 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{96     }
\DoxyCodeLine{97         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{98     }
\DoxyCodeLine{99         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, qho\%rcut)}
\DoxyCodeLine{100         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{101         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, qho\%sigma)}
\DoxyCodeLine{102         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{103         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{104 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{105         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}alpha"{}}, alpha)}
\DoxyCodeLine{106         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{107         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}QHO"{}})}
\DoxyCodeLine{108         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{109     }
\DoxyCodeLine{110     }
\DoxyCodeLine{111         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{112         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Trace"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{113         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{114     }
\DoxyCodeLine{115         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{116         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{117         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{118     }
\DoxyCodeLine{119         \textcolor{comment}{! Actually write 1D array}}
\DoxyCodeLine{120         ierr = nf90\_put\_var(file\_id, var\_id, trace) }
\DoxyCodeLine{121         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{122     }
\DoxyCodeLine{123         \textcolor{comment}{! Close file}}
\DoxyCodeLine{124         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{125         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{126     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_a4b9b251a06719d1b0470cfc1f03883ab_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{namespacewrite__netcdf_a4b9b251a06719d1b0470cfc1f03883ab_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a45c5f8affdc7b8d275bc35f8b70337f4}\label{namespacewrite__netcdf_a45c5f8affdc7b8d275bc35f8b70337f4}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2plus\_equilibration@{write\_h2plus\_equilibration}}
\index{write\_h2plus\_equilibration@{write\_h2plus\_equilibration}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2plus\_equilibration()}{write\_h2plus\_equilibration()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2plus\+\_\+equilibration (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{trace,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2plus__type}{h2plus\+\_\+type}}), intent(in)}]{H2plus,  }\item[{real(real64), intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Output H2\+\_\+plus system trace for equilibration. 

Takes problem specification for H2plus system and writes the MCMC trace for use in equilibration runs. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em trace} & MCMC trace \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em H2plus} & H2plus type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\end{DoxyParams}


Definition at line 145 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{146         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{147 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: trace}
\DoxyCodeLine{148         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{149         \textcolor{keywordtype}{type}(H2plus\_type), \textcolor{keywordtype}{intent(in)} :: H2plus}
\DoxyCodeLine{150 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: accept\_rate}
\DoxyCodeLine{151     }
\DoxyCodeLine{152     }
\DoxyCodeLine{153         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{154         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{155         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{156         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{157         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{158         }
\DoxyCodeLine{159     }
\DoxyCodeLine{160         \textcolor{comment}{! Create file, overwrite if existing}}
\DoxyCodeLine{161         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{162         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{163     }
\DoxyCodeLine{164         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{165         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{166             ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{167 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{168 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{169     }
\DoxyCodeLine{170         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{171     }
\DoxyCodeLine{172         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2plus\%rcut)}
\DoxyCodeLine{173         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{174         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2plus\%sigma)}
\DoxyCodeLine{175         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{176         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}include\_pqn"{}}, h2plus\%include\_pqn\textcolor{comment}{)}}
\DoxyCodeLine{177 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{178         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{179 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{180         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c1"{}}, h2plus\%c1)}
\DoxyCodeLine{181         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{182         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c2"{}}, h2plus\%c2)}
\DoxyCodeLine{183         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{184         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}H2plus"{}})}
\DoxyCodeLine{185         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{186     }
\DoxyCodeLine{187     }
\DoxyCodeLine{188         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{189         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Trace"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{190         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{191     }
\DoxyCodeLine{192         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{193         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{194         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{195     }
\DoxyCodeLine{196         \textcolor{comment}{! Actually write 1D array}}
\DoxyCodeLine{197         ierr = nf90\_put\_var(file\_id, var\_id, trace) }
\DoxyCodeLine{198         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{199     }
\DoxyCodeLine{200         \textcolor{comment}{! Close file}}
\DoxyCodeLine{201         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{202         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{203     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=317pt]{namespacewrite__netcdf_a45c5f8affdc7b8d275bc35f8b70337f4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=261pt]{namespacewrite__netcdf_a45c5f8affdc7b8d275bc35f8b70337f4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_adc83694755df0f3d9228fb9aa0874452}\label{namespacewrite__netcdf_adc83694755df0f3d9228fb9aa0874452}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2\_equilibration@{write\_h2\_equilibration}}
\index{write\_h2\_equilibration@{write\_h2\_equilibration}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2\_equilibration()}{write\_h2\_equilibration()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2\+\_\+equilibration (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{trace,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2__type}{h2\+\_\+type}}), intent(in)}]{H2,  }\item[{real(real64), intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Output H2 system trace for equilibration. 

Takes problem specification for H2 system and writes the MCMC trace for use in equilibration runs. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em trace} & MCMC trace \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em H2} & H2 type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\end{DoxyParams}


Definition at line 222 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{223         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{224 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: trace}
\DoxyCodeLine{225         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{226         \textcolor{keywordtype}{type}(H2\_type), \textcolor{keywordtype}{intent(in)} :: H2}
\DoxyCodeLine{227 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)} :: accept\_rate}
\DoxyCodeLine{228     }
\DoxyCodeLine{229     }
\DoxyCodeLine{230         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{231         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{232         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{233         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{234         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{235         }
\DoxyCodeLine{236     }
\DoxyCodeLine{237         \textcolor{comment}{! Create file, overwrite if existing}}
\DoxyCodeLine{238         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{239         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{240     }
\DoxyCodeLine{241         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{242         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{243             ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{244 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{245 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{246     }
\DoxyCodeLine{247         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{248     }
\DoxyCodeLine{249         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2\%rcut)}
\DoxyCodeLine{250         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{251         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2\%sigma)}
\DoxyCodeLine{252         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{253         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}include\_pqn"{}}, h2\%include\_pqn\textcolor{comment}{)}}
\DoxyCodeLine{254 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{255         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{256 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{257         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c1"{}}, h2\%c1)}
\DoxyCodeLine{258         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{259         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c2"{}}, h2\%c2)}
\DoxyCodeLine{260         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{261         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}H2"{}})}
\DoxyCodeLine{262         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{263     }
\DoxyCodeLine{264     }
\DoxyCodeLine{265         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{266         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Trace"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{267         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{268     }
\DoxyCodeLine{269         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{270         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{271         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{272     }
\DoxyCodeLine{273         \textcolor{comment}{! Actually write 1D array}}
\DoxyCodeLine{274         ierr = nf90\_put\_var(file\_id, var\_id, trace) }
\DoxyCodeLine{275         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{276     }
\DoxyCodeLine{277         \textcolor{comment}{! Close file}}
\DoxyCodeLine{278         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{279         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{280     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_adc83694755df0f3d9228fb9aa0874452_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a52defafffa63a95ffa92b26d2cb73b63}\label{namespacewrite__netcdf_a52defafffa63a95ffa92b26d2cb73b63}} 
\index{write\_netcdf@{write\_netcdf}!write\_qho\_main@{write\_qho\_main}}
\index{write\_qho\_main@{write\_qho\_main}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_qho\_main()}{write\_qho\_main()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+qho\+\_\+main (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{alpha\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{uncertainty\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1qho__type}{qho\+\_\+type}}), intent(in)}]{QHO,  }\item[{real(real64), dimension(\+:), intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Output results of QHO MCMC run. 

Outputs arrays of parameter (alpha) and energies at those values to be visualised, as well as run information as metadata. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em alpha\+\_\+array} & Array of alpha values \\
\hline
\mbox{\texttt{ in}}  & {\em energy\+\_\+array} & Array of energy values \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em QHO} & QHO type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\end{DoxyParams}


Definition at line 305 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{306         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{307 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: alpha\_array, energy\_array\textcolor{comment}{, uncertainty\_array}}
\DoxyCodeLine{308 \textcolor{comment}{        }\textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{309         \textcolor{keywordtype}{type}(QHO\_type), \textcolor{keywordtype}{intent(in)} :: QHO}
\DoxyCodeLine{310 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: accept\_rate}
\DoxyCodeLine{311     }
\DoxyCodeLine{312     }
\DoxyCodeLine{313         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{314         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{315         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{316         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{317         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, var\_id\_, var\_id\_\_, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{318         }
\DoxyCodeLine{319     }
\DoxyCodeLine{320         \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{321         \textcolor{comment}{! Check this! May need care if splitting write into sections}}
\DoxyCodeLine{322         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{323         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{324     }
\DoxyCodeLine{325         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{326         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{327             ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{328 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{329 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{330     }
\DoxyCodeLine{331         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{332     }
\DoxyCodeLine{333         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}burn\_step"{}}, qho\%burn\_step\textcolor{comment}{)}}
\DoxyCodeLine{334 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{335         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}thin\_step"{}}, qho\%thin\_step\textcolor{comment}{)}}
\DoxyCodeLine{336 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{337         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, qho\%rcut)}
\DoxyCodeLine{338         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{339         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, qho\%sigma)}
\DoxyCodeLine{340         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{341         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{342 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{343         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}QHO"{}})}
\DoxyCodeLine{344         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{345     }
\DoxyCodeLine{346         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{347         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Alpha\_array"{}}, nf90\_real, dim\_id, var\_id\textcolor{comment}{)}}
\DoxyCodeLine{348 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{349     }
\DoxyCodeLine{350         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}total\_energies"{}}, nf90\_real, dim\_id\textcolor{comment}{, var\_id\_)}}
\DoxyCodeLine{351 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{352 }
\DoxyCodeLine{353         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Uncertainties"{}}, nf90\_real, dim\_id,\textcolor{comment}{ var\_id\_\_)}}
\DoxyCodeLine{354 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{355     }
\DoxyCodeLine{356         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{357         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{358         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{359     }
\DoxyCodeLine{360         \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{361         ierr = nf90\_put\_var(file\_id, var\_id, alpha\_array) }
\DoxyCodeLine{362         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{363     }
\DoxyCodeLine{364         ierr = nf90\_put\_var(file\_id, var\_id\_, energy\_array)}
\DoxyCodeLine{365         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{366 }
\DoxyCodeLine{367         ierr = nf90\_put\_var(file\_id, var\_id\_\_, uncertainty\_array)}
\DoxyCodeLine{368         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{369     }
\DoxyCodeLine{370         \textcolor{comment}{! Close file}}
\DoxyCodeLine{371         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{372         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{373     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_a52defafffa63a95ffa92b26d2cb73b63_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{namespacewrite__netcdf_a52defafffa63a95ffa92b26d2cb73b63_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_accb73605be2b95f9e6e7e2b39b62c0b6}\label{namespacewrite__netcdf_accb73605be2b95f9e6e7e2b39b62c0b6}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2plus\_main@{write\_h2plus\_main}}
\index{write\_h2plus\_main@{write\_h2plus\_main}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2plus\_main()}{write\_h2plus\_main()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2plus\+\_\+main (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{bondlength\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{uncertainty\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2plus__type}{h2plus\+\_\+type}}), intent(in)}]{H2plus,  }\item[{real(real64), dimension(\+:), intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Output results of H2plus MCMC run. 

Outputs arrays of bondlength and energies to be visualised, as well as run information as metadata. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em bondlength\+\_\+array} & Array of bondlengths \\
\hline
\mbox{\texttt{ in}}  & {\em energy\+\_\+array} & Array of energy values \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em H2plus} & H2plus type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\end{DoxyParams}


Definition at line 393 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{394         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{395 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: bondlength\_array, energy\_array\textcolor{comment}{, uncertainty\_array}}
\DoxyCodeLine{396 \textcolor{comment}{        }\textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{397         \textcolor{keywordtype}{type}(H2plus\_type), \textcolor{keywordtype}{intent(in)} :: H2plus}
\DoxyCodeLine{398 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: accept\_rate}
\DoxyCodeLine{399     }
\DoxyCodeLine{400     }
\DoxyCodeLine{401         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{402         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{403         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{404         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{405         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, var\_id\_, var\_id\_\_, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{406         }
\DoxyCodeLine{407     }
\DoxyCodeLine{408         \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{409         \textcolor{comment}{! Check this! May need care if splitting write into sections}}
\DoxyCodeLine{410         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{411         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{412     }
\DoxyCodeLine{413         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{414         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{415             ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{416 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{417 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{418     }
\DoxyCodeLine{419         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{420     }
\DoxyCodeLine{421         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}burn\_step"{}}, h2plus\%burn\_step\textcolor{comment}{)}}
\DoxyCodeLine{422 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{423         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}thin\_step"{}}, h2plus\%thin\_step\textcolor{comment}{)}}
\DoxyCodeLine{424 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{425         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2plus\%rcut)}
\DoxyCodeLine{426         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{427         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2plus\%sigma)}
\DoxyCodeLine{428         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{429         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}include\_pqn"{}}, h2plus\%include\_pqn\textcolor{comment}{)}}
\DoxyCodeLine{430 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{431         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c1"{}}, h2plus\%c1)}
\DoxyCodeLine{432         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{433         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c2"{}}, h2plus\%c2)}
\DoxyCodeLine{434         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{435         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{436 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{437         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}H2plus"{}})}
\DoxyCodeLine{438         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{439     }
\DoxyCodeLine{440     }
\DoxyCodeLine{441         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{442         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Bondlength\_array"{}}, nf90\_real, dim\_id\textcolor{comment}{, var\_id)}}
\DoxyCodeLine{443 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{444     }
\DoxyCodeLine{445         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}total\_energies"{}}, nf90\_real, dim\_id\textcolor{comment}{, var\_id\_)}}
\DoxyCodeLine{446 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{447 }
\DoxyCodeLine{448         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Uncertainties"{}}, nf90\_real, dim\_id,\textcolor{comment}{ var\_id\_\_)}}
\DoxyCodeLine{449 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{450     }
\DoxyCodeLine{451         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{452         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{453         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{454     }
\DoxyCodeLine{455         \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{456         ierr = nf90\_put\_var(file\_id, var\_id, bondlength\_array) }
\DoxyCodeLine{457         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{458     }
\DoxyCodeLine{459         ierr = nf90\_put\_var(file\_id, var\_id\_, energy\_array)}
\DoxyCodeLine{460         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{461 }
\DoxyCodeLine{462         ierr = nf90\_put\_var(file\_id, var\_id\_\_, uncertainty\_array)}
\DoxyCodeLine{463         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{464     }
\DoxyCodeLine{465         \textcolor{comment}{! Close file}}
\DoxyCodeLine{466         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{467         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{468     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_accb73605be2b95f9e6e7e2b39b62c0b6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=249pt]{namespacewrite__netcdf_accb73605be2b95f9e6e7e2b39b62c0b6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_adf301f52f20c062efd625273263426e0}\label{namespacewrite__netcdf_adf301f52f20c062efd625273263426e0}} 
\index{write\_netcdf@{write\_netcdf}!write\_h2\_main@{write\_h2\_main}}
\index{write\_h2\_main@{write\_h2\_main}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{write\_h2\_main()}{write\_h2\_main()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+h2\+\_\+main (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{bondlength\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{energy\+\_\+array,  }\item[{real(real64), dimension(\+:), intent(in)}]{uncertainty\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr,  }\item[{type(\mbox{\hyperlink{structshared__data_1_1h2__type}{h2\+\_\+type}}), intent(in)}]{H2,  }\item[{real(real64), dimension(\+:), intent(in)}]{accept\+\_\+rate }\end{DoxyParamCaption})}



Output results of H2 MCMC run. 

Outputs arrays of bondlength and energies to be visualised, as well as run information as metadata. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em bondlength\+\_\+array} & Array of bondlengths \\
\hline
\mbox{\texttt{ in}}  & {\em energy\+\_\+array} & Array of energy values \\
\hline
\mbox{\texttt{ in}}  & {\em filename} & Net\+CDF filename \\
\hline
\mbox{\texttt{ in}}  & {\em H2} & H2 type from shared data \\
\hline
\mbox{\texttt{ in}}  & {\em accept\+\_\+rate} & Acceptance rate of MCMC run \\
\hline
\end{DoxyParams}


Definition at line 488 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{489         \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{490 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: bondlength\_array, energy\_array\textcolor{comment}{, uncertainty\_array}}
\DoxyCodeLine{491 \textcolor{comment}{        }\textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{492         \textcolor{keywordtype}{type}(H2\_type), \textcolor{keywordtype}{intent(in)} :: H2}
\DoxyCodeLine{493 \textcolor{keywordtype}{        real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: accept\_rate}
\DoxyCodeLine{494     }
\DoxyCodeLine{495     }
\DoxyCodeLine{496         \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{497         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{498         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{499         \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{500         \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, var\_id\_, var\_id\_\_, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{501         }
\DoxyCodeLine{502     }
\DoxyCodeLine{503         \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{504         \textcolor{comment}{! Check this! May need care if splitting write into sections}}
\DoxyCodeLine{505         ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{506         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{507     }
\DoxyCodeLine{508         \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{509         \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{510             ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id\textcolor{comment}{(i))}}
\DoxyCodeLine{511 \textcolor{comment}{}            \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{512 \textcolor{keywordflow}{        enddo}}
\DoxyCodeLine{513     }
\DoxyCodeLine{514         \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{515     }
\DoxyCodeLine{516         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}burn\_step"{}}, h2\%burn\_step\textcolor{comment}{)}}
\DoxyCodeLine{517 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{518         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}thin\_step"{}}, h2\%thin\_step\textcolor{comment}{)}}
\DoxyCodeLine{519 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{520         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}rcut"{}}, h2\%rcut)}
\DoxyCodeLine{521         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{522         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}sigma"{}}, h2\%sigma)}
\DoxyCodeLine{523         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{524         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}include\_pqn"{}}, h2\%include\_pqn\textcolor{comment}{)}}
\DoxyCodeLine{525 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{526         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c1"{}}, h2\%c1)}
\DoxyCodeLine{527         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{528         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}c2"{}}, h2\%c2)}
\DoxyCodeLine{529         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{530         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}accept\_rate"{}}, accept\_rate\textcolor{comment}{)}}
\DoxyCodeLine{531 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{532         ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"{}system"{}}, \textcolor{stringliteral}{"{}H2"{}})}
\DoxyCodeLine{533         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{534     }
\DoxyCodeLine{535     }
\DoxyCodeLine{536         \textcolor{comment}{! Define variable types from 1D array(s) (real)}}
\DoxyCodeLine{537         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Bondlength\_array"{}}, nf90\_real, dim\_id\textcolor{comment}{, var\_id)}}
\DoxyCodeLine{538 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{539     }
\DoxyCodeLine{540         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}total\_energies"{}}, nf90\_real, dim\_id\textcolor{comment}{, var\_id\_)}}
\DoxyCodeLine{541 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{542 }
\DoxyCodeLine{543         ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Uncertainties"{}}, nf90\_real, dim\_id,\textcolor{comment}{ var\_id\_\_)}}
\DoxyCodeLine{544 \textcolor{comment}{}        \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{545     }
\DoxyCodeLine{546         \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{547         ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{548         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{549     }
\DoxyCodeLine{550         \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{551         ierr = nf90\_put\_var(file\_id, var\_id, bondlength\_array) }
\DoxyCodeLine{552         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{553     }
\DoxyCodeLine{554         ierr = nf90\_put\_var(file\_id, var\_id\_, energy\_array)}
\DoxyCodeLine{555         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{556 }
\DoxyCodeLine{557         ierr = nf90\_put\_var(file\_id, var\_id\_\_, uncertainty\_array)}
\DoxyCodeLine{558         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{559     }
\DoxyCodeLine{560         \textcolor{comment}{! Close file}}
\DoxyCodeLine{561         ierr = nf90\_close(file\_id)}
\DoxyCodeLine{562         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{563     }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{namespacewrite__netcdf_adf301f52f20c062efd625273263426e0_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a2bb2db22caee970631d3e9c8f1ee16cc}\label{namespacewrite__netcdf_a2bb2db22caee970631d3e9c8f1ee16cc}} 
\index{write\_netcdf@{write\_netcdf}!position\_output\_1d@{position\_output\_1d}}
\index{position\_output\_1d@{position\_output\_1d}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{position\_output\_1d()}{position\_output\_1d()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::position\+\_\+output\+\_\+1d (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:), intent(in)}]{position\+\_\+array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr }\end{DoxyParamCaption})}



Definition at line 568 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{569     \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{570 \textcolor{keywordtype}{    real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: position\_array}
\DoxyCodeLine{571     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{572 }
\DoxyCodeLine{573     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{574     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{575     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{576     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{577     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{578 }
\DoxyCodeLine{579     \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{580     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{581     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{582 }
\DoxyCodeLine{583     \textcolor{comment}{! 1D array, define dimension }}
\DoxyCodeLine{584     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{585         ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id(i))}
\DoxyCodeLine{586         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{587 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{588 }
\DoxyCodeLine{589     \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{590     \textcolor{comment}{! TO DO}}
\DoxyCodeLine{591 }
\DoxyCodeLine{592     \textcolor{comment}{! Define variable types from 1D array (real)}}
\DoxyCodeLine{593     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}Position array"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{594     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{595 }
\DoxyCodeLine{596     \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{597     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{598     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{599 }
\DoxyCodeLine{600     \textcolor{comment}{! Actually write 1D array(s)}}
\DoxyCodeLine{601     ierr = nf90\_put\_var(file\_id, var\_id, position\_array) }
\DoxyCodeLine{602     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{603 }
\DoxyCodeLine{604     \textcolor{comment}{! Close file}}
\DoxyCodeLine{605     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{606     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{607 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{namespacewrite__netcdf_a2bb2db22caee970631d3e9c8f1ee16cc_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_ad07f7eae9a3f4604743ca2d18addd413}\label{namespacewrite__netcdf_ad07f7eae9a3f4604743ca2d18addd413}} 
\index{write\_netcdf@{write\_netcdf}!position\_output\_3d@{position\_output\_3d}}
\index{position\_output\_3d@{position\_output\_3d}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{position\_output\_3d()}{position\_output\_3d()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::position\+\_\+output\+\_\+3d (\begin{DoxyParamCaption}\item[{real(real64), dimension(\+:,\+:), intent(in)}]{position\+\_\+array\+\_\+3d,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr }\end{DoxyParamCaption})}



Definition at line 611 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{612 }
\DoxyCodeLine{613     \textcolor{comment}{! Declaring input variables}}
\DoxyCodeLine{614 \textcolor{keywordtype}{    real}(real64), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:,:)} :: position\_array\_3d}
\DoxyCodeLine{615     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{616 }
\DoxyCodeLine{617     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{618     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=2  \textcolor{comment}{! Dimension of array (2D)}}
\DoxyCodeLine{619     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{620     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}y"{}}, \textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t,y axes}}
\DoxyCodeLine{621     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i  \textcolor{comment}{! Error check status, file and variable ID(s), iterator}}
\DoxyCodeLine{622 }
\DoxyCodeLine{623     \textcolor{comment}{! Create file, overwrite if existing  }}
\DoxyCodeLine{624     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{625     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{626 }
\DoxyCodeLine{627     \textcolor{comment}{! 2D array, define dimensions }}
\DoxyCodeLine{628     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{629         ierr = nf90\_def\_dim(file\_id, dims(i), nf90\_unlimited, dim\_id(i))}
\DoxyCodeLine{630         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{631 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{632 }
\DoxyCodeLine{633     \textcolor{comment}{! Global metadata}}
\DoxyCodeLine{634     \textcolor{comment}{! TO DO}}
\DoxyCodeLine{635 }
\DoxyCodeLine{636     \textcolor{comment}{! Define variable types from 2D array (real)}}
\DoxyCodeLine{637     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"{}3D Position array"{}}, nf90\_real, dim\_id, var\_id)}
\DoxyCodeLine{638     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{639 }
\DoxyCodeLine{640     \textcolor{comment}{! Finish defining metadata}}
\DoxyCodeLine{641     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{642     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{643 }
\DoxyCodeLine{644     \textcolor{comment}{! Actually write 2D array(s)}}
\DoxyCodeLine{645     ierr = nf90\_put\_var(file\_id, var\_id, position\_array\_3d) }
\DoxyCodeLine{646     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{647 }
\DoxyCodeLine{648     \textcolor{comment}{! Close file}}
\DoxyCodeLine{649     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{650     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{651 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{namespacewrite__netcdf_ad07f7eae9a3f4604743ca2d18addd413_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d}\label{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d}} 
\index{write\_netcdf@{write\_netcdf}!append\_to\_array@{append\_to\_array}}
\index{append\_to\_array@{append\_to\_array}!write\_netcdf@{write\_netcdf}}
\doxysubsubsection{\texorpdfstring{append\_to\_array()}{append\_to\_array()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::append\+\_\+to\+\_\+array (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(in)}]{array,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer}]{ierr }\end{DoxyParamCaption})}



Definition at line 658 of file netcdf\+\_\+out.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{659     \textcolor{comment}{! Declaring inpit variables}}
\DoxyCodeLine{660 \textcolor{keywordtype}{    real}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{dimension(:)} :: array}
\DoxyCodeLine{661     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: filename}
\DoxyCodeLine{662 }
\DoxyCodeLine{663     \textcolor{comment}{! Declaring other variables}}
\DoxyCodeLine{664     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter} :: ndims=1  \textcolor{comment}{! Dimension of array (1D)}}
\DoxyCodeLine{665     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(ndims)} :: dim\_id  \textcolor{comment}{! Size of array and dimension ID}}
\DoxyCodeLine{666     \textcolor{keywordtype}{character(len=1)}, \textcolor{keywordtype}{dimension(ndims)} :: dims=(/\textcolor{stringliteral}{"{}t"{}}/)  \textcolor{comment}{! Write along t axis}}
\DoxyCodeLine{667     \textcolor{keywordtype}{integer} :: ierr, file\_id, var\_id, i, array\_length  \textcolor{comment}{! Error check status, file and variable ID, iterator}}
\DoxyCodeLine{668     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(1)} :: start\_array}
\DoxyCodeLine{669 }
\DoxyCodeLine{670 }
\DoxyCodeLine{671     \textcolor{comment}{! Open existing NetCDF file in read / write mode}}
\DoxyCodeLine{672     ierr = nf90\_open(filename, nf90\_write, file\_id)}
\DoxyCodeLine{673     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{674 }
\DoxyCodeLine{675     \textcolor{comment}{! Grab variable ID of Trace / 1D array}}
\DoxyCodeLine{676     ierr = nf90\_inq\_varid(file\_id, \textcolor{stringliteral}{"{}Trace"{}}, var\_id)}
\DoxyCodeLine{677     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{678 }
\DoxyCodeLine{679     \textcolor{comment}{! Grab dimension ID of Trace / 1D array ("{}t"{})}}
\DoxyCodeLine{680     \textcolor{keywordflow}{do} i = 1, ndims}
\DoxyCodeLine{681         ierr = nf90\_inq\_dimid(file\_id, dims(i), dim\_id(i))}
\DoxyCodeLine{682         \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{683 \textcolor{keywordflow}{    enddo}}
\DoxyCodeLine{684 }
\DoxyCodeLine{685     \textcolor{comment}{! Grab length of dimension / 1D array}}
\DoxyCodeLine{686     ierr = nf90\_inquire\_dimension(file\_id, dim\_id(1), dims(1), array\_length)}
\DoxyCodeLine{687     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{688 }
\DoxyCodeLine{689     start\_array(1) = array\_length}
\DoxyCodeLine{690 }
\DoxyCodeLine{691     \textcolor{comment}{! Write new data to end of 1D array }}
\DoxyCodeLine{692     ierr = nf90\_put\_var(file\_id, var\_id, array, start=start\_array)}
\DoxyCodeLine{693     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{694 }
\DoxyCodeLine{695     \textcolor{comment}{! Close file}}
\DoxyCodeLine{696     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{697     \textcolor{keyword}{call }error\_check(ierr)}
\DoxyCodeLine{698 }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=316pt]{namespacewrite__netcdf_a6830bd805591aad1ec622d12037dd99d_cgraph}
\end{center}
\end{figure}
