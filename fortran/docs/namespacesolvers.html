<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>[Project Name] Fortran Backend Documentation: solvers Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">[Project Name] Fortran Backend Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacesolvers.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">solvers Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains local energy and transition probability solvers for available problems.  
<a href="namespacesolvers.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a722edf182d188ad1db7fa6a675fea13c"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a722edf182d188ad1db7fa6a675fea13c">qho_prob</a> (alpha, x_current, x_next)</td></tr>
<tr class="memdesc:a722edf182d188ad1db7fa6a675fea13c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates transition probability for quantum harmonic oscillator problem.  <a href="namespacesolvers.html#a722edf182d188ad1db7fa6a675fea13c">More...</a><br /></td></tr>
<tr class="separator:a722edf182d188ad1db7fa6a675fea13c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f0054c0d0d2f5080c92a04557feaf52"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a4f0054c0d0d2f5080c92a04557feaf52">qho_energy</a> (alpha, x)</td></tr>
<tr class="memdesc:a4f0054c0d0d2f5080c92a04557feaf52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates local energy for quantum harmonic oscillator problem.  <a href="namespacesolvers.html#a4f0054c0d0d2f5080c92a04557feaf52">More...</a><br /></td></tr>
<tr class="separator:a4f0054c0d0d2f5080c92a04557feaf52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d32620a8f8a8780a0b0ef83c490e8f7"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7">h1s_wfn</a> (r_elec, R_nuc)</td></tr>
<tr class="memdesc:a7d32620a8f8a8780a0b0ef83c490e8f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates value of the wavefunction of a hydrogen 1s orbital.  <a href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7">More...</a><br /></td></tr>
<tr class="separator:a7d32620a8f8a8780a0b0ef83c490e8f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89943685e3d86544f0261f24fac44419"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a89943685e3d86544f0261f24fac44419">h2s_wfn</a> (r_elec, R_nuc)</td></tr>
<tr class="memdesc:a89943685e3d86544f0261f24fac44419"><td class="mdescLeft">&#160;</td><td class="mdescRight">[DEPRECATED] Calculates value of the wavefunction of a hydrogen 2s orbital.  <a href="namespacesolvers.html#a89943685e3d86544f0261f24fac44419">More...</a><br /></td></tr>
<tr class="separator:a89943685e3d86544f0261f24fac44419"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d705d11696b64991f1624e298067bed"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed">h_2_plus_wfn</a> (c, r, R_a, R_b)</td></tr>
<tr class="memdesc:a6d705d11696b64991f1624e298067bed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates trial wavefunction for the \( H_{2}^{+} \) problem.  <a href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed">More...</a><br /></td></tr>
<tr class="separator:a6d705d11696b64991f1624e298067bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5695d107239a7a8fb1f8b096786af028"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a5695d107239a7a8fb1f8b096786af028">h_2_plus_prob</a> (c, r_current, r_next, R_a, R_b)</td></tr>
<tr class="memdesc:a5695d107239a7a8fb1f8b096786af028"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates transition probability for the \( H_{2}^{+} \) problem.  <a href="namespacesolvers.html#a5695d107239a7a8fb1f8b096786af028">More...</a><br /></td></tr>
<tr class="separator:a5695d107239a7a8fb1f8b096786af028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cc5ffb282a9d15708307d84f6cf147f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a9cc5ffb282a9d15708307d84f6cf147f">h_2_plus_energy</a> (c, r, R_a, R_b, E_loc, gradient)</td></tr>
<tr class="memdesc:a9cc5ffb282a9d15708307d84f6cf147f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates local energy for the \( H_{2}^{+} \) problem.  <a href="namespacesolvers.html#a9cc5ffb282a9d15708307d84f6cf147f">More...</a><br /></td></tr>
<tr class="separator:a9cc5ffb282a9d15708307d84f6cf147f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb91c2bfc7ae441b3e24f83d0f49d55a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#acb91c2bfc7ae441b3e24f83d0f49d55a">h_2_plus_update_c</a> (c_old, gradient, c_new)</td></tr>
<tr class="memdesc:acb91c2bfc7ae441b3e24f83d0f49d55a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the c parameter in the \( H_{2}^{+} \) problem by dampened steepest descent.  <a href="namespacesolvers.html#acb91c2bfc7ae441b3e24f83d0f49d55a">More...</a><br /></td></tr>
<tr class="separator:acb91c2bfc7ae441b3e24f83d0f49d55a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38259c21a02a250a91f45d79e4165742"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a38259c21a02a250a91f45d79e4165742">h_2_cusp</a> (s)</td></tr>
<tr class="memdesc:a38259c21a02a250a91f45d79e4165742"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a value for <b>a</b> given the bond length <b>s</b> by Newton-Raphson iteration.  <a href="namespacesolvers.html#a38259c21a02a250a91f45d79e4165742">More...</a><br /></td></tr>
<tr class="separator:a38259c21a02a250a91f45d79e4165742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac603f31a67286a6e89588cf4de29bd1b"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#ac603f31a67286a6e89588cf4de29bd1b">h_2_wfn</a> (a, beta, r_1, r_2, R_a, R_b)</td></tr>
<tr class="memdesc:ac603f31a67286a6e89588cf4de29bd1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates trial wavefunction for the \( H_{2} \) problem.  <a href="namespacesolvers.html#ac603f31a67286a6e89588cf4de29bd1b">More...</a><br /></td></tr>
<tr class="separator:ac603f31a67286a6e89588cf4de29bd1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac30d1c7141f673647e837524ecb26b07"><td class="memItemLeft" align="right" valign="top">real(real64) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#ac30d1c7141f673647e837524ecb26b07">h_2_prob</a> (a, beta, r_1_current, r_2_current, r_1_next, r_2_next, R_a, R_b)</td></tr>
<tr class="memdesc:ac30d1c7141f673647e837524ecb26b07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates transition probability for the \( H_{2} \) problem.  <a href="namespacesolvers.html#ac30d1c7141f673647e837524ecb26b07">More...</a><br /></td></tr>
<tr class="separator:ac30d1c7141f673647e837524ecb26b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9afbcdcc0405d544d4441e9786f440a2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a9afbcdcc0405d544d4441e9786f440a2">h_2_energy</a> (a, beta, r_1, r_2, R_a, R_b, E_loc, DphiDbeta)</td></tr>
<tr class="memdesc:a9afbcdcc0405d544d4441e9786f440a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">{UPDATE ME} Calculates local energy for the \( H_{2} \) problem.  <a href="namespacesolvers.html#a9afbcdcc0405d544d4441e9786f440a2">More...</a><br /></td></tr>
<tr class="separator:a9afbcdcc0405d544d4441e9786f440a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4d370a4ee50b231f53058ab62e4084"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesolvers.html#a4b4d370a4ee50b231f53058ab62e4084">h_2_update_beta</a> (beta_old, gradient, beta_new)</td></tr>
<tr class="memdesc:a4b4d370a4ee50b231f53058ab62e4084"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the \( \beta \) parameter in the \( H_{2}^{+} \) problem by dampened steepest descent.  <a href="namespacesolvers.html#a4b4d370a4ee50b231f53058ab62e4084">More...</a><br /></td></tr>
<tr class="separator:a4b4d370a4ee50b231f53058ab62e4084"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains local energy and transition probability solvers for available problems. </p>
<p>Module containing quantum mechanical solvers for local energy and Metropolis algorithm probability. Contains solvers for quantum harmonic oscillator (QHO), hydrogen ion (H_2_plus) and hydrogen molecule (H_2). Solvers can be linked to a function pointer by the input parsing module, depending on the problem specified by the input. This way, the main code and the VQMC algorithm can be made (mostly) independent of problem choice. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a722edf182d188ad1db7fa6a675fea13c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a722edf182d188ad1db7fa6a675fea13c">&#9670;&nbsp;</a></span>qho_prob()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::qho_prob </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>x_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>x_next</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates transition probability for quantum harmonic oscillator problem. </p>
<p>Computes </p><p class="formulaDsp">
\[ \frac{P(x_{i+1})}{P(x)} = \frac{\psi^{\alpha}_{T}(x_{i+1})}{\psi^{\alpha}_{T}(x)} = e^{-2\alpha(x^{2}_{i+1}-x^{2}_{i})} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>Parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_current</td><td>Current position of walker </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_next</td><td>Proposed position of walker </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Prob</td><td>Transition probability </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00050">50</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: alpha</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: x_current, x_next</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordtype">        real</span>(real64) :: Prob</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        prob = exp(-2*alpha*(x_next*x_next - x_current*x_current))</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a722edf182d188ad1db7fa6a675fea13c_icgraph.png" border="0" usemap="#anamespacesolvers_a722edf182d188ad1db7fa6a675fea13c_icgraph" alt=""/></div>
<map name="anamespacesolvers_a722edf182d188ad1db7fa6a675fea13c_icgraph" id="anamespacesolvers_a722edf182d188ad1db7fa6a675fea13c_icgraph">
<area shape="rect" title="Calculates transition probability for quantum harmonic oscillator problem." alt="" coords="576,5,699,32"/>
<area shape="rect" href="namespacetesting.html#a3cd96e3cb653762262d063e2aed44ab7" title="Tests the QHO_Prob function in the solvers module." alt="" coords="379,5,528,32"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="207,5,331,32"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,5,159,32"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a4f0054c0d0d2f5080c92a04557feaf52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f0054c0d0d2f5080c92a04557feaf52">&#9670;&nbsp;</a></span>qho_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::qho_energy </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates local energy for quantum harmonic oscillator problem. </p>
<p>Computes </p><p class="formulaDsp">
\[ E^{\alpha}_{L}(x) = \frac{\hat{H}\psi^{\alpha}_{T}(x)}{\psi^{\alpha}_{T}(x)} = \alpha+x^{2}\left ( \frac{1}{2}-2\alpha^{2} \right ) \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>Parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Position of walker </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">E_loc</td><td>Local energy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00079">79</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: alpha</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: x</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keywordtype">        real</span>(real64) :: E_loc</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        e_loc = alpha + (x*x)*(0.5 - (2*alpha*alpha))</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52_icgraph.png" border="0" usemap="#anamespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52_icgraph" alt=""/></div>
<map name="anamespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52_icgraph" id="anamespacesolvers_a4f0054c0d0d2f5080c92a04557feaf52_icgraph">
<area shape="rect" title="Calculates local energy for quantum harmonic oscillator problem." alt="" coords="589,5,725,32"/>
<area shape="rect" href="namespacetesting.html#a55374b3e27ef78754002549b1b423118" title="Tests the QHO_Energy function in the solvers module." alt="" coords="379,5,541,32"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="207,5,331,32"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,5,159,32"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a7d32620a8f8a8780a0b0ef83c490e8f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d32620a8f8a8780a0b0ef83c490e8f7">&#9670;&nbsp;</a></span>h1s_wfn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h1s_wfn </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_nuc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates value of the wavefunction of a hydrogen 1s orbital. </p>
<p>Function to calculate the wavefunction of an electron at position \( \mathbf{r} \) in a hydrogenic 1s atomic orbital, centred on nuclear position \( \mathbf{R}_{nuc}. \) Computes </p><p class="formulaDsp">
\[ \phi_{1s}^{A}(\mathbf{r}) = \frac{1}{\sqrt{\pi}}e^{-\left |\mathbf{r-\mathbf{R}_{nuc}} \right |} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">r_elec</td><td>Electron position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_nuc</td><td>Nuclear position </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">H1s_wfn</td><td>Value of wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00114">114</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_elec, R_nuc</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordtype">        real</span>(real64) :: H1s_wfn, expfac</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        expfac = -norm2(r_elec - r_nuc)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        h1s_wfn = pi_dash * exp(expfac)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7_icgraph.png" border="0" usemap="#anamespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7_icgraph" alt=""/></div>
<map name="anamespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7_icgraph" id="anamespacesolvers_a7d32620a8f8a8780a0b0ef83c490e8f7_icgraph">
<area shape="rect" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="1020,122,1139,149"/>
<area shape="rect" href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="821,85,972,111"/>
<area shape="rect" href="namespacetesting.html#a12c0e6c6469c658e1bd6b30e9fc3f5da" title="Tests the H1s_wfn function in the solvers module." alt="" coords="824,147,969,174"/>
<area shape="rect" href="namespacesolvers.html#a9cc5ffb282a9d15708307d84f6cf147f" title="Calculates local energy for the &#160;problem." alt="" coords="607,17,773,43"/>
<area shape="rect" href="namespacesolvers.html#a5695d107239a7a8fb1f8b096786af028" title="Calculates transition probability for the &#160;problem." alt="" coords="613,71,767,98"/>
<area shape="rect" href="namespacetesting.html#ad1d0b5a5ff6ea4b8b8f29cc2a0e1982a" title="Tests the H_2_plus_wfn function in the solvers module." alt="" coords="381,122,557,149"/>
<area shape="rect" href="namespacetesting.html#a95de4751adddb42c59a3c44f9076db8d" title="Tests the H_2_plus_Energy function in the solvers module." alt="" coords="395,5,543,47"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="207,97,331,123"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,97,159,123"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,97,56,123"/>
<area shape="rect" href="namespacetesting.html#a15f3412ac40e1145572a5269c6f1b971" title="Tests the H_2_plus_Prob function in the solvers module." alt="" coords="379,71,559,98"/>
</map>
</div>

</div>
</div>
<a id="a89943685e3d86544f0261f24fac44419"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89943685e3d86544f0261f24fac44419">&#9670;&nbsp;</a></span>h2s_wfn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h2s_wfn </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_nuc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>[DEPRECATED] Calculates value of the wavefunction of a hydrogen 2s orbital. </p>
<p>Function to calculate the wavefunction of an electron at position \( \mathbf{r} \) in a hydrogenic 2s atomic orbital, centred on nuclear position \( \mathbf{R}_{nuc}. \)</p>
<p>Computes </p><p class="formulaDsp">
\[ \psi^{A}_{2s} = \frac{1}{4\sqrt{2\pi}}\left [ 2 - \left |\mathbf{r-\mathbf{R}_{nuc}} \right | \right ] e^{-\frac{\left |\mathbf{r-\mathbf{R}_{nuc}} \right |}{2}} \]
</p>
<p>@ remark NOTE - this function is now deprecated, and has been left here in case it is needed again in the future. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">r_elec</td><td>Electron position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_nuc</td><td>Nuclear position </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">H2s_wfn</td><td>Value of wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00152">152</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_elec, R_nuc</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keywordtype">        real</span>(real64) :: H2s_wfn, prefac, expfac, r_norm</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        r_norm = norm2(r_elec - r_nuc)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        prefac = pi_dash_2 * (2 - r_norm)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        expfac = -(r_norm / 2)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        h2s_wfn = prefac * exp(expfac)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a89943685e3d86544f0261f24fac44419_icgraph.png" border="0" usemap="#anamespacesolvers_a89943685e3d86544f0261f24fac44419_icgraph" alt=""/></div>
<map name="anamespacesolvers_a89943685e3d86544f0261f24fac44419_icgraph" id="anamespacesolvers_a89943685e3d86544f0261f24fac44419_icgraph">
<area shape="rect" title="[DEPRECATED] Calculates value of the wavefunction of a hydrogen 2s orbital." alt="" coords="572,5,691,32"/>
<area shape="rect" href="namespacetesting.html#abe0f62bb50fbee5f3ebd52fcd43bf1e6" title="Tests the H2s_wfn function in the solvers module." alt="" coords="379,5,524,32"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="207,5,331,32"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,5,159,32"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a6d705d11696b64991f1624e298067bed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d705d11696b64991f1624e298067bed">&#9670;&nbsp;</a></span>h_2_plus_wfn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_plus_wfn </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates trial wavefunction for the \( H_{2}^{+} \) problem. </p>
<p>Function to calculate the wavefunction of an electron at position \( \mathbf{r} \) in the hydrogen molecular ion \( H_{2}^{+} \). Computes </p><p class="formulaDsp">
\[ \psi^{c}_{T}(\mathbf{r}) = c\phi_{1s}^{A}(\mathbf{r}) + \sqrt{1-c^{2}}\phi_{1s}^{B}(\mathbf{r}) \]
</p>
<p> for a given value of the parameter \( c \). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Electron position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">wfn</td><td>Value of trial wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00193">193</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: c</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordtype">        real</span>(real64) :: wfn</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        wfn = (c * h1s_wfn(r, r_a)) + (sqrt(1 - (c*c)) * h1s_wfn(r, r_b)<span class="comment">)</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span> </div>
</div><!-- fragment --><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a6d705d11696b64991f1624e298067bed_cgraph.png" border="0" usemap="#anamespacesolvers_a6d705d11696b64991f1624e298067bed_cgraph" alt=""/></div>
<map name="anamespacesolvers_a6d705d11696b64991f1624e298067bed_cgraph" id="anamespacesolvers_a6d705d11696b64991f1624e298067bed_cgraph">
<area shape="rect" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="5,5,156,32"/>
<area shape="rect" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="204,5,323,32"/>
</map>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a6d705d11696b64991f1624e298067bed_icgraph.png" border="0" usemap="#anamespacesolvers_a6d705d11696b64991f1624e298067bed_icgraph" alt=""/></div>
<map name="anamespacesolvers_a6d705d11696b64991f1624e298067bed_icgraph" id="anamespacesolvers_a6d705d11696b64991f1624e298067bed_icgraph">
<area shape="rect" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="821,71,972,98"/>
<area shape="rect" href="namespacesolvers.html#a9cc5ffb282a9d15708307d84f6cf147f" title="Calculates local energy for the &#160;problem." alt="" coords="607,17,773,43"/>
<area shape="rect" href="namespacesolvers.html#a5695d107239a7a8fb1f8b096786af028" title="Calculates transition probability for the &#160;problem." alt="" coords="613,71,767,98"/>
<area shape="rect" href="namespacetesting.html#ad1d0b5a5ff6ea4b8b8f29cc2a0e1982a" title="Tests the H_2_plus_wfn function in the solvers module." alt="" coords="381,122,557,149"/>
<area shape="rect" href="namespacetesting.html#a95de4751adddb42c59a3c44f9076db8d" title="Tests the H_2_plus_Energy function in the solvers module." alt="" coords="395,5,543,47"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="207,71,331,98"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,71,159,98"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,71,56,98"/>
<area shape="rect" href="namespacetesting.html#a15f3412ac40e1145572a5269c6f1b971" title="Tests the H_2_plus_Prob function in the solvers module." alt="" coords="379,71,559,98"/>
</map>
</div>

</div>
</div>
<a id="a5695d107239a7a8fb1f8b096786af028"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5695d107239a7a8fb1f8b096786af028">&#9670;&nbsp;</a></span>h_2_plus_prob()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_plus_prob </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates transition probability for the \( H_{2}^{+} \) problem. </p>
<p>Function to calculate transition probability for walkers in the \( H_{2}^{+} \) problem. Computes </p><p class="formulaDsp">
\[ \frac{P(x_{i+1})}{P(x)} = \left (\frac{\psi^{c}_{T}(\mathbf{r}_{i+1})} {\psi^{c}_{T}(\mathbf{r})} \right ) ^{2} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_current</td><td>Current position of walker </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_next</td><td>Proposed position of walker </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Prob</td><td>Transition probability </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00228">228</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: c</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_current, r_next</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="keywordtype">        real</span>(real64) :: Prob</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        prob = (h_2_plus_wfn(c, r_next, r_a, r_b) / &amp;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            h_2_plus_wfn(c, r_current, r_a, r_b))**2</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a5695d107239a7a8fb1f8b096786af028_cgraph.png" border="0" usemap="#anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_cgraph" alt=""/></div>
<map name="anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_cgraph" id="anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_cgraph">
<area shape="rect" title="Calculates transition probability for the &#160;problem." alt="" coords="5,5,160,32"/>
<area shape="rect" href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="208,5,359,32"/>
<area shape="rect" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="407,5,525,32"/>
</map>
</div>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a5695d107239a7a8fb1f8b096786af028_icgraph.png" border="0" usemap="#anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_icgraph" alt=""/></div>
<map name="anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_icgraph" id="anamespacesolvers_a5695d107239a7a8fb1f8b096786af028_icgraph">
<area shape="rect" title="Calculates transition probability for the &#160;problem." alt="" coords="607,5,761,32"/>
<area shape="rect" href="namespacetesting.html#a15f3412ac40e1145572a5269c6f1b971" title="Tests the H_2_plus_Prob function in the solvers module." alt="" coords="379,5,559,32"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="207,5,331,32"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,5,159,32"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a9cc5ffb282a9d15708307d84f6cf147f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cc5ffb282a9d15708307d84f6cf147f">&#9670;&nbsp;</a></span>h_2_plus_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solvers::h_2_plus_energy </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out)&#160;</td>
          <td class="paramname"><em>E_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out)&#160;</td>
          <td class="paramname"><em>gradient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates local energy for the \( H_{2}^{+} \) problem. </p>
<p>Function to calculate the local energy of a walker in the \( H_{2}^{+} \) problem.</p>
<p>Computes </p><p class="formulaDsp">
\[ E^{c}_{L}(\mathbf{r}) = \frac{\hat{H}\psi^{c}_{T}(\mathbf{r})}{\psi^{c}_{T}(\mathbf{r})} \]
</p>
<p> where </p><p class="formulaDsp">
\[ \hat{H} = -\frac{1}{2}\nabla^{2} - \frac{1}{\left | \mathbf{r}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}-\mathbf{R}_{B} \right |} \]
</p>
<p> by means of a second order central difference calculation.</p>
<p>Also calculates the gradient with respect to the parameter value c by means of a first order central difference calculation, provided <a class="el" href="structshared__data_1_1h2plus__type.html#a216705c18dec2984227a17ef587ed0e9">auto_params</a> for this problem is set to <em>TRUE</em>.</p>
<p>Finite difference step sizes for the calculation of both <b>E_loc</b> and <b>gradient</b> can be controlled by setting <a class="el" href="structshared__data_1_1h2plus__type.html#ac9850ee368bd929cfcd435a1ad6178ca">H2plus%ham_fdstep</a> and <a class="el" href="structshared__data_1_1h2plus__type.html#a93cd67fa7602dee85356a7a3cbe80b7b">H2plus%c_fdstep</a> respectively, by giving them a value in the <em>params.txt</em> input file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Position of walker </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">E_loc</td><td>Local energy </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gradient</td><td>Gradient wrt parameter c </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00280">280</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: c</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span> :: E_loc</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span> :: gradient</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(2, 3)</span> :: r_diffs    <span class="comment">! Wavefunction finite differences wrt position</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(2)</span> :: c_diffs       <span class="comment">! Wavefunction finite differences wrt parameter</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span> :: r_temp        <span class="comment">! Temporary position for finite differences</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordtype">        real</span>(real64) :: laplacian                   <span class="comment">! 2nd derivative of trial wavefunction</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keywordtype">        real</span>(real64) :: coulomb                     <span class="comment">! Coulomb terms of Hamiltonian</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keywordtype">        real</span>(real64) :: c_temp                      <span class="comment">! Temporary parameter value for finite differences</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordtype">        real</span>(real64) :: wfn, wfnx2                  <span class="comment">! Wavefunction at current walker position</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordtype">integer</span> :: i                                <span class="comment">! Loop integer</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">! Calculate trial wavefunction at provided point.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        wfn = h_2_plus_wfn(c, r, r_a, r_b)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        wfnx2 = 2 * wfn</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">! Calculate trial wavefunction in finite difference directions.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">do</span> i = 1, 3</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            r_temp(:) = r(:)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            r_temp(i) = r(i) - h2plus%ham_fdstep</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            r_diffs(1, i) = h_2_plus_wfn(c, r_temp, r_a, r_b)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            r_temp(i) = r(i) + h2plus%ham_fdstep</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            r_diffs(2, i) = h_2_plus_wfn(c, r_temp, r_a, r_b)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment">! Assemble Hamiltonian</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        laplacian = ((r_diffs(1, 1) - wfnx2 + r_diffs(2, 1)) + &amp;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                     (r_diffs(1, 2) - wfnx2 + r_diffs(2, 2)) + &amp;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                     (r_diffs(1, 3) - wfnx2 + r_diffs(2, 3))) / (h2plus%ham_fdstep<span class="comment">**2)</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"></span>        laplacian = laplacian * (-0.5_real64)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        coulomb = -(1  / norm2(r - r_a))*wfn - (1 / norm2(r - r_b))*wfn</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        e_loc = ((laplacian + coulomb) / wfn) + (1 / norm2(r_a - r_b))</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">! Check if gradient is needed</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">if</span> (h2plus%auto_params) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="comment">! Calculate wavefunction gradient wrt c by central difference.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            c_temp = c - h2plus%c_fdstep</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            c_diffs(1) = h_2_plus_wfn(c_temp, r, r_a, r_b)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            c_temp = c + h2plus%c_fdstep</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            c_diffs(2) = h_2_plus_wfn(c_temp, r, r_a, r_b)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            gradient = (c_diffs(2) - c_diffs(1)) / (2.0_real64 * h2plus%c_fdstep<span class="comment">)</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span>        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            gradient = 0.0_real64</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        </div>
</div><!-- fragment --><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f_cgraph.png" border="0" usemap="#anamespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f_cgraph" alt=""/></div>
<map name="anamespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f_cgraph" id="anamespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f_cgraph">
<area shape="rect" title="Calculates local energy for the &#160;problem." alt="" coords="5,5,172,32"/>
<area shape="rect" href="namespacesolvers.html#a6d705d11696b64991f1624e298067bed" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="220,5,371,32"/>
<area shape="rect" href="namespacesolvers.html#a7d32620a8f8a8780a0b0ef83c490e8f7" title="Calculates value of the wavefunction of a hydrogen 1s orbital." alt="" coords="419,5,537,32"/>
</map>
</div>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f_icgraph.png" border="0" usemap="#anamespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f_icgraph" alt=""/></div>
<map name="anamespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f_icgraph" id="anamespacesolvers_a9cc5ffb282a9d15708307d84f6cf147f_icgraph">
<area shape="rect" title="Calculates local energy for the &#160;problem." alt="" coords="575,13,741,39"/>
<area shape="rect" href="namespacetesting.html#a95de4751adddb42c59a3c44f9076db8d" title="Tests the H_2_plus_Energy function in the solvers module." alt="" coords="379,5,527,47"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="207,13,331,39"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,13,159,39"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,13,56,39"/>
</map>
</div>

</div>
</div>
<a id="acb91c2bfc7ae441b3e24f83d0f49d55a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb91c2bfc7ae441b3e24f83d0f49d55a">&#9670;&nbsp;</a></span>h_2_plus_update_c()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solvers::h_2_plus_update_c </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>c_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out)&#160;</td>
          <td class="paramname"><em>c_new</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the c parameter in the \( H_{2}^{+} \) problem by dampened steepest descent. </p>
<p>Uses the gradient calculated by <a class="el" href="namespacesolvers.html#a9cc5ffb282a9d15708307d84f6cf147f">solvers::h_2_plus_energy</a> to propose a new value for the parameter <b>c</b>, based on its current value. Step size can be adjusted by modifying the <b>damping</b> variable. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c_old</td><td>Parameter to be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gradient</td><td>Gradient at current parameter </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">c_new</td><td>New updated parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00357">357</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: c_old</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: gradient</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span> :: c_new</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keywordtype">        real</span>(real64) :: damping = 1.0_real64</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="comment">! Update c by dampened steepest descent.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        c_new = c_old - (damping * gradient)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a38259c21a02a250a91f45d79e4165742"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38259c21a02a250a91f45d79e4165742">&#9670;&nbsp;</a></span>h_2_cusp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_cusp </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a value for <b>a</b> given the bond length <b>s</b> by Newton-Raphson iteration. </p>
<p>Solves the Coulomb cusp condition for the \( H_{2} \) wavefunction, which is defined by the equation </p><p class="formulaDsp">
\[ a \left ( 1 + e^{-\frac{s}{a}} \right ) = 1 \]
</p>
<p> where <b>s</b> is the H-H bond length and <b>a</b> is a parameter of the wavefunction.</p>
<p>The value of this parameter is found by Newton-Raphson iteration over the resulting product log equation </p><p class="formulaDsp">
\[ \frac{1}{1 + e^{-\frac{s}{a}}} - a = 0 \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Bond length </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">a</td><td>Optimised wavefunction parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00399">399</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: s</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keywordtype">        real</span>(real64) :: a</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordtype">        real</span>(real64) :: f           <span class="comment">! Value of function at current iteration</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="keywordtype">        real</span>(real64) :: f_dash      <span class="comment">! Value of derivative at current iteration</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordtype">        real</span>(real64) :: emsoa       <span class="comment">! e^(-s/a)</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keywordtype">        real</span>(real64) :: tol         <span class="comment">! Tolerance for stopping iteration</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordtype">integer</span> :: maxiter          <span class="comment">! Maximum number of iterations</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordtype">integer</span> :: k                <span class="comment">! Loop integer</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        a = 0.5_real64 <span class="comment">! guess based on s=0 solution</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        maxiter = 100</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        tol = 1e-5_real64</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span> (write_log) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="keyword">write</span>(logid, <span class="stringliteral">&quot;(&#39;Starting Newton-Raphson search for parameter a...&#39;)&quot;</span><span class="comment">)</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"></span>            <span class="keyword">write</span>(logid, *) <span class="stringliteral">&#39;a               abs(f)&#39;</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="comment">! Calculate initial value of function based on guess</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        f = (1.0_real64 / (1.0_real64 + exp(-s/a))) - a</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">! Iterate until converged</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">do</span> k = 1, maxiter</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">if</span> (abs(f) .lt. tol) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keywordflow">if</span> (write_log) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    <span class="keyword">write</span>(logid, <span class="stringliteral">&quot;(&#39;Value of parameter a converged.&#39;)&quot;</span>)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    <span class="keyword">write</span>(logid, <span class="stringliteral">&quot;(&#39;&#39;)&quot;</span>)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="keywordflow">                end if</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <span class="comment">! Calculate new values</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            emsoa = exp(-s/a)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            f = (1.0_real64 / (1.0_real64 + emsoa)) - a</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            f_dash = (-s * emsoa) / ((1.0_real64 + emsoa*emsoa * a*a)) -<span class="comment"> 1</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="comment">! Update value of a</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            a = a - (f / f_dash)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <span class="keywordflow">if</span> (write_log) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                <span class="keyword">write</span>(logid, <span class="stringliteral">&quot;(F12.8, &#39;    &#39;, F12.8)&quot;</span>) a, abs(f)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">! Crash out if not converged</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">if</span> (k .ge. maxiter) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            error stop <span class="stringliteral">&quot;Newton-Raphson search for parameter a has failed to converge.&quot;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a38259c21a02a250a91f45d79e4165742_icgraph.png" border="0" usemap="#anamespacesolvers_a38259c21a02a250a91f45d79e4165742_icgraph" alt=""/></div>
<map name="anamespacesolvers_a38259c21a02a250a91f45d79e4165742_icgraph" id="anamespacesolvers_a38259c21a02a250a91f45d79e4165742_icgraph">
<area shape="rect" title="Calculates a value for a given the bond length s by Newton&#45;Raphson iteration." alt="" coords="207,5,333,32"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,5,159,32"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="ac603f31a67286a6e89588cf4de29bd1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac603f31a67286a6e89588cf4de29bd1b">&#9670;&nbsp;</a></span>h_2_wfn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_wfn </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates trial wavefunction for the \( H_{2} \) problem. </p>
<p>Function to calculate the wavefunction of two electrons at positions \( \mathbf{r}_{1} \) and \( \mathbf{r}_{2} \) in the hydrogen molecule \( H_{2} \).</p>
<p>Takes the functional form </p><p class="formulaDsp">
\[ \Psi_{T}(\mathbf{r}_1, \mathbf{r}_{2}) = \phi(\mathbf{r}_{1}) \phi(\mathbf{r}_{2}) \psi(\mathbf{r}_1, \mathbf{r}_{2}) \]
</p>
<p> where </p><p class="formulaDsp">
\[ \phi(\mathbf{r}_{1}) = e^{-\frac{\left | \mathbf{r}_{1A} \right |}{a}} + e^{-\frac{\left | \mathbf{r}_{1B} \right |}{a}} = \phi_{1A} + \phi_{1B} \]
</p>
 <p class="formulaDsp">
\[ \phi(\mathbf{r}_{2}) = e^{-\frac{\left | \mathbf{r}_{2A} \right |}{a}} + e^{-\frac{\left | \mathbf{r}_{2B} \right |}{a}} = \phi_{2A} + \phi_{2B} \]
</p>
<p> and \( \psi(\mathbf{r}_1, \mathbf{r}_{2}) \) is the Jastrow function with the form </p><p class="formulaDsp">
\[ \psi(\mathbf{r}_1, \mathbf{r}_{2}) = e^{\frac{\left | \mathbf{r}_{12} \right |} {\alpha \left ( 1 + \beta \left | \mathbf{r}_{12} \right | \right )}} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Parameter \( a \) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beta</td><td>Parameter \( \beta \) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_1</td><td>Position of electron 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_2</td><td>Position of electron 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">wfn</td><td>Value of trial wavefunction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00491">491</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: a</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: beta</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_1, r_2</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keywordtype">        real</span>(real64) :: wfn</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="keywordtype">        real</span>(real64) :: s                           <span class="comment">! Bond length</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keywordtype">        real</span>(real64) :: alpha                       <span class="comment">! Wavefunction parameter, set to 2</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="keywordtype">        real</span>(real64) :: phi_r1, phi_r2, jastrow     <span class="comment">! Wavefunction components</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        s = norm2(r_a - r_b)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        alpha = 2.0_real64</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        phi_r1 = exp(-norm2(r_1 - r_a) / a) + exp(-norm2(r_1 - r_b) / a)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        phi_r2 = exp(-norm2(r_2 - r_a) / a) + exp(-norm2(r_2 - r_b) / a)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        jastrow = exp(norm2(r_1 - r_2) / (alpha * (1.0_real64 + beta*norm2<span class="comment">(r_1 - r_2))))</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        wfn = phi_r1 * phi_r2 * jastrow</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_ac603f31a67286a6e89588cf4de29bd1b_icgraph.png" border="0" usemap="#anamespacesolvers_ac603f31a67286a6e89588cf4de29bd1b_icgraph" alt=""/></div>
<map name="anamespacesolvers_ac603f31a67286a6e89588cf4de29bd1b_icgraph" id="anamespacesolvers_ac603f31a67286a6e89588cf4de29bd1b_icgraph">
<area shape="rect" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="747,31,865,57"/>
<area shape="rect" href="namespacesolvers.html#ac30d1c7141f673647e837524ecb26b07" title="Calculates transition probability for the &#160;problem." alt="" coords="576,5,699,32"/>
<area shape="rect" href="namespacetesting.html#a70f58338fe8165f65417781dae734e68" title="Tests the H_2_wfn function in the solvers module." alt="" coords="381,56,526,83"/>
<area shape="rect" href="namespacetesting.html#ad02da7e5d742236c571c965b4f80992c" title="Tests the H_2_Prob function in the solvers module." alt="" coords="379,5,528,32"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="207,31,331,57"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,31,159,57"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,31,56,57"/>
</map>
</div>

</div>
</div>
<a id="ac30d1c7141f673647e837524ecb26b07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac30d1c7141f673647e837524ecb26b07">&#9670;&nbsp;</a></span>h_2_prob()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(real64) function solvers::h_2_prob </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_1_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_2_current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_1_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_2_next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates transition probability for the \( H_{2} \) problem. </p>
<p>Function to calculate transition probability for walkers in the \( H_{2} \) problem. Computes </p><p class="formulaDsp">
\[\frac{P(x_{i+1})}{P(x)} = \left (\frac{\psi^{c}_{T}(\mathbf{r}_{1}^{i+1}, \mathbf{r}_{2}^{i+1})} {\psi^{c}_{T}(\mathbf{r}_{1}^{i}, \mathbf{r}_{2}^{i})} \right )^{2} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Parameter \( a \) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beta</td><td>Parameter \( \beta \) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_1_current</td><td>Current position of walker 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_2_current</td><td>Current position of walker 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_1_next</td><td>Proposed position of walker 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_2_next</td><td>Proposed position of walker 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Prob</td><td>Transition probability </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00542">542</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: a</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: beta</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_1_current, r_2_current</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_1_next, r_2_next</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="keywordtype">        real</span>(real64) :: Prob</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        prob = (h_2_wfn(a, beta, r_1_next, r_2_next, r_a, r_b) / &amp;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;               h_2_wfn(a, beta, r_1_current, r_2_current, r_a, r_b))**2</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
</div><!-- fragment --><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_ac30d1c7141f673647e837524ecb26b07_cgraph.png" border="0" usemap="#anamespacesolvers_ac30d1c7141f673647e837524ecb26b07_cgraph" alt=""/></div>
<map name="anamespacesolvers_ac30d1c7141f673647e837524ecb26b07_cgraph" id="anamespacesolvers_ac30d1c7141f673647e837524ecb26b07_cgraph">
<area shape="rect" title="Calculates transition probability for the &#160;problem." alt="" coords="5,5,128,32"/>
<area shape="rect" href="namespacesolvers.html#ac603f31a67286a6e89588cf4de29bd1b" title="Calculates trial wavefunction for the &#160;problem." alt="" coords="176,5,295,32"/>
</map>
</div>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_ac30d1c7141f673647e837524ecb26b07_icgraph.png" border="0" usemap="#anamespacesolvers_ac30d1c7141f673647e837524ecb26b07_icgraph" alt=""/></div>
<map name="anamespacesolvers_ac30d1c7141f673647e837524ecb26b07_icgraph" id="anamespacesolvers_ac30d1c7141f673647e837524ecb26b07_icgraph">
<area shape="rect" title="Calculates transition probability for the &#160;problem." alt="" coords="576,5,699,32"/>
<area shape="rect" href="namespacetesting.html#ad02da7e5d742236c571c965b4f80992c" title="Tests the H_2_Prob function in the solvers module." alt="" coords="379,5,528,32"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="207,5,331,32"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,5,159,32"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a9afbcdcc0405d544d4441e9786f440a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9afbcdcc0405d544d4441e9786f440a2">&#9670;&nbsp;</a></span>h_2_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solvers::h_2_energy </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>r_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>R_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out)&#160;</td>
          <td class="paramname"><em>E_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out)&#160;</td>
          <td class="paramname"><em>DphiDbeta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>{UPDATE ME} Calculates local energy for the \( H_{2} \) problem. </p>
<p>Function to calculate the local energy of two walkers in the \( H_{2} \) problem. Computes </p><p class="formulaDsp">
\[ E^{c}_{L}(\mathbf{r}_{1}, \mathbf{r}_{2}) = \frac{\hat{H}\psi^{c}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2})} {\psi^{c}_{T}(\mathbf{r}_{1}, \mathbf{r}_{2})} \]
</p>
<p> where </p><p class="formulaDsp">
\[ \hat{H} = -\frac{1}{2}\nabla^{2} - \frac{1}{\left | \mathbf{r}_{1}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}_{1}-\mathbf{R}_{B} \right |} - \frac{1}{\left | \mathbf{r}_{2}-\mathbf{R}_{A} \right |} - \frac{1}{\left | \mathbf{r}_{2}-\mathbf{R}_{B} \right |} + \frac{1}{\left | \mathbf{r}_{1}-\mathbf{r}_{2} \right |} \]
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Parameter(s) of trial wavefunction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_1</td><td>Position of walker 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_2</td><td>Position of walker 2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_a</td><td>Position of hydrogen atom A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R_b</td><td>Position of hydrogen atom B </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fdstep</td><td>Finite difference step size (optional, default = 1e-3 Bohr) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">E_loc</td><td>Local energy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00589">589</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: a</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: beta</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: r_1, r_2</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span>, <span class="keywordtype">intent(in)</span> :: R_a, R_b</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span> :: E_loc</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span> :: DphiDbeta</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keywordtype">        real</span>(real64) :: E1, E2, E3, E4, E5, E6, E7, E8</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keywordtype">        real</span>(real64) :: phi_1a, phi_1b, phi_1</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="keywordtype">        real</span>(real64) :: phi_2a, phi_2b, phi_2</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="keywordtype">        real</span>(real64) :: r_1a, r_1b, r_2a, r_2b, r_12</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">dimension(3)</span> :: r_1a_hat, r_1b_hat, r_2a_hat, r_2b_hat<span class="comment">, r_12_hat</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">        r_1a = norm2(r_1 - r_a)</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment"></span>        r_1b = norm2(r_1 - r_b)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        r_2a = norm2(r_2 - r_a)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        r_2b = norm2(r_2 - r_b)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        r_12 = norm2(r_1 - r_2)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        r_1a_hat = (r_1 - r_a) / spread(r_1a, 1, 3)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        r_1b_hat = (r_1 - r_b) / spread(r_1b, 1, 3)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        r_2a_hat = (r_2 - r_a) / spread(r_2a, 1, 3)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        r_2b_hat = (r_2 - r_b) / spread(r_2b, 1, 3)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        r_12_hat = (r_1 - r_2) / spread(r_12, 1, 3)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        phi_1a = exp(-r_1a / a)</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        phi_1b = exp(-r_1b / a)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        phi_2a = exp(-r_2a / a)</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        phi_2b = exp(-r_2b / a)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        phi_1 = phi_1a + phi_1b</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        phi_2 = phi_2a + phi_2b</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        e1 = 1.0_real64 / (a*a)</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        e2 = ((phi_1a / r_1a) + (phi_1b / r_1b)) / (a * phi_1)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        e3 = ((phi_2a / r_2a) + (phi_2b / r_2b)) / (a * phi_2)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        e4 = (1.0_real64 / r_1a) + (1.0_real64 / r_1b) + (1.0_real64 / r_2a<span class="comment">) + (1.0_real64 / r_2b)</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"></span>        e5 = 1.0_real64 / r_12</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        e6 = ((((phi_1a * sum(r_1a_hat * r_12_hat, dim=1)) + (phi_1b * sum<span class="comment">(r_1b_hat * r_12_hat, dim=1))) / phi_1) &amp;</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"></span>            - (((phi_2a * sum(r_2a_hat * r_12_hat, dim=1)) + (phi_2b * sum<span class="comment">(r_2b_hat * r_12_hat, dim=1))) / phi_2)) &amp;</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"></span>            / (2.0_real64 * a * (1.0_real64 + beta*r_12)**2)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        e7 = (((4.0_real64*beta + 1.0_real64) * r_12) + 4.0_real64) &amp;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            / (4.0_real64 * r_12 * (1.0_real64 + beta*r_12)**4)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        e8 = (1.0_real64 / norm2(r_a - r_b))</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="comment">! E_loc = -E1 + E2 + E3 - E4 + E5 + E6 - E7 + (1.0_real64 / norm2(R_a - R_b))</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="comment">! E_loc = -E1 + E2 + E3 - E4 + E5 + E6 - E7</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        e_loc = -e1 + e2 + e3 - e4 + e5 + e6 - e7 + e8</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        dphidbeta = -(r_12*r_12) / (2.0_real64*(1.0_real64 + beta*r_12)*<span class="comment">*2)</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment"></span> </div>
</div><!-- fragment --><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="namespacesolvers_a9afbcdcc0405d544d4441e9786f440a2_icgraph.png" border="0" usemap="#anamespacesolvers_a9afbcdcc0405d544d4441e9786f440a2_icgraph" alt=""/></div>
<map name="anamespacesolvers_a9afbcdcc0405d544d4441e9786f440a2_icgraph" id="anamespacesolvers_a9afbcdcc0405d544d4441e9786f440a2_icgraph">
<area shape="rect" title="{UPDATE ME} Calculates local energy for the &#160;problem." alt="" coords="589,5,725,32"/>
<area shape="rect" href="namespacetesting.html#a313d78f649070a104e89a7535811d6a5" title="Tests the H_2_Energy function in the solvers module." alt="" coords="379,5,541,32"/>
<area shape="rect" href="namespacetesting.html#a426ebe0ada45b0bc1c4ebba3f469a5c6" title="Runs all of the unit tests, reporting successes and failures." alt="" coords="207,5,331,32"/>
<area shape="rect" href="driver_8f90.html#aae94725eafaedc467ab9bfefcae9769e" title="Subroutine for running the main code (needed for Doxygen compatability)." alt="" coords="104,5,159,32"/>
<area shape="rect" href="driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title="Main program, contains the driver subroutine that runs all other code." alt="" coords="5,5,56,32"/>
</map>
</div>

</div>
</div>
<a id="a4b4d370a4ee50b231f53058ab62e4084"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4d370a4ee50b231f53058ab62e4084">&#9670;&nbsp;</a></span>h_2_update_beta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine solvers::h_2_update_beta </td>
          <td>(</td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>beta_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(in)&#160;</td>
          <td class="paramname"><em>gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), intent(out)&#160;</td>
          <td class="paramname"><em>beta_new</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the \( \beta \) parameter in the \( H_{2}^{+} \) problem by dampened steepest descent. </p>
<p>Uses the gradient calculated by <a class="el" href="namespacesolvers.html#a9afbcdcc0405d544d4441e9786f440a2">solvers::h_2_energy</a> to propose a new value for the parameter \( \beta \), based on its current value. Step size can be adjusted by modifying the <b>damping</b> variable. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c_old</td><td>Parameter to be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gradient</td><td>Gradient at current parameter </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">c_new</td><td>New updated parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="quantum__solvers_8f90_source.html#l00664">664</a> of file <a class="el" href="quantum__solvers_8f90_source.html">quantum_solvers.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: beta_old</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(in)</span> :: gradient</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="keywordtype">        real</span>(real64), <span class="keywordtype">intent(out)</span> :: beta_new</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="keywordtype">        real</span>(real64) :: damping = 1.0_real64</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        beta_new = beta_old - (damping * gradient)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesolvers.html">solvers</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
